ğŸ“ HORA-UNAP/
|-- ğŸ“„ .gitignore
|   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ # Entorno virtual de Python
|   â”‚ backend/venv/
|   â”‚ 
|   â”‚ # Archivos de cachÃ© de Python
|   â”‚ __pycache__/
|   â”‚ *.pyc
|   â”‚ 
|   â”‚ # Base de datos local
|   â”‚ db.sqlite3
|   â”‚ 
|   â”‚ # Dependencias de Node.js
|   â”‚ frontend/node_modules/
|   â”‚ 
|   â”‚ # Archivos de build de React
|   â”‚ frontend/build/
|   â”‚ 
|   â”‚ # Archivos de entorno
|   â”‚ .env
|   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|-- ğŸ“ academic/
|   |-- ğŸ“„ __init__.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ # academic/__init__.py
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ admin.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.contrib import admin
|   |   â”‚ from .models import Curso, Aula
|   |   â”‚ 
|   |   â”‚ @admin.register(Curso)
|   |   â”‚ class CursoAdmin(admin.ModelAdmin):
|   |   â”‚     list_display = ['codigo', 'nombre', 'creditos', 'tipo', 'sesiones_semana', 'activo']
|   |   â”‚     list_filter = ['tipo', 'activo']
|   |   â”‚     search_fields = ['codigo', 'nombre']
|   |   â”‚     filter_horizontal = ['requisitos']
|   |   â”‚     list_editable = ['activo']
|   |   â”‚ 
|   |   â”‚ @admin.register(Aula)
|   |   â”‚ class AulaAdmin(admin.ModelAdmin):
|   |   â”‚     list_display = ['nombre', 'edificio', 'capacidad', 'tipo', 'tiene_proyector', 'activa']
|   |   â”‚     list_filter = ['tipo', 'edificio', 'activa', 'tiene_proyector', 'tiene_computadoras']
|   |   â”‚     search_fields = ['nombre', 'edificio']
|   |   â”‚     list_editable = ['activa']
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ apps.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.apps import AppConfig
|   |   â”‚ 
|   |   â”‚ class AcademicConfig(AppConfig):
|   |   â”‚     default_auto_field = 'django.db.models.BigAutoField'
|   |   â”‚     name = 'academic'
|   |   â”‚     verbose_name = 'GestiÃ³n AcadÃ©mica'
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“ migrations/
|   |   |-- ğŸ“„ 0001_initial.py
|   |   |   â”Œâ”€ CONTENIDO â”€â”
|   |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-12 17:47
|   |   |   â”‚ 
|   |   |   â”‚ from django.db import migrations, models
|   |   |   â”‚ 
|   |   |   â”‚ 
|   |   |   â”‚ class Migration(migrations.Migration):
|   |   |   â”‚ 
|   |   |   â”‚     initial = True
|   |   |   â”‚ 
|   |   |   â”‚     dependencies = [
|   |   |   â”‚     ]
|   |   |   â”‚ 
|   |   |   â”‚     operations = [
|   |   |   â”‚         migrations.CreateModel(
|   |   |   â”‚             name='Aula',
|   |   |   â”‚             fields=[
|   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   |   |   â”‚                 ('nombre', models.CharField(max_length=100, verbose_name='Nombre del Aula')),
|   |   |   â”‚                 ('capacidad', models.IntegerField(verbose_name='Capacidad MÃ¡xima')),
|   |   |   â”‚                 ('tipo', models.CharField(choices=[('TEORIA', 'Aula de TeorÃ­a'), ('LABORATORIO', 'Laboratorio'), ('MIXTA', 'Aula Mixta')], default='TEORIA', max_length=20)),
|   |   |   â”‚                 ('edificio', models.CharField(blank=True, max_length=50, verbose_name='Edificio')),
|   |   |   â”‚                 ('piso', models.CharField(blank=True, max_length=10, verbose_name='Piso')),
|   |   |   â”‚                 ('tiene_proyector', models.BooleanField(default=False, verbose_name='Tiene Proyector')),
|   |   |   â”‚                 ('tiene_computadoras', models.BooleanField(default=False, verbose_name='Tiene Computadoras')),
|   |   |   â”‚                 ('tiene_pizarra_digital', models.BooleanField(default=False, verbose_name='Tiene Pizarra Digital')),
|   |   |   â”‚                 ('equipamiento_adicional', models.TextField(blank=True, verbose_name='Equipamiento Adicional')),
|   |   |   â”‚                 ('activa', models.BooleanField(default=True, verbose_name='Aula Activa')),
|   |   |   â”‚             ],
|   |   |   â”‚             options={
|   |   |   â”‚                 'verbose_name': 'Aula',
|   |   |   â”‚                 'verbose_name_plural': 'Aulas',
|   |   |   â”‚                 'ordering': ['edificio', 'piso', 'nombre'],
|   |   |   â”‚             },
|   |   |   â”‚         ),
|   |   |   â”‚         migrations.CreateModel(
|   |   |   â”‚             name='Curso',
|   |   |   â”‚             fields=[
|   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   |   |   â”‚                 ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Curso')),
|   |   |   â”‚                 ('codigo', models.CharField(max_length=20, unique=True, verbose_name='CÃ³digo del Curso')),
|   |   |   â”‚                 ('creditos', models.IntegerField(verbose_name='NÃºmero de CrÃ©ditos')),
|   |   |   â”‚                 ('tipo', models.CharField(choices=[('OBLIGATORIO', 'Obligatorio'), ('ELECTIVO', 'Electivo'), ('OPTATIVO', 'Optativo')], default='OBLIGATORIO', max_length=20)),
|   |   |   â”‚                 ('sesiones_semana', models.IntegerField(default=1, verbose_name='Sesiones por Semana')),
|   |   |   â”‚                 ('duracion_sesion', models.IntegerField(default=2, verbose_name='DuraciÃ³n de SesiÃ³n (horas)')),
|   |   |   â”‚                 ('capacidad_estimada', models.IntegerField(default=30, verbose_name='Capacidad Estimada de Estudiantes')),
|   |   |   â”‚                 ('equipamiento_requerido', models.TextField(blank=True, verbose_name='Equipamiento Requerido')),
|   |   |   â”‚                 ('activo', models.BooleanField(default=True, verbose_name='Curso Activo')),
|   |   |   â”‚                 ('requisitos', models.ManyToManyField(blank=True, to='academic.curso', verbose_name='Prerrequisitos')),
|   |   |   â”‚             ],
|   |   |   â”‚             options={
|   |   |   â”‚                 'verbose_name': 'Curso',
|   |   |   â”‚                 'verbose_name_plural': 'Cursos',
|   |   |   â”‚                 'ordering': ['codigo'],
|   |   |   â”‚             },
|   |   |   â”‚         ),
|   |   |   â”‚     ]
|   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |   |-- ğŸ“„ 0002_curso_requiere_laboratorio.py
|   |   |   â”Œâ”€ CONTENIDO â”€â”
|   |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-13 02:54
|   |   |   â”‚ 
|   |   |   â”‚ from django.db import migrations, models
|   |   |   â”‚ 
|   |   |   â”‚ 
|   |   |   â”‚ class Migration(migrations.Migration):
|   |   |   â”‚ 
|   |   |   â”‚     dependencies = [
|   |   |   â”‚         ('academic', '0001_initial'),
|   |   |   â”‚     ]
|   |   |   â”‚ 
|   |   |   â”‚     operations = [
|   |   |   â”‚         migrations.AddField(
|   |   |   â”‚             model_name='curso',
|   |   |   â”‚             name='requiere_laboratorio',
|   |   |   â”‚             field=models.BooleanField(default=False, verbose_name='Requiere Laboratorio'),
|   |   |   â”‚         ),
|   |   |   â”‚     ]
|   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |   `-- ğŸ“„ __init__.py
|   |         (Archivo vacÃ­o)
|   |-- ğŸ“„ models.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.db import models
|   |   â”‚ 
|   |   â”‚ class Curso(models.Model):
|   |   â”‚     TIPO_CURSO = [
|   |   â”‚         ('OBLIGATORIO', 'Obligatorio'),
|   |   â”‚         ('ELECTIVO', 'Electivo'),
|   |   â”‚         ('OPTATIVO', 'Optativo'),
|   |   â”‚     ]
|   |   â”‚ 
|   |   â”‚     nombre = models.CharField(max_length=200, verbose_name="Nombre del Curso")
|   |   â”‚     codigo = models.CharField(max_length=20, unique=True, verbose_name="CÃ³digo del Curso")
|   |   â”‚     creditos = models.IntegerField(verbose_name="NÃºmero de CrÃ©ditos")
|   |   â”‚     tipo = models.CharField(max_length=20, choices=TIPO_CURSO, default='OBLIGATORIO')
|   |   â”‚     sesiones_semana = models.IntegerField(default=1, verbose_name="Sesiones por Semana")
|   |   â”‚     duracion_sesion = models.IntegerField(default=2, verbose_name="DuraciÃ³n de SesiÃ³n (horas)")
|   |   â”‚     requisitos = models.ManyToManyField('self', symmetrical=False, blank=True, verbose_name="Prerrequisitos")
|   |   â”‚     capacidad_estimada = models.IntegerField(default=30, verbose_name="Capacidad Estimada de Estudiantes")
|   |   â”‚     equipamiento_requerido = models.TextField(blank=True, verbose_name="Equipamiento Requerido")
|   |   â”‚     activo = models.BooleanField(default=True, verbose_name="Curso Activo")
|   |   â”‚ 
|   |   â”‚     # NUEVO CAMPO AGREGADO PARA COMPATIBILIDAD CON EL ALGORITMO
|   |   â”‚     requiere_laboratorio = models.BooleanField(default=False, verbose_name="Requiere Laboratorio")
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         verbose_name = "Curso"
|   |   â”‚         verbose_name_plural = "Cursos"
|   |   â”‚         ordering = ['codigo']
|   |   â”‚ 
|   |   â”‚     def __str__(self):
|   |   â”‚         return f"{self.codigo} - {self.nombre}"
|   |   â”‚ 
|   |   â”‚     # MÃ‰TODO PARA DETERMINAR SI REQUIERE LABORATORIO BASADO EN EQUIPAMIENTO
|   |   â”‚     def save(self, *args, **kwargs):
|   |   â”‚         # Si no se ha especificado requiere_laboratorio, determinarlo automÃ¡ticamente
|   |   â”‚         if not self.requiere_laboratorio and self.equipamiento_requerido:
|   |   â”‚             equipamiento_lower = self.equipamiento_requerido.lower()
|   |   â”‚             if any(term in equipamiento_lower for term in ['laboratorio', 'lab', 'computadora', 'software', 'equipo']):
|   |   â”‚                 self.requiere_laboratorio = True
|   |   â”‚         super().save(*args, **kwargs)
|   |   â”‚ 
|   |   â”‚ class Aula(models.Model):
|   |   â”‚     TIPO_AULA = [
|   |   â”‚         ('TEORIA', 'Aula de TeorÃ­a'),
|   |   â”‚         ('LABORATORIO', 'Laboratorio'),
|   |   â”‚         ('MIXTA', 'Aula Mixta'),
|   |   â”‚     ]
|   |   â”‚ 
|   |   â”‚     nombre = models.CharField(max_length=100, verbose_name="Nombre del Aula")
|   |   â”‚     capacidad = models.IntegerField(verbose_name="Capacidad MÃ¡xima")
|   |   â”‚     tipo = models.CharField(max_length=20, choices=TIPO_AULA, default='TEORIA')
|   |   â”‚     edificio = models.CharField(max_length=50, blank=True, verbose_name="Edificio")
|   |   â”‚     piso = models.CharField(max_length=10, blank=True, verbose_name="Piso")
|   |   â”‚     tiene_proyector = models.BooleanField(default=False, verbose_name="Tiene Proyector")
|   |   â”‚     tiene_computadoras = models.BooleanField(default=False, verbose_name="Tiene Computadoras")
|   |   â”‚     tiene_pizarra_digital = models.BooleanField(default=False, verbose_name="Tiene Pizarra Digital")
|   |   â”‚     equipamiento_adicional = models.TextField(blank=True, verbose_name="Equipamiento Adicional")
|   |   â”‚     activa = models.BooleanField(default=True, verbose_name="Aula Activa")
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         verbose_name = "Aula"
|   |   â”‚         verbose_name_plural = "Aulas"
|   |   â”‚         ordering = ['edificio', 'piso', 'nombre']
|   |   â”‚ 
|   |   â”‚     def __str__(self):
|   |   â”‚         ubicacion = f"{self.edificio} - " if self.edificio else ""
|   |   â”‚         return f"{ubicacion}{self.nombre} (Cap: {self.capacidad})"
|   |   â”‚ 
|   |   â”‚     def get_equipamiento(self):
|   |   â”‚         equipos = []
|   |   â”‚         if self.tiene_proyector:
|   |   â”‚             equipos.append("Proyector")
|   |   â”‚         if self.tiene_computadoras:
|   |   â”‚             equipos.append("Computadoras")
|   |   â”‚         if self.tiene_pizarra_digital:
|   |   â”‚             equipos.append("Pizarra Digital")
|   |   â”‚         if self.equipamiento_adicional:
|   |   â”‚             equipos.append(self.equipamiento_adicional)
|   |   â”‚         return ", ".join(equipos) if equipos else "Equipamiento bÃ¡sico"
|   |   â”‚ 
|   |   â”‚     # PROPIEDADES DE COMPATIBILIDAD PARA EL ALGORITMO
|   |   â”‚     @property
|   |   â”‚     def tipo_aula(self):
|   |   â”‚         """Compatibilidad con el algoritmo - mapea tipo a los valores esperados"""
|   |   â”‚         mapping = {
|   |   â”‚             'TEORIA': 'NORMAL',
|   |   â”‚             'LABORATORIO': 'LABORATORIO',
|   |   â”‚             'MIXTA': 'NORMAL'
|   |   â”‚         }
|   |   â”‚         return mapping.get(self.tipo, 'NORMAL')
|   |   â”‚ 
|   |   â”‚     @property
|   |   â”‚     def es_laboratorio(self):
|   |   â”‚         """Compatibilidad con el algoritmo"""
|   |   â”‚         return self.tipo == 'LABORATORIO'
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ serializers.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from rest_framework import serializers
|   |   â”‚ from .models import Curso, Aula
|   |   â”‚ 
|   |   â”‚ class CursoSerializer(serializers.ModelSerializer):
|   |   â”‚     requisitos_list = serializers.SerializerMethodField()
|   |   â”‚     estado = serializers.SerializerMethodField()
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         model = Curso
|   |   â”‚         fields = [
|   |   â”‚             'id', 'nombre', 'codigo', 'creditos', 'tipo',
|   |   â”‚             'sesiones_semana', 'duracion_sesion', 'requisitos',
|   |   â”‚             'requisitos_list', 'capacidad_estimada',
|   |   â”‚             'equipamiento_requerido', 'activo', 'estado'
|   |   â”‚         ]
|   |   â”‚         depth = 1
|   |   â”‚ 
|   |   â”‚     def get_requisitos_list(self, obj):
|   |   â”‚         return [f"{curso.codigo} - {curso.nombre}" for curso in obj.requisitos.all()]
|   |   â”‚ 
|   |   â”‚     def get_estado(self, obj):
|   |   â”‚         return "Activo" if obj.activo else "Inactivo"
|   |   â”‚ 
|   |   â”‚ class CursoCreateSerializer(serializers.ModelSerializer):
|   |   â”‚     class Meta:
|   |   â”‚         model = Curso
|   |   â”‚         fields = [
|   |   â”‚             'nombre', 'codigo', 'creditos', 'tipo',
|   |   â”‚             'sesiones_semana', 'duracion_sesion', 'requisitos',
|   |   â”‚             'capacidad_estimada', 'equipamiento_requerido', 'activo'
|   |   â”‚         ]
|   |   â”‚ 
|   |   â”‚ class AulaSerializer(serializers.ModelSerializer):
|   |   â”‚     equipamiento_completo = serializers.SerializerMethodField()
|   |   â”‚     estado = serializers.SerializerMethodField()
|   |   â”‚     ubicacion_completa = serializers.SerializerMethodField()
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         model = Aula
|   |   â”‚         fields = [
|   |   â”‚             'id', 'nombre', 'capacidad', 'tipo', 'edificio', 'piso',
|   |   â”‚             'tiene_proyector', 'tiene_computadoras', 'tiene_pizarra_digital',
|   |   â”‚             'equipamiento_adicional', 'equipamiento_completo',
|   |   â”‚             'activa', 'estado', 'ubicacion_completa'
|   |   â”‚         ]
|   |   â”‚ 
|   |   â”‚     def get_equipamiento_completo(self, obj):
|   |   â”‚         return obj.get_equipamiento()
|   |   â”‚ 
|   |   â”‚     def get_estado(self, obj):
|   |   â”‚         return "Activa" if obj.activa else "Inactiva"
|   |   â”‚ 
|   |   â”‚     def get_ubicacion_completa(self, obj):
|   |   â”‚         ubicacion = f"{obj.edificio} - " if obj.edificio else ""
|   |   â”‚         return f"{ubicacion}{obj.nombre} (Piso {obj.piso})" if obj.piso else f"{ubicacion}{obj.nombre}"
|   |   â”‚ 
|   |   â”‚ class AulaCreateSerializer(serializers.ModelSerializer):
|   |   â”‚     class Meta:
|   |   â”‚         model = Aula
|   |   â”‚         fields = [
|   |   â”‚             'nombre', 'capacidad', 'tipo', 'edificio', 'piso',
|   |   â”‚             'tiene_proyector', 'tiene_computadoras', 'tiene_pizarra_digital',
|   |   â”‚             'equipamiento_adicional', 'activa'
|   |   â”‚         ]
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ tests.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.test import TestCase
|   |   â”‚ from django.urls import reverse
|   |   â”‚ from rest_framework import status
|   |   â”‚ from rest_framework.test import APITestCase
|   |   â”‚ from .models import Curso, Aula
|   |   â”‚ 
|   |   â”‚ class CursoModelTest(TestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.curso = Curso.objects.create(
|   |   â”‚             nombre="Base de Datos II",
|   |   â”‚             codigo="BD2-2024",
|   |   â”‚             creditos=4,
|   |   â”‚             sesiones_semana=2,
|   |   â”‚             capacidad_estimada=40
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚     def test_curso_creation(self):
|   |   â”‚         self.assertEqual(self.curso.nombre, "Base de Datos II")
|   |   â”‚         self.assertEqual(self.curso.codigo, "BD2-2024")
|   |   â”‚         self.assertTrue(self.curso.activo)
|   |   â”‚ 
|   |   â”‚ class AulaModelTest(TestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.aula = Aula.objects.create(
|   |   â”‚             nombre="A-101",
|   |   â”‚             capacidad=50,
|   |   â”‚             edificio="Edificio A",
|   |   â”‚             tiene_proyector=True
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚     def test_aula_creation(self):
|   |   â”‚         self.assertEqual(self.aula.nombre, "A-101")
|   |   â”‚         self.assertEqual(self.aula.capacidad, 50)
|   |   â”‚         self.assertTrue(self.aula.tiene_proyector)
|   |   â”‚ 
|   |   â”‚ class CursoAPITest(APITestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.curso_data = {
|   |   â”‚             'nombre': 'Gerencia de Sistemas',
|   |   â”‚             'codigo': 'GS-2024',
|   |   â”‚             'creditos': 3,
|   |   â”‚             'sesiones_semana': 1,
|   |   â”‚             'capacidad_estimada': 35
|   |   â”‚         }
|   |   â”‚         self.curso = Curso.objects.create(**self.curso_data)
|   |   â”‚ 
|   |   â”‚     def test_list_cursos(self):
|   |   â”‚         url = reverse('curso-list')
|   |   â”‚         response = self.client.get(url)
|   |   â”‚         self.assertEqual(response.status_code, status.HTTP_200_OK)
|   |   â”‚ 
|   |   â”‚     def test_create_curso(self):
|   |   â”‚         url = reverse('curso-list')
|   |   â”‚         new_curso = {
|   |   â”‚             'nombre': 'Inteligencia Artificial',
|   |   â”‚             'codigo': 'IA-2024',
|   |   â”‚             'creditos': 4,
|   |   â”‚             'sesiones_semana': 2,
|   |   â”‚             'capacidad_estimada': 30
|   |   â”‚         }
|   |   â”‚         response = self.client.post(url, new_curso, format='json')
|   |   â”‚         self.assertEqual(response.status_code, status.HTTP_201_CREATED)
|   |   â”‚ 
|   |   â”‚ class AulaAPITest(APITestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.aula_data = {
|   |   â”‚             'nombre': 'Lab-201',
|   |   â”‚             'capacidad': 25,
|   |   â”‚             'tipo': 'LABORATORIO',
|   |   â”‚             'tiene_computadoras': True
|   |   â”‚         }
|   |   â”‚         self.aula = Aula.objects.create(**self.aula_data)
|   |   â”‚ 
|   |   â”‚     def test_list_aulas(self):
|   |   â”‚         url = reverse('aula-list')
|   |   â”‚         response = self.client.get(url)
|   |   â”‚         self.assertEqual(response.status_code, status.HTTP_200_OK)
|   |   â”‚ 
|   |   â”‚     def test_filter_aulas_by_capacity(self):
|   |   â”‚         url = reverse('aula-list') + '?capacidad_min=20'
|   |   â”‚         response = self.client.get(url)
|   |   â”‚         self.assertEqual(response.status_code, status.HTTP_200_OK)
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ urls.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.urls import path, include
|   |   â”‚ from rest_framework.routers import DefaultRouter
|   |   â”‚ from . import views
|   |   â”‚ 
|   |   â”‚ router = DefaultRouter()
|   |   â”‚ router.register(r'cursos', views.CursoViewSet, basename='curso')
|   |   â”‚ router.register(r'aulas', views.AulaViewSet, basename='aula')
|   |   â”‚ 
|   |   â”‚ urlpatterns = [
|   |   â”‚     path('', include(router.urls)),
|   |   â”‚ ]
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   `-- ğŸ“„ views.py
|       â”Œâ”€ CONTENIDO â”€â”
|       â”‚ from rest_framework import viewsets, status
|       â”‚ from rest_framework.decorators import action
|       â”‚ from rest_framework.response import Response
|       â”‚ from django.db.models import Q
|       â”‚ from .models import Curso, Aula
|       â”‚ from .serializers import (
|       â”‚     CursoSerializer, CursoCreateSerializer,
|       â”‚     AulaSerializer, AulaCreateSerializer
|       â”‚ )
|       â”‚ 
|       â”‚ class CursoViewSet(viewsets.ModelViewSet):
|       â”‚     queryset = Curso.objects.all()
|       â”‚ 
|       â”‚     def get_serializer_class(self):
|       â”‚         if self.action in ['create', 'update', 'partial_update']:
|       â”‚             return CursoCreateSerializer
|       â”‚         return CursoSerializer
|       â”‚ 
|       â”‚     def get_queryset(self):
|       â”‚         queryset = Curso.objects.all()
|       â”‚ 
|       â”‚         # Filtros
|       â”‚         tipo = self.request.query_params.get('tipo', None)
|       â”‚         activo = self.request.query_params.get('activo', None)
|       â”‚         search = self.request.query_params.get('search', None)
|       â”‚ 
|       â”‚         if tipo:
|       â”‚             queryset = queryset.filter(tipo=tipo)
|       â”‚         if activo is not None:
|       â”‚             queryset = queryset.filter(activo=activo.lower() == 'true')
|       â”‚         if search:
|       â”‚             queryset = queryset.filter(
|       â”‚                 Q(codigo__icontains=search) |
|       â”‚                 Q(nombre__icontains=search)
|       â”‚             )
|       â”‚ 
|       â”‚         return queryset
|       â”‚ 
|       â”‚     @action(detail=False, methods=['get'])
|       â”‚     def estadisticas(self, request):
|       â”‚         total_cursos = Curso.objects.count()
|       â”‚         cursos_activos = Curso.objects.filter(activo=True).count()
|       â”‚         cursos_obligatorios = Curso.objects.filter(tipo='OBLIGATORIO').count()
|       â”‚         cursos_electivos = Curso.objects.filter(tipo='ELECTIVO').count()
|       â”‚ 
|       â”‚         return Response({
|       â”‚             'total_cursos': total_cursos,
|       â”‚             'cursos_activos': cursos_activos,
|       â”‚             'cursos_obligatorios': cursos_obligatorios,
|       â”‚             'cursos_electivos': cursos_electivos,
|       â”‚         })
|       â”‚ 
|       â”‚ class AulaViewSet(viewsets.ModelViewSet):
|       â”‚     queryset = Aula.objects.all()
|       â”‚ 
|       â”‚     def get_serializer_class(self):
|       â”‚         if self.action in ['create', 'update', 'partial_update']:
|       â”‚             return AulaCreateSerializer
|       â”‚         return AulaSerializer
|       â”‚ 
|       â”‚     def get_queryset(self):
|       â”‚         queryset = Aula.objects.all()
|       â”‚ 
|       â”‚         # Filtros
|       â”‚         tipo = self.request.query_params.get('tipo', None)
|       â”‚         activa = self.request.query_params.get('activa', None)
|       â”‚         capacidad_min = self.request.query_params.get('capacidad_min', None)
|       â”‚         search = self.request.query_params.get('search', None)
|       â”‚ 
|       â”‚         if tipo:
|       â”‚             queryset = queryset.filter(tipo=tipo)
|       â”‚         if activa is not None:
|       â”‚             queryset = queryset.filter(activa=activa.lower() == 'true')
|       â”‚         if capacidad_min:
|       â”‚             queryset = queryset.filter(capacidad__gte=int(capacidad_min))
|       â”‚         if search:
|       â”‚             queryset = queryset.filter(
|       â”‚                 Q(nombre__icontains=search) |
|       â”‚                 Q(edificio__icontains=search)
|       â”‚             )
|       â”‚ 
|       â”‚         return queryset
|       â”‚ 
|       â”‚     @action(detail=False, methods=['get'])
|       â”‚     def disponibles(self, request):
|       â”‚         """Aulas disponibles para asignaciÃ³n"""
|       â”‚         aulas = Aula.objects.filter(activa=True)
|       â”‚         serializer = self.get_serializer(aulas, many=True)
|       â”‚         return Response(serializer.data)
|       â”‚ 
|       â”‚     @action(detail=False, methods=['get'])
|       â”‚     def estadisticas(self, request):
|       â”‚         total_aulas = Aula.objects.count()
|       â”‚         aulas_activas = Aula.objects.filter(activa=True).count()
|       â”‚         capacidad_total = sum(aula.capacidad for aula in Aula.objects.filter(activa=True))
|       â”‚ 
|       â”‚         return Response({
|       â”‚             'total_aulas': total_aulas,
|       â”‚             'aulas_activas': aulas_activas,
|       â”‚             'capacidad_total': capacidad_total,
|       â”‚         })
|       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|-- ğŸ“ backend/
|-- ğŸ“„ estructura_completa_proyecto.txt
|   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ ğŸ“ HORA-UNAP/
|   â”‚ |-- ğŸ“„ .gitignore
|   â”‚ |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   â”‚ # Entorno virtual de Python
|   â”‚ |   â”‚ backend/venv/
|   â”‚ |   â”‚
|   â”‚ |   â”‚ # Archivos de cachÃ© de Python
|   â”‚ |   â”‚ __pycache__/
|   â”‚ |   â”‚ *.pyc
|   â”‚ |   â”‚
|   â”‚ |   â”‚ # Base de datos local
|   â”‚ |   â”‚ db.sqlite3
|   â”‚ |   â”‚
|   â”‚ |   â”‚ # Dependencias de Node.js
|   â”‚ |   â”‚ frontend/node_modules/
|   â”‚ |   â”‚
|   â”‚ |   â”‚ # Archivos de build de React
|   â”‚ |   â”‚ frontend/build/
|   â”‚ |   â”‚
|   â”‚ |   â”‚ # Archivos de entorno
|   â”‚ |   â”‚ .env
|   â”‚ |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |-- ğŸ“ academic/
|   â”‚ |   |-- ğŸ“„ __init__.py
|   â”‚ |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   â”‚ # academic/__init__.py
|   â”‚ |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |-- ğŸ“„ admin.py
|   â”‚ |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   â”‚ from django.contrib import admin
|   â”‚ |   |   â”‚ from .models import Curso, Aula
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ @admin.register(Curso)
|   â”‚ |   |   â”‚ class CursoAdmin(admin.ModelAdmin):
|   â”‚ |   |   â”‚     list_display = ['codigo', 'nombre', 'creditos', 'tipo', 'sesiones_semana', 'activo']
|   â”‚ |   |   â”‚     list_filter = ['tipo', 'activo']
|   â”‚ |   |   â”‚     search_fields = ['codigo', 'nombre']
|   â”‚ |   |   â”‚     filter_horizontal = ['requisitos']
|   â”‚ |   |   â”‚     list_editable = ['activo']
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ @admin.register(Aula)
|   â”‚ |   |   â”‚ class AulaAdmin(admin.ModelAdmin):
|   â”‚ |   |   â”‚     list_display = ['nombre', 'edificio', 'capacidad', 'tipo', 'tiene_proyector', 'activa']
|   â”‚ |   |   â”‚     list_filter = ['tipo', 'edificio', 'activa', 'tiene_proyector', 'tiene_computadoras']
|   â”‚ |   |   â”‚     search_fields = ['nombre', 'edificio']
|   â”‚ |   |   â”‚     list_editable = ['activa']
|   â”‚ |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |-- ğŸ“„ apps.py
|   â”‚ |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   â”‚ from django.apps import AppConfig
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class AcademicConfig(AppConfig):
|   â”‚ |   |   â”‚     default_auto_field = 'django.db.models.BigAutoField'
|   â”‚ |   |   â”‚     name = 'academic'
|   â”‚ |   |   â”‚     verbose_name = 'GestiÃ³n AcadÃ©mica'
|   â”‚ |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |-- ğŸ“ migrations/
|   â”‚ |   |   |-- ğŸ“„ 0001_initial.py
|   â”‚ |   |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-12 17:47
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚ from django.db import migrations, models
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚ class Migration(migrations.Migration):
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚     initial = True
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚     dependencies = [
|   â”‚ |   |   |   â”‚     ]
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚     operations = [
|   â”‚ |   |   |   â”‚         migrations.CreateModel(
|   â”‚ |   |   |   â”‚             name='Aula',
|   â”‚ |   |   |   â”‚             fields=[
|   â”‚ |   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   â”‚ |   |   |   â”‚                 ('nombre', models.CharField(max_length=100, verbose_name='Nombre del Aula')),
|   â”‚ |   |   |   â”‚                 ('capacidad', models.IntegerField(verbose_name='Capacidad MÃ¡xima')),
|   â”‚ |   |   |   â”‚                 ('tipo', models.CharField(choices=[('TEORIA', 'Aula de TeorÃ­a'), ('LABORATORIO', 'Laboratorio'), ('MIXTA', 'Aula Mixta')], default='TEORIA', max_length=20)),
|   â”‚ |   |   |   â”‚                 ('edificio', models.CharField(blank=True, max_length=50, verbose_name='Edificio')),
|   â”‚ |   |   |   â”‚                 ('piso', models.CharField(blank=True, max_length=10, verbose_name='Piso')),
|   â”‚ |   |   |   â”‚                 ('tiene_proyector', models.BooleanField(default=False, verbose_name='Tiene Proyector')),
|   â”‚ |   |   |   â”‚                 ('tiene_computadoras', models.BooleanField(default=False, verbose_name='Tiene Computadoras')),
|   â”‚ |   |   |   â”‚                 ('tiene_pizarra_digital', models.BooleanField(default=False, verbose_name='Tiene Pizarra Digital')),
|   â”‚ |   |   |   â”‚                 ('equipamiento_adicional', models.TextField(blank=True, verbose_name='Equipamiento Adicional')),
|   â”‚ |   |   |   â”‚                 ('activa', models.BooleanField(default=True, verbose_name='Aula Activa')),
|   â”‚ |   |   |   â”‚             ],
|   â”‚ |   |   |   â”‚             options={
|   â”‚ |   |   |   â”‚                 'verbose_name': 'Aula',
|   â”‚ |   |   |   â”‚                 'verbose_name_plural': 'Aulas',
|   â”‚ |   |   |   â”‚                 'ordering': ['edificio', 'piso', 'nombre'],
|   â”‚ |   |   |   â”‚             },
|   â”‚ |   |   |   â”‚         ),
|   â”‚ |   |   |   â”‚         migrations.CreateModel(
|   â”‚ |   |   |   â”‚             name='Curso',
|   â”‚ |   |   |   â”‚             fields=[
|   â”‚ |   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   â”‚ |   |   |   â”‚                 ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Curso')),
|   â”‚ |   |   |   â”‚                 ('codigo', models.CharField(max_length=20, unique=True, verbose_name='CÃ³digo del Curso')),
|   â”‚ |   |   |   â”‚                 ('creditos', models.IntegerField(verbose_name='NÃºmero de CrÃ©ditos')),
|   â”‚ |   |   |   â”‚                 ('tipo', models.CharField(choices=[('OBLIGATORIO', 'Obligatorio'), ('ELECTIVO', 'Electivo'), ('OPTATIVO', 'Optativo')], default='OBLIGATORIO', max_length=20)),
|   â”‚ |   |   |   â”‚                 ('sesiones_semana', models.IntegerField(default=1, verbose_name='Sesiones por Semana')),
|   â”‚ |   |   |   â”‚                 ('duracion_sesion', models.IntegerField(default=2, verbose_name='DuraciÃ³n de SesiÃ³n (horas)')),
|   â”‚ |   |   |   â”‚                 ('capacidad_estimada', models.IntegerField(default=30, verbose_name='Capacidad Estimada de Estudiantes')),
|   â”‚ |   |   |   â”‚                 ('equipamiento_requerido', models.TextField(blank=True, verbose_name='Equipamiento Requerido')),
|   â”‚ |   |   |   â”‚                 ('activo', models.BooleanField(default=True, verbose_name='Curso Activo')),
|   â”‚ |   |   |   â”‚                 ('requisitos', models.ManyToManyField(blank=True, to='academic.curso', verbose_name='Prerrequisitos')),
|   â”‚ |   |   |   â”‚             ],
|   â”‚ |   |   |   â”‚             options={
|   â”‚ |   |   |   â”‚                 'verbose_name': 'Curso',
|   â”‚ |   |   |   â”‚                 'verbose_name_plural': 'Cursos',
|   â”‚ |   |   |   â”‚                 'ordering': ['codigo'],
|   â”‚ |   |   |   â”‚             },
|   â”‚ |   |   |   â”‚         ),
|   â”‚ |   |   |   â”‚     ]
|   â”‚ |   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |   |-- ğŸ“„ 0002_curso_requiere_laboratorio.py
|   â”‚ |   |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-13 02:54
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚ from django.db import migrations, models
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚ class Migration(migrations.Migration):
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚     dependencies = [
|   â”‚ |   |   |   â”‚         ('academic', '0001_initial'),
|   â”‚ |   |   |   â”‚     ]
|   â”‚ |   |   |   â”‚
|   â”‚ |   |   |   â”‚     operations = [
|   â”‚ |   |   |   â”‚         migrations.AddField(
|   â”‚ |   |   |   â”‚             model_name='curso',
|   â”‚ |   |   |   â”‚             name='requiere_laboratorio',
|   â”‚ |   |   |   â”‚             field=models.BooleanField(default=False, verbose_name='Requiere Laboratorio'),
|   â”‚ |   |   |   â”‚         ),
|   â”‚ |   |   |   â”‚     ]
|   â”‚ |   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |   `-- ğŸ“„ __init__.py
|   â”‚ |   |         (Archivo vacÃ­o)
|   â”‚ |   |-- ğŸ“„ models.py
|   â”‚ |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   â”‚ from django.db import models
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class Curso(models.Model):
|   â”‚ |   |   â”‚     TIPO_CURSO = [
|   â”‚ |   |   â”‚         ('OBLIGATORIO', 'Obligatorio'),
|   â”‚ |   |   â”‚         ('ELECTIVO', 'Electivo'),
|   â”‚ |   |   â”‚         ('OPTATIVO', 'Optativo'),
|   â”‚ |   |   â”‚     ]
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     nombre = models.CharField(max_length=200, verbose_name="Nombre del Curso")
|   â”‚ |   |   â”‚     codigo = models.CharField(max_length=20, unique=True, verbose_name="CÃ³digo del Curso")
|   â”‚ |   |   â”‚     creditos = models.IntegerField(verbose_name="NÃºmero de CrÃ©ditos")
|   â”‚ |   |   â”‚     tipo = models.CharField(max_length=20, choices=TIPO_CURSO, default='OBLIGATORIO')
|   â”‚ |   |   â”‚     sesiones_semana = models.IntegerField(default=1, verbose_name="Sesiones por Semana")
|   â”‚ |   |   â”‚     duracion_sesion = models.IntegerField(default=2, verbose_name="DuraciÃ³n de SesiÃ³n (horas)")
|   â”‚ |   |   â”‚     requisitos = models.ManyToManyField('self', symmetrical=False, blank=True, verbose_name="Prerrequisitos")
|   â”‚ |   |   â”‚     capacidad_estimada = models.IntegerField(default=30, verbose_name="Capacidad Estimada de Estudiantes")
|   â”‚ |   |   â”‚     equipamiento_requerido = models.TextField(blank=True, verbose_name="Equipamiento Requerido")
|   â”‚ |   |   â”‚     activo = models.BooleanField(default=True, verbose_name="Curso Activo")
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     # NUEVO CAMPO AGREGADO PARA COMPATIBILIDAD CON EL ALGORITMO
|   â”‚ |   |   â”‚     requiere_laboratorio = models.BooleanField(default=False, verbose_name="Requiere Laboratorio")
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     class Meta:
|   â”‚ |   |   â”‚         verbose_name = "Curso"
|   â”‚ |   |   â”‚         verbose_name_plural = "Cursos"
|   â”‚ |   |   â”‚         ordering = ['codigo']
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def __str__(self):
|   â”‚ |   |   â”‚         return f"{self.codigo} - {self.nombre}"
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     # MÃ‰TODO PARA DETERMINAR SI REQUIERE LABORATORIO BASADO EN EQUIPAMIENTO
|   â”‚ |   |   â”‚     def save(self, *args, **kwargs):
|   â”‚ |   |   â”‚         # Si no se ha especificado requiere_laboratorio, determinarlo automÃ¡ticamente
|   â”‚ |   |   â”‚         if not self.requiere_laboratorio and self.equipamiento_requerido:
|   â”‚ |   |   â”‚             equipamiento_lower = self.equipamiento_requerido.lower()
|   â”‚ |   |   â”‚             if any(term in equipamiento_lower for term in ['laboratorio', 'lab', 'computadora', 'software', 'equipo']):
|   â”‚ |   |   â”‚                 self.requiere_laboratorio = True
|   â”‚ |   |   â”‚         super().save(*args, **kwargs)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class Aula(models.Model):
|   â”‚ |   |   â”‚     TIPO_AULA = [
|   â”‚ |   |   â”‚         ('TEORIA', 'Aula de TeorÃ­a'),
|   â”‚ |   |   â”‚         ('LABORATORIO', 'Laboratorio'),
|   â”‚ |   |   â”‚         ('MIXTA', 'Aula Mixta'),
|   â”‚ |   |   â”‚     ]
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     nombre = models.CharField(max_length=100, verbose_name="Nombre del Aula")
|   â”‚ |   |   â”‚     capacidad = models.IntegerField(verbose_name="Capacidad MÃ¡xima")
|   â”‚ |   |   â”‚     tipo = models.CharField(max_length=20, choices=TIPO_AULA, default='TEORIA')
|   â”‚ |   |   â”‚     edificio = models.CharField(max_length=50, blank=True, verbose_name="Edificio")
|   â”‚ |   |   â”‚     piso = models.CharField(max_length=10, blank=True, verbose_name="Piso")
|   â”‚ |   |   â”‚     tiene_proyector = models.BooleanField(default=False, verbose_name="Tiene Proyector")
|   â”‚ |   |   â”‚     tiene_computadoras = models.BooleanField(default=False, verbose_name="Tiene Computadoras")
|   â”‚ |   |   â”‚     tiene_pizarra_digital = models.BooleanField(default=False, verbose_name="Tiene Pizarra Digital")
|   â”‚ |   |   â”‚     equipamiento_adicional = models.TextField(blank=True, verbose_name="Equipamiento Adicional")
|   â”‚ |   |   â”‚     activa = models.BooleanField(default=True, verbose_name="Aula Activa")
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     class Meta:
|   â”‚ |   |   â”‚         verbose_name = "Aula"
|   â”‚ |   |   â”‚         verbose_name_plural = "Aulas"
|   â”‚ |   |   â”‚         ordering = ['edificio', 'piso', 'nombre']
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def __str__(self):
|   â”‚ |   |   â”‚         ubicacion = f"{self.edificio} - " if self.edificio else ""
|   â”‚ |   |   â”‚         return f"{ubicacion}{self.nombre} (Cap: {self.capacidad})"
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def get_equipamiento(self):
|   â”‚ |   |   â”‚         equipos = []
|   â”‚ |   |   â”‚         if self.tiene_proyector:
|   â”‚ |   |   â”‚             equipos.append("Proyector")
|   â”‚ |   |   â”‚         if self.tiene_computadoras:
|   â”‚ |   |   â”‚             equipos.append("Computadoras")
|   â”‚ |   |   â”‚         if self.tiene_pizarra_digital:
|   â”‚ |   |   â”‚             equipos.append("Pizarra Digital")
|   â”‚ |   |   â”‚         if self.equipamiento_adicional:
|   â”‚ |   |   â”‚             equipos.append(self.equipamiento_adicional)
|   â”‚ |   |   â”‚         return ", ".join(equipos) if equipos else "Equipamiento bÃ¡sico"
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     # PROPIEDADES DE COMPATIBILIDAD PARA EL ALGORITMO
|   â”‚ |   |   â”‚     @property
|   â”‚ |   |   â”‚     def tipo_aula(self):
|   â”‚ |   |   â”‚         """Compatibilidad con el algoritmo - mapea tipo a los valores esperados"""
|   â”‚ |   |   â”‚         mapping = {
|   â”‚ |   |   â”‚             'TEORIA': 'NORMAL',
|   â”‚ |   |   â”‚             'LABORATORIO': 'LABORATORIO',
|   â”‚ |   |   â”‚             'MIXTA': 'NORMAL'
|   â”‚ |   |   â”‚         }
|   â”‚ |   |   â”‚         return mapping.get(self.tipo, 'NORMAL')
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     @property
|   â”‚ |   |   â”‚     def es_laboratorio(self):
|   â”‚ |   |   â”‚         """Compatibilidad con el algoritmo"""
|   â”‚ |   |   â”‚         return self.tipo == 'LABORATORIO'
|   â”‚ |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |-- ğŸ“„ serializers.py
|   â”‚ |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   â”‚ from rest_framework import serializers
|   â”‚ |   |   â”‚ from .models import Curso, Aula
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class CursoSerializer(serializers.ModelSerializer):
|   â”‚ |   |   â”‚     requisitos_list = serializers.SerializerMethodField()
|   â”‚ |   |   â”‚     estado = serializers.SerializerMethodField()
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     class Meta:
|   â”‚ |   |   â”‚         model = Curso
|   â”‚ |   |   â”‚         fields = [
|   â”‚ |   |   â”‚             'id', 'nombre', 'codigo', 'creditos', 'tipo',
|   â”‚ |   |   â”‚             'sesiones_semana', 'duracion_sesion', 'requisitos',
|   â”‚ |   |   â”‚             'requisitos_list', 'capacidad_estimada',
|   â”‚ |   |   â”‚             'equipamiento_requerido', 'activo', 'estado'
|   â”‚ |   |   â”‚         ]
|   â”‚ |   |   â”‚         depth = 1
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def get_requisitos_list(self, obj):
|   â”‚ |   |   â”‚         return [f"{curso.codigo} - {curso.nombre}" for curso in obj.requisitos.all()]
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def get_estado(self, obj):
|   â”‚ |   |   â”‚         return "Activo" if obj.activo else "Inactivo"
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class CursoCreateSerializer(serializers.ModelSerializer):
|   â”‚ |   |   â”‚     class Meta:
|   â”‚ |   |   â”‚         model = Curso
|   â”‚ |   |   â”‚         fields = [
|   â”‚ |   |   â”‚             'nombre', 'codigo', 'creditos', 'tipo',
|   â”‚ |   |   â”‚             'sesiones_semana', 'duracion_sesion', 'requisitos',
|   â”‚ |   |   â”‚             'capacidad_estimada', 'equipamiento_requerido', 'activo'
|   â”‚ |   |   â”‚         ]
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class AulaSerializer(serializers.ModelSerializer):
|   â”‚ |   |   â”‚     equipamiento_completo = serializers.SerializerMethodField()
|   â”‚ |   |   â”‚     estado = serializers.SerializerMethodField()
|   â”‚ |   |   â”‚     ubicacion_completa = serializers.SerializerMethodField()
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     class Meta:
|   â”‚ |   |   â”‚         model = Aula
|   â”‚ |   |   â”‚         fields = [
|   â”‚ |   |   â”‚             'id', 'nombre', 'capacidad', 'tipo', 'edificio', 'piso',
|   â”‚ |   |   â”‚             'tiene_proyector', 'tiene_computadoras', 'tiene_pizarra_digital',
|   â”‚ |   |   â”‚             'equipamiento_adicional', 'equipamiento_completo',
|   â”‚ |   |   â”‚             'activa', 'estado', 'ubicacion_completa'
|   â”‚ |   |   â”‚         ]
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def get_equipamiento_completo(self, obj):
|   â”‚ |   |   â”‚         return obj.get_equipamiento()
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def get_estado(self, obj):
|   â”‚ |   |   â”‚         return "Activa" if obj.activa else "Inactiva"
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def get_ubicacion_completa(self, obj):
|   â”‚ |   |   â”‚         ubicacion = f"{obj.edificio} - " if obj.edificio else ""
|   â”‚ |   |   â”‚         return f"{ubicacion}{obj.nombre} (Piso {obj.piso})" if obj.piso else f"{ubicacion}{obj.nombre}"
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class AulaCreateSerializer(serializers.ModelSerializer):
|   â”‚ |   |   â”‚     class Meta:
|   â”‚ |   |   â”‚         model = Aula
|   â”‚ |   |   â”‚         fields = [
|   â”‚ |   |   â”‚             'nombre', 'capacidad', 'tipo', 'edificio', 'piso',
|   â”‚ |   |   â”‚             'tiene_proyector', 'tiene_computadoras', 'tiene_pizarra_digital',
|   â”‚ |   |   â”‚             'equipamiento_adicional', 'activa'
|   â”‚ |   |   â”‚         ]
|   â”‚ |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |-- ğŸ“„ tests.py
|   â”‚ |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   â”‚ from django.test import TestCase
|   â”‚ |   |   â”‚ from django.urls import reverse
|   â”‚ |   |   â”‚ from rest_framework import status
|   â”‚ |   |   â”‚ from rest_framework.test import APITestCase
|   â”‚ |   |   â”‚ from .models import Curso, Aula
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class CursoModelTest(TestCase):
|   â”‚ |   |   â”‚     def setUp(self):
|   â”‚ |   |   â”‚         self.curso = Curso.objects.create(
|   â”‚ |   |   â”‚             nombre="Base de Datos II",
|   â”‚ |   |   â”‚             codigo="BD2-2024",
|   â”‚ |   |   â”‚             creditos=4,
|   â”‚ |   |   â”‚             sesiones_semana=2,
|   â”‚ |   |   â”‚             capacidad_estimada=40
|   â”‚ |   |   â”‚         )
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def test_curso_creation(self):
|   â”‚ |   |   â”‚         self.assertEqual(self.curso.nombre, "Base de Datos II")
|   â”‚ |   |   â”‚         self.assertEqual(self.curso.codigo, "BD2-2024")
|   â”‚ |   |   â”‚         self.assertTrue(self.curso.activo)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class AulaModelTest(TestCase):
|   â”‚ |   |   â”‚     def setUp(self):
|   â”‚ |   |   â”‚         self.aula = Aula.objects.create(
|   â”‚ |   |   â”‚             nombre="A-101",
|   â”‚ |   |   â”‚             capacidad=50,
|   â”‚ |   |   â”‚             edificio="Edificio A",
|   â”‚ |   |   â”‚             tiene_proyector=True
|   â”‚ |   |   â”‚         )
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def test_aula_creation(self):
|   â”‚ |   |   â”‚         self.assertEqual(self.aula.nombre, "A-101")
|   â”‚ |   |   â”‚         self.assertEqual(self.aula.capacidad, 50)
|   â”‚ |   |   â”‚         self.assertTrue(self.aula.tiene_proyector)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class CursoAPITest(APITestCase):
|   â”‚ |   |   â”‚     def setUp(self):
|   â”‚ |   |   â”‚         self.curso_data = {
|   â”‚ |   |   â”‚             'nombre': 'Gerencia de Sistemas',
|   â”‚ |   |   â”‚             'codigo': 'GS-2024',
|   â”‚ |   |   â”‚             'creditos': 3,
|   â”‚ |   |   â”‚             'sesiones_semana': 1,
|   â”‚ |   |   â”‚             'capacidad_estimada': 35
|   â”‚ |   |   â”‚         }
|   â”‚ |   |   â”‚         self.curso = Curso.objects.create(**self.curso_data)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def test_list_cursos(self):
|   â”‚ |   |   â”‚         url = reverse('curso-list')
|   â”‚ |   |   â”‚         response = self.client.get(url)
|   â”‚ |   |   â”‚         self.assertEqual(response.status_code, status.HTTP_200_OK)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def test_create_curso(self):
|   â”‚ |   |   â”‚         url = reverse('curso-list')
|   â”‚ |   |   â”‚         new_curso = {
|   â”‚ |   |   â”‚             'nombre': 'Inteligencia Artificial',
|   â”‚ |   |   â”‚             'codigo': 'IA-2024',
|   â”‚ |   |   â”‚             'creditos': 4,
|   â”‚ |   |   â”‚             'sesiones_semana': 2,
|   â”‚ |   |   â”‚             'capacidad_estimada': 30
|   â”‚ |   |   â”‚         }
|   â”‚ |   |   â”‚         response = self.client.post(url, new_curso, format='json')
|   â”‚ |   |   â”‚         self.assertEqual(response.status_code, status.HTTP_201_CREATED)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ class AulaAPITest(APITestCase):
|   â”‚ |   |   â”‚     def setUp(self):
|   â”‚ |   |   â”‚         self.aula_data = {
|   â”‚ |   |   â”‚             'nombre': 'Lab-201',
|   â”‚ |   |   â”‚             'capacidad': 25,
|   â”‚ |   |   â”‚             'tipo': 'LABORATORIO',
|   â”‚ |   |   â”‚             'tiene_computadoras': True
|   â”‚ |   |   â”‚         }
|   â”‚ |   |   â”‚         self.aula = Aula.objects.create(**self.aula_data)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def test_list_aulas(self):
|   â”‚ |   |   â”‚         url = reverse('aula-list')
|   â”‚ |   |   â”‚         response = self.client.get(url)
|   â”‚ |   |   â”‚         self.assertEqual(response.status_code, status.HTTP_200_OK)
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚     def test_filter_aulas_by_capacity(self):
|   â”‚ |   |   â”‚         url = reverse('aula-list') + '?capacidad_min=20'
|   â”‚ |   |   â”‚         response = self.client.get(url)
|   â”‚ |   |   â”‚         self.assertEqual(response.status_code, status.HTTP_200_OK)
|   â”‚ |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   |-- ğŸ“„ urls.py
|   â”‚ |   |   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |   |   â”‚ from django.urls import path, include
|   â”‚ |   |   â”‚ from rest_framework.routers import DefaultRouter
|   â”‚ |   |   â”‚ from . import views
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ router = DefaultRouter()
|   â”‚ |   |   â”‚ router.register(r'cursos', views.CursoViewSet, basename='curso')
|   â”‚ |   |   â”‚ router.register(r'aulas', views.AulaViewSet, basename='aula')
|   â”‚ |   |   â”‚
|   â”‚ |   |   â”‚ urlpatterns = [
|   â”‚ |   |   â”‚     path('', include(router.urls)),
|   â”‚ |   |   â”‚ ]
|   â”‚ |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   â”‚ |   `-- ğŸ“„ views.py
|   â”‚ |       â”Œâ”€ CONTENIDO â”€â”
|   â”‚ |       â”‚ from rest_framework import viewsets, status
|   â”‚ |       â”‚ from rest_framework.decorators import action
|   â”‚ |       â”‚ from rest_framework.response import Response
|   â”‚ |       â”‚ from django.db.models import Q
|   â”‚ |       â”‚ from .models import Curso, Aula
|   â”‚ |       â”‚ from .serializers import (
|   â”‚ |       â”‚     CursoSerializer, CursoCreateSerializer,
|   â”‚ |       â”‚     AulaSerializer, AulaCreateSerializer
|   â”‚ |       â”‚ )
|   â”‚ |       â”‚
|   â”‚ |       â”‚ class CursoViewSet(viewsets.ModelViewSet):
|   â”‚ |       â”‚     queryset = Curso.objects.all()
|   â”‚ |       â”‚
|   â”‚ |       â”‚     def get_serializer_class(self):
|   â”‚ |       â”‚         if self.action in ['create', 'update', 'partial_update']:
|   â”‚ |       â”‚             return CursoCreateSerializer
|   â”‚ |       â”‚         return CursoSerializer
|   â”‚ |       â”‚
|   â”‚ |       â”‚     def get_queryset(self):
|   â”‚ |       â”‚         queryset = Curso.objects.all()
|   â”‚ |       â”‚
|   â”‚ |       â”‚         # Filtros
|   â”‚ |       â”‚         tipo = self.request.query_params.get('tipo', None)
|   â”‚ |       â”‚         activo = self.request.query_params.get('activo', None)
|   â”‚ |       â”‚         search = self.request.query_params.get('search', None)
|   â”‚ |       â”‚
|   â”‚ |       â”‚         if tipo:
|   â”‚ |       â”‚             queryset = queryset.filter(tipo=tipo)
|   â”‚ |       â”‚         if activo is not None:
|   â”‚ |       â”‚             queryset = queryset.filter(activo=activo.lower() == 'true')
|   â”‚ |       â”‚         if search:
|   â”‚ |       â”‚             queryset = queryset.filter(
|   â”‚ |       â”‚                 Q(codigo__icontains=search) |
|   â”‚ |       â”‚                 Q(nombre__icontains=search)
|   â”‚ |       â”‚             )
|   â”‚ |       â”‚
|   â”‚ |       â”‚         return queryset
|   â”‚ |       â”‚
|   â”‚ |       â”‚     @action(detail=False, methods=['get'])
|   â”‚ |       â”‚     def estadisticas(self, request):
|   â”‚ |       â”‚         total_cursos = Curso.objects.count()
|   â”‚ |       â”‚         cursos_activos = Curso.objects.filter(activo=True).count()
|   â”‚ |       â”‚         cursos_obligatorios = Curso.objects.filter(tipo='OBLIGATORIO').count()
|   â”‚ |       â”‚         cursos_electivos = Curso.objects.filter(tipo='ELECTIVO').count()
|   â”‚ |       â”‚
|   â”‚ |       â”‚         return Response({
|   â”‚ |       â”‚             'total_cursos': total_cursos,
|   â”‚ |       â”‚             'cursos_activos': cursos_activos,
|   â”‚ |       â”‚             'cursos_obligatorios': cursos_obligatorios,
|   â”‚ |       â”‚             'cursos_electivos': cursos_electivos,
|   â”‚ |       â”‚         })
|   â”‚ |       â”‚
|   â”‚ |       â”‚ class AulaViewSet(viewsets.ModelViewSet):
|   â”‚ |       â”‚     queryset = Aula.objects.all()
|   â”‚ |       â”‚
|   â”‚ |       â”‚     def get_serializer_class(self):
|   â”‚ |       â”‚         if self.action in ['create', 'update', 'partial_update']:
|   â”‚ |       â”‚             return AulaCreateSerializer
|   â”‚ |       â”‚         return AulaSerializer
|   â”‚ |       â”‚
|   â”‚ |       â”‚     def get_queryset(self):
|   â”‚ |       â”‚         queryset = Aula.objects.all()
|   â”‚ |       â”‚
|   â”‚ |       â”‚         # Filtros
|   â”‚ |       â”‚         tipo = self.request.query_params.get('tipo', None)
|   â”‚ |       â”‚         activa = self.request.query_params.get('activa', None)
|   â”‚ |       â”‚         capacidad_min = self.request.query_params.get('capacidad_min', None)
|   â”‚ |       â”‚         search = self.request.query_params.get('search', None)
|   â”‚ |       â”‚
|   â”‚ |       â”‚         if tipo:
|   â”‚ |       â”‚             queryset = queryset.filter(tipo=tipo)
|   â”‚ |       â”‚         if activa is not None:
|   â”‚ |       â”‚             queryset = queryset.filter(activa=activa.lower() == 'true')
|   â”‚ |       â”‚         if capacidad_min:
|   â”‚ |       â”‚             queryset = queryset.filter(capacidad__gte=int(capacidad_min))
|   â”‚ |       â”‚         if search:
|   â”‚ |       â”‚             queryset = queryset.filter(
|   â”‚ |       â”‚                 Q(nombre__icontains=search) |
|   â”‚ |       â”‚                 Q(edificio__icontains=search)
|   â”‚ |       â”‚             )
|   â”‚ |       â”‚
|   â”‚ |       â”‚         return queryset
|   â”‚ |       â”‚
|   â”‚ |       â”‚     @action(detail=False, methods=['get'])
|   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 
|           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|-- ğŸ“ horunap_api/
|   |-- ğŸ“„ __init__.py
|   |     (Archivo vacÃ­o)
|   |-- ğŸ“„ asgi.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ """
|   |   â”‚ ASGI config for horunap_api project.
|   |   â”‚ 
|   |   â”‚ It exposes the ASGI callable as a module-level variable named ``application``.
|   |   â”‚ 
|   |   â”‚ For more information on this file, see
|   |   â”‚ https://docs.djangoproject.com/en/5.2/howto/deployment/asgi/
|   |   â”‚ """
|   |   â”‚ 
|   |   â”‚ import os
|   |   â”‚ 
|   |   â”‚ from django.core.asgi import get_asgi_application
|   |   â”‚ 
|   |   â”‚ os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'horunap_api.settings')
|   |   â”‚ 
|   |   â”‚ application = get_asgi_application()
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ middleware.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.shortcuts import redirect
|   |   â”‚ from django.urls import reverse
|   |   â”‚ 
|   |   â”‚ class RedireccionAutenticacionMiddleware:
|   |   â”‚     def __init__(self, get_response):
|   |   â”‚         self.get_response = get_response
|   |   â”‚ 
|   |   â”‚     def __call__(self, request):
|   |   â”‚         response = self.get_response(request)
|   |   â”‚ 
|   |   â”‚         # Si el usuario estÃ¡ autenticado y accede a /users/, redirigir segÃºn rol
|   |   â”‚         if request.user.is_authenticated and request.path == '/users/':
|   |   â”‚             if request.user.is_superuser or request.user.rol == 'ADMIN':
|   |   â”‚                 return redirect('admin:index')
|   |   â”‚             elif request.user.rol == 'DOCENTE':
|   |   â”‚                 return redirect('dashboard_docente')
|   |   â”‚ 
|   |   â”‚         return response
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ settings.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ ï»¿"""
|   |   â”‚ Django settings for horunap_api project.
|   |   â”‚ """
|   |   â”‚ 
|   |   â”‚ from pathlib import Path
|   |   â”‚ import os
|   |   â”‚ 
|   |   â”‚ # Build paths inside the project like this: BASE_DIR / 'subdir'.
|   |   â”‚ BASE_DIR = Path(__file__).resolve().parent.parent
|   |   â”‚ 
|   |   â”‚ 
|   |   â”‚ # Quick-start development settings - unsuitable for production
|   |   â”‚ # See https://docs.djangoproject.com/en/5.2/howto/deployment/checklist/
|   |   â”‚ 
|   |   â”‚ # SECURITY WARNING: keep the secret key used in production secret!
|   |   â”‚ SECRET_KEY = 'django-insecure-%ava0+yal+003l5u#byx4n$fi)k)^wf7vmlmdur*9db3e10=c)'
|   |   â”‚ 
|   |   â”‚ # SECURITY WARNING: don't run with debug turned on in production!
|   |   â”‚ DEBUG = True
|   |   â”‚ 
|   |   â”‚ ALLOWED_HOSTS = []
|   |   â”‚ 
|   |   â”‚ 
|   |   â”‚ # --- CONFIGURACIÃ“N CRÃTICA: User personalizado ---
|   |   â”‚ AUTH_USER_MODEL = 'users.User'
|   |   â”‚ 
|   |   â”‚ 
|   |   â”‚ # --- Application definition ---
|   |   â”‚ 
|   |   â”‚ INSTALLED_APPS = [
|   |   â”‚     'django.contrib.admin',
|   |   â”‚     'django.contrib.auth',
|   |   â”‚     'django.contrib.contenttypes',
|   |   â”‚     'django.contrib.sessions', # Necesario para las sesiones
|   |   â”‚     'django.contrib.messages',
|   |   â”‚     'django.contrib.staticfiles',
|   |   â”‚ 
|   |   â”‚     # --- Apps de terceros (API y CORS) ---
|   |   â”‚     'rest_framework',
|   |   â”‚     'corsheaders',
|   |   â”‚ 
|   |   â”‚     # --- Apps Locales ---
|   |   â”‚     'users',
|   |   â”‚     'academic',
|   |   â”‚     'schedule',
|   |   â”‚ ]
|   |   â”‚ 
|   |   â”‚ MIDDLEWARE = [
|   |   â”‚     'django.middleware.security.SecurityMiddleware',
|   |   â”‚     'django.contrib.sessions.middleware.SessionMiddleware', # Necesario para las sesiones
|   |   â”‚     'corsheaders.middleware.CorsMiddleware', # Debe ir antes de CommonMiddleware
|   |   â”‚     'django.middleware.common.CommonMiddleware',
|   |   â”‚     'django.middleware.csrf.CsrfViewMiddleware',
|   |   â”‚     'django.contrib.auth.middleware.AuthenticationMiddleware',
|   |   â”‚     'django.contrib.messages.middleware.MessageMiddleware',
|   |   â”‚     'django.middleware.clickjacking.XFrameOptionsMiddleware',
|   |   â”‚     # 'horunap_api.middleware.RedireccionAutenticacionMiddleware', # Comentado para probar el login
|   |   â”‚ ]
|   |   â”‚ 
|   |   â”‚ ROOT_URLCONF = 'horunap_api.urls'
|   |   â”‚ 
|   |   â”‚ # --- ConfiguraciÃ³n de Templates ---
|   |   â”‚ # (AsegÃºrate de tener solo UNA definiciÃ³n de TEMPLATES)
|   |   â”‚ TEMPLATES = [
|   |   â”‚     {
|   |   â”‚         'BACKEND': 'django.template.backends.django.DjangoTemplates',
|   |   â”‚         'DIRS': [os.path.join(BASE_DIR, 'templates')], # Directorio general de templates
|   |   â”‚         'APP_DIRS': True,
|   |   â”‚         'OPTIONS': {
|   |   â”‚             'context_processors': [
|   |   â”‚                 'django.template.context_processors.debug',
|   |   â”‚                 'django.template.context_processors.request',
|   |   â”‚                 'django.contrib.auth.context_processors.auth',
|   |   â”‚                 'django.contrib.messages.context_processors.messages',
|   |   â”‚             ],
|   |   â”‚         },
|   |   â”‚     },
|   |   â”‚ ]
|   |   â”‚ 
|   |   â”‚ WSGI_APPLICATION = 'horunap_api.wsgi.application'
|   |   â”‚ 
|   |   â”‚ 
|   |   â”‚ # --- Database ---
|   |   â”‚ # https://docs.djangoproject.com/en/5.2/ref/settings/#databases
|   |   â”‚ 
|   |   â”‚ DATABASES = {
|   |   â”‚     'default': {
|   |   â”‚         'ENGINE': 'django.db.backends.sqlite3',
|   |   â”‚         'NAME': BASE_DIR / 'db.sqlite3',
|   |   â”‚     }
|   |   â”‚ }
|   |   â”‚ 
|   |   â”‚ # --- CAMBIAR CÃ“MO SE GUARDAN LAS SESIONES (PRUEBA) ---
|   |   â”‚ SESSION_ENGINE = 'django.contrib.sessions.backends.file'
|   |   â”‚ # SESSION_ENGINE = 'django.contrib.sessions.backends.db' # OpciÃ³n por defecto
|   |   â”‚ 
|   |   â”‚ 
|   |   â”‚ # --- Password validation ---
|   |   â”‚ # https://docs.djangoproject.com/en/5.2/ref/settings/#auth-password-validators
|   |   â”‚ 
|   |   â”‚ AUTH_PASSWORD_VALIDATORS = [
|   |   â”‚     {
|   |   â”‚         'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
|   |   â”‚     },
|   |   â”‚     {
|   |   â”‚         'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
|   |   â”‚     },
|   |   â”‚     {
|   |   â”‚         'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
|   |   â”‚     },
|   |   â”‚     {
|   |   â”‚         'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
|   |   â”‚     },
|   |   â”‚ ]
|   |   â”‚ 
|   |   â”‚ # --- ConfiguraciÃ³n de archivos estÃ¡ticos (CSS, JS, imÃ¡genes) ---
|   |   â”‚ STATIC_URL = 'static/'
|   |   â”‚ STATICFILES_DIRS = [
|   |   â”‚     os.path.join(BASE_DIR, 'static'), # Directorio general de archivos estÃ¡ticos
|   |   â”‚ ]
|   |   â”‚ 
|   |   â”‚ # --- ConfiguraciÃ³n de autenticaciÃ³n y redirecciÃ³n ---
|   |   â”‚ LOGIN_URL = '/login/' # URL de tu vista de login
|   |   â”‚ LOGIN_REDIRECT_URL = '/users/' # URL a la que redirigir DESPUÃ‰S del login (tu vista de redirecciÃ³n por rol)
|   |   â”‚ LOGOUT_REDIRECT_URL = '/login/' # URL a la que redirigir DESPUÃ‰S del logout
|   |   â”‚ 
|   |   â”‚ # --- Internationalization ---
|   |   â”‚ # https://docs.djangoproject.com/en/5.2/topics/i18n/
|   |   â”‚ 
|   |   â”‚ LANGUAGE_CODE = 'es-es' # o 'es-pe'
|   |   â”‚ TIME_ZONE = 'America/Lima'
|   |   â”‚ USE_I18N = True
|   |   â”‚ USE_L10N = True # Para formatos de fecha/nÃºmero locales
|   |   â”‚ USE_TZ = True # Recomendado para manejar zonas horarias
|   |   â”‚ 
|   |   â”‚ DEFAULT_CHARSET = 'utf-8'
|   |   â”‚ 
|   |   â”‚ # --- Default primary key field type ---
|   |   â”‚ # https://docs.djangoproject.com/en/5.2/ref/settings/#default-auto-field
|   |   â”‚ 
|   |   â”‚ DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'
|   |   â”‚ 
|   |   â”‚ # --- ConfiguraciÃ³n de CORS ---
|   |   â”‚ # OrÃ­genes (dominios) que tienen permiso para hacer peticiones a esta API
|   |   â”‚ CORS_ALLOWED_ORIGINS = [
|   |   â”‚     'http://localhost:3000',  # Puerto estÃ¡ndar de React en desarrollo
|   |   â”‚     'http://127.0.0.1:3000',
|   |   â”‚ ]
|   |   â”‚ # Si necesitas permitir credenciales (cookies, etc.) desde React (Ãºtil para login con sesiones)
|   |   â”‚ # CORS_ALLOW_CREDENTIALS = True
|   |   â”‚ 
|   |   â”‚ # Opcional: Para desarrollo, puedes permitir todos los orÃ­genes (NO USAR EN PRODUCCIÃ“N)
|   |   â”‚ # CORS_ALLOW_ALL_ORIGINS = True
|   |   â”‚ 
|   |   â”‚ AUTHENTICATION_BACKENDS = ['users.backends.DebugModelBackend']
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ urls.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.contrib import admin
|   |   â”‚ from django.urls import path, include
|   |   â”‚ from django.views.generic import RedirectView
|   |   â”‚ from django.contrib.auth import views as auth_views
|   |   â”‚ 
|   |   â”‚ urlpatterns = [
|   |   â”‚     path('admin/', admin.site.urls),
|   |   â”‚     path('users/', include('users.urls')),
|   |   â”‚ 
|   |   â”‚     # Login
|   |   â”‚     path('login/', auth_views.LoginView.as_view(
|   |   â”‚         template_name='registration/login.html'
|   |   â”‚     ), name='login'),
|   |   â”‚ 
|   |   â”‚     # Logout - AGREGAR ESTA LÃNEA
|   |   â”‚     path('logout/', auth_views.LogoutView.as_view(
|   |   â”‚         template_name='registration/logged_out.html'
|   |   â”‚     ), name='logout'),
|   |   â”‚ 
|   |   â”‚     path('', RedirectView.as_view(url='/login/')),
|   |   â”‚ ]
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   `-- ğŸ“„ wsgi.py
|       â”Œâ”€ CONTENIDO â”€â”
|       â”‚ """
|       â”‚ WSGI config for horunap_api project.
|       â”‚ 
|       â”‚ It exposes the WSGI callable as a module-level variable named ``application``.
|       â”‚ 
|       â”‚ For more information on this file, see
|       â”‚ https://docs.djangoproject.com/en/5.2/howto/deployment/wsgi/
|       â”‚ """
|       â”‚ 
|       â”‚ import os
|       â”‚ 
|       â”‚ from django.core.wsgi import get_wsgi_application
|       â”‚ 
|       â”‚ os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'horunap_api.settings')
|       â”‚ 
|       â”‚ application = get_wsgi_application()
|       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|-- ğŸ“„ listar_poco.py
|   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ import os
|   â”‚ import sys
|   â”‚ 
|   â”‚ def generar_arbol_con_contenido(ruta_raiz, archivo_salida):
|   â”‚     """
|   â”‚     Genera una representaciÃ³n en Ã¡rbol de la estructura del proyecto,
|   â”‚     mostrando el contenido de cada archivo y guardÃ¡ndolo en el archivo_salida.
|   â”‚     """
|   â”‚     ignorar = {
|   â”‚         '__pycache__', '.git', '.vscode', '.idea',
|   â”‚         'venv', 'env', '.venv', 'Lib', 'Scripts', 'include', 'lib',
|   â”‚         'node_modules',
|   â”‚         'db.sqlite3',
|   â”‚         'listar_archivos.py', # Puedes poner el nombre de este script aquÃ­
|   â”‚         'estructura_proyecto.txt' # Ignorar el propio archivo de salida
|   â”‚     }
|   â”‚ 
|   â”‚     # Escribe el nombre de la carpeta raÃ­z en el archivo
|   â”‚     print(f"ğŸ“ {os.path.basename(os.path.abspath(ruta_raiz))}/", file=archivo_salida)
|   â”‚     _recorrer_directorio(ruta_raiz, prefix="", ignorar=ignorar, archivo_salida=archivo_salida)
|   â”‚ 
|   â”‚ def _recorrer_directorio(directorio, prefix, ignorar, archivo_salida):
|   â”‚     """
|   â”‚     FunciÃ³n auxiliar recursiva para recorrer directorios y escribir
|   â”‚     el contenido de los archivos en el archivo_salida.
|   â”‚     """
|   â”‚     try:
|   â”‚         elementos = sorted([e for e in os.listdir(directorio) if e not in ignorar])
|   â”‚     except FileNotFoundError:
|   â”‚         return
|   â”‚ 
|   â”‚     punteros = ['|-- '] * (len(elementos) - 1) + ['`-- ']
|   â”‚ 
|   â”‚     for puntero, nombre_elemento in zip(punteros, elementos):
|   â”‚         ruta_completa = os.path.join(directorio, nombre_elemento)
|   â”‚ 
|   â”‚         # Se usa 'end=""' para que print no agregue un salto de lÃ­nea extra
|   â”‚         print(f"{prefix}{puntero}", end="", file=archivo_salida)
|   â”‚ 
|   â”‚         if os.path.isdir(ruta_completa):
|   â”‚             print(f"ğŸ“ {nombre_elemento}/", file=archivo_salida)
|   â”‚             extension = '|   ' if puntero == '|-- ' else '    '
|   â”‚             _recorrer_directorio(ruta_completa, prefix=prefix + extension, ignorar=ignorar, archivo_salida=archivo_salida)
|   â”‚         else:
|   â”‚             print(f"ğŸ“„ {nombre_elemento}", file=archivo_salida)
|   â”‚ 
|   â”‚             content_prefix = prefix + ('|   ' if puntero == '|-- ' else '    ')
|   â”‚ 
|   â”‚             try:
|   â”‚                 with open(ruta_completa, 'r', encoding='utf-8') as archivo_a_leer:
|   â”‚                     lineas = archivo_a_leer.readlines()
|   â”‚                     if not lineas:
|   â”‚                         print(f"{content_prefix}  (Archivo vacÃ­o)", file=archivo_salida)
|   â”‚                     else:
|   â”‚                         print(f"{content_prefix}â”Œâ”€ CONTENIDO â”€â”", file=archivo_salida)
|   â”‚                         for linea in lineas:
|   â”‚                             print(f"{content_prefix}â”‚ {linea.rstrip()}", file=archivo_salida)
|   â”‚                         print(f"{content_prefix}â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜", file=archivo_salida)
|   â”‚             except Exception:
|   â”‚                 print(f"{content_prefix}  (No se pudo leer el contenido, puede ser un archivo binario)", file=archivo_salida)
|   â”‚ 
|   â”‚ if __name__ == '__main__':
|   â”‚     directorio_del_proyecto = '.'
|   â”‚     nombre_archivo_salida = 'estructura_completa_proyecto.txt'
|   â”‚ 
|   â”‚     print(f"Generando la estructura del proyecto en el archivo '{nombre_archivo_salida}'...")
|   â”‚ 
|   â”‚     # Abrimos el archivo de texto en modo escritura ('w')
|   â”‚     with open(nombre_archivo_salida, 'w', encoding='utf-8') as f:
|   â”‚         # Pasamos el objeto de archivo 'f' a la funciÃ³n principal
|   â”‚         generar_arbol_con_contenido(directorio_del_proyecto, archivo_salida=f)
|   â”‚ 
|   â”‚     print("Â¡Archivo generado con Ã©xito!")
|   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|-- ğŸ“„ manage.py
|   â”Œâ”€ CONTENIDO â”€â”
|   â”‚ #!/usr/bin/env python
|   â”‚ """Django's command-line utility for administrative tasks."""
|   â”‚ import os
|   â”‚ import sys
|   â”‚ 
|   â”‚ 
|   â”‚ def main():
|   â”‚     """Run administrative tasks."""
|   â”‚     os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'horunap_api.settings')
|   â”‚     try:
|   â”‚         from django.core.management import execute_from_command_line
|   â”‚     except ImportError as exc:
|   â”‚         raise ImportError(
|   â”‚             "Couldn't import Django. Are you sure it's installed and "
|   â”‚             "available on your PYTHONPATH environment variable? Did you "
|   â”‚             "forget to activate a virtual environment?"
|   â”‚         ) from exc
|   â”‚     execute_from_command_line(sys.argv)
|   â”‚ 
|   â”‚ 
|   â”‚ if __name__ == '__main__':
|   â”‚     main()
|   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|-- ğŸ“ schedule/
|   |-- ğŸ“„ __init__.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ # schedule/__init__.py
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ admin.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.contrib import admin
|   |   â”‚ from .models import Horario, Asignacion, ConflictoHorario, DisponibilidadDocente
|   |   â”‚ 
|   |   â”‚ @admin.register(Horario)
|   |   â”‚ class HorarioAdmin(admin.ModelAdmin):
|   |   â”‚     list_display = ['nombre', 'semestre', 'estado', 'fecha_creacion', 'creado_por']
|   |   â”‚     list_filter = ['estado', 'semestre']
|   |   â”‚     search_fields = ['nombre', 'semestre']
|   |   â”‚     readonly_fields = ['fecha_creacion', 'fecha_actualizacion']
|   |   â”‚ 
|   |   â”‚ @admin.register(Asignacion)
|   |   â”‚ class AsignacionAdmin(admin.ModelAdmin):
|   |   â”‚     list_display = ['curso', 'docente', 'aula', 'dia_semana', 'bloque_horario', 'activa']
|   |   â”‚     list_filter = ['dia_semana', 'bloque_horario', 'activa', 'horario']
|   |   â”‚     search_fields = ['curso__nombre', 'docente__username', 'aula__nombre']
|   |   â”‚ 
|   |   â”‚ @admin.register(ConflictoHorario)
|   |   â”‚ class ConflictoHorarioAdmin(admin.ModelAdmin):
|   |   â”‚     list_display = ['tipo_conflicto', 'asignacion', 'fecha_deteccion', 'resuelto']
|   |   â”‚     list_filter = ['tipo_conflicto', 'resuelto', 'horario']
|   |   â”‚     search_fields = ['asignacion__curso__nombre', 'descripcion']
|   |   â”‚     readonly_fields = ['fecha_deteccion']
|   |   â”‚ 
|   |   â”‚ @admin.register(DisponibilidadDocente)
|   |   â”‚ class DisponibilidadDocenteAdmin(admin.ModelAdmin):
|   |   â”‚     list_display = ['docente', 'dia_semana', 'bloque_horario', 'disponible', 'fecha_actualizacion']
|   |   â”‚     list_filter = ['dia_semana', 'bloque_horario', 'disponible', 'docente']
|   |   â”‚     search_fields = ['docente__username', 'docente__first_name', 'docente__last_name']
|   |   â”‚     readonly_fields = ['fecha_actualizacion']
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ apps.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.apps import AppConfig
|   |   â”‚ 
|   |   â”‚ class ScheduleConfig(AppConfig):
|   |   â”‚     default_auto_field = 'django.db.models.BigAutoField'
|   |   â”‚     name = 'schedule'
|   |   â”‚     verbose_name = 'Generador de Horarios'
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“ core/
|   |   `-- ğŸ“„ algorithm.py
|   |       â”Œâ”€ CONTENIDO â”€â”
|   |       â”‚ # schedule/core/algorithm.py
|   |       â”‚ import random
|   |       â”‚ from datetime import datetime
|   |       â”‚ from django.db.models import Q
|   |       â”‚ from academic.models import Curso, Aula
|   |       â”‚ from users.models import User
|   |       â”‚ from ..models import Horario, Asignacion, ConflictoHorario, DisponibilidadDocente
|   |       â”‚ 
|   |       â”‚ class GeneradorHorarios:
|   |       â”‚     """
|   |       â”‚     Motor inteligente para la generaciÃ³n automÃ¡tica de horarios
|   |       â”‚     """
|   |       â”‚ 
|   |       â”‚     def __init__(self, horario_id):
|   |       â”‚         self.horario = Horario.objects.get(id=horario_id)
|   |       â”‚         self.conflictos = []
|   |       â”‚ 
|   |       â”‚     def generar_horario(self):
|   |       â”‚         """
|   |       â”‚         Genera un horario completo basado en restricciones y disponibilidades
|   |       â”‚         """
|   |       â”‚         print(f"Iniciando generaciÃ³n de horario: {self.horario.nombre}")
|   |       â”‚ 
|   |       â”‚         # Limpiar asignaciones previas
|   |       â”‚         Asignacion.objects.filter(horario=self.horario).delete()
|   |       â”‚         ConflictoHorario.objects.filter(horario=self.horario).delete()
|   |       â”‚ 
|   |       â”‚         # Obtener datos necesarios
|   |       â”‚         cursos = Curso.objects.filter(activo=True)
|   |       â”‚         aulas = Aula.objects.filter(activa=True)
|   |       â”‚         docentes = User.objects.filter(rol='DOCENTE', is_active=True)
|   |       â”‚ 
|   |       â”‚         # ParÃ¡metros de configuraciÃ³n
|   |       â”‚         dias_semana = ['LUNES', 'MARTES', 'MIERCOLES', 'JUEVES', 'VIERNES']
|   |       â”‚         bloques_horarios = ['08:00-10:00', '10:00-12:00', '14:00-16:00', '16:00-18:00']
|   |       â”‚ 
|   |       â”‚         asignaciones_generadas = 0
|   |       â”‚         max_intentos = 1000
|   |       â”‚ 
|   |       â”‚         for curso in cursos:
|   |       â”‚             for sesion in range(curso.sesiones_semana):
|   |       â”‚                 intentos = 0
|   |       â”‚                 asignado = False
|   |       â”‚ 
|   |       â”‚                 while not asignado and intentos < max_intentos:
|   |       â”‚                     # Seleccionar aleatoriamente dÃ­a y bloque
|   |       â”‚                     dia = random.choice(dias_semana)
|   |       â”‚                     bloque = random.choice(bloques_horarios)
|   |       â”‚ 
|   |       â”‚                     # Seleccionar docente disponible (MEJORADO)
|   |       â”‚                     docente = self._seleccionar_docente_disponible(docentes, dia, bloque, curso)
|   |       â”‚ 
|   |       â”‚                     # Seleccionar aula disponible
|   |       â”‚                     aula = self._seleccionar_aula_disponible(aulas, dia, bloque, curso)
|   |       â”‚ 
|   |       â”‚                     if docente and aula:
|   |       â”‚                         # Verificar si no hay conflictos
|   |       â”‚                         if not self._tiene_conflictos(curso, docente, aula, dia, bloque):
|   |       â”‚                             # Crear asignaciÃ³n
|   |       â”‚                             asignacion = Asignacion.objects.create(
|   |       â”‚                                 horario=self.horario,
|   |       â”‚                                 curso=curso,
|   |       â”‚                                 docente=docente,
|   |       â”‚                                 aula=aula,
|   |       â”‚                                 dia_semana=dia,
|   |       â”‚                                 bloque_horario=bloque
|   |       â”‚                             )
|   |       â”‚                             asignaciones_generadas += 1
|   |       â”‚                             asignado = True
|   |       â”‚                             print(f"AsignaciÃ³n creada: {curso.codigo} - {dia} {bloque}")
|   |       â”‚ 
|   |       â”‚                     intentos += 1
|   |       â”‚ 
|   |       â”‚                 if not asignado:
|   |       â”‚                     print(f"âš ï¸ No se pudo asignar sesiÃ³n {sesion + 1} del curso {curso.codigo}")
|   |       â”‚ 
|   |       â”‚         # Actualizar estado del horario
|   |       â”‚         self.horario.estado = 'GENERADO'
|   |       â”‚         self.horario.save()
|   |       â”‚ 
|   |       â”‚         print(f"âœ… GeneraciÃ³n completada. {asignaciones_generadas} asignaciones creadas.")
|   |       â”‚         return asignaciones_generadas
|   |       â”‚ 
|   |       â”‚     def _seleccionar_docente_disponible(self, docentes, dia, bloque, curso):
|   |       â”‚         """
|   |       â”‚         MEJORADO: Selecciona un docente disponible considerando disponibilidad registrada
|   |       â”‚         """
|   |       â”‚         docentes_disponibles = []
|   |       â”‚         for docente in docentes:
|   |       â”‚             # Verificar disponibilidad registrada (NUEVA LÃ“GICA)
|   |       â”‚             if self._docente_tiene_disponibilidad(docente, dia, bloque):
|   |       â”‚                 if not self._docente_ocupado(docente, dia, bloque):
|   |       â”‚                     docentes_disponibles.append(docente)
|   |       â”‚ 
|   |       â”‚         return random.choice(docentes_disponibles) if docentes_disponibles else None
|   |       â”‚ 
|   |       â”‚     def _docente_tiene_disponibilidad(self, docente, dia, bloque):
|   |       â”‚         """
|   |       â”‚         NUEVO MÃ‰TODO: Verifica si el docente tiene disponibilidad registrada
|   |       â”‚         """
|   |       â”‚         try:
|   |       â”‚             disponibilidad = DisponibilidadDocente.objects.get(
|   |       â”‚                 docente=docente,
|   |       â”‚                 dia_semana=dia,
|   |       â”‚                 bloque_horario=bloque
|   |       â”‚             )
|   |       â”‚             return disponibilidad.disponible
|   |       â”‚         except DisponibilidadDocente.DoesNotExist:
|   |       â”‚             # Si no tiene disponibilidad registrada, asumir no disponible
|   |       â”‚             return False
|   |       â”‚ 
|   |       â”‚     def _seleccionar_aula_disponible(self, aulas, dia, bloque, curso):
|   |       â”‚         """
|   |       â”‚         MEJORADO: Selecciona un aula disponible que cumpla con los requisitos del curso
|   |       â”‚         """
|   |       â”‚         aulas_disponibles = []
|   |       â”‚         for aula in aulas:
|   |       â”‚             if (aula.capacidad >= curso.capacidad_estimada and
|   |       â”‚                 not self._aula_ocupada(aula, dia, bloque) and
|   |       â”‚                 self._aula_cumple_requisitos(aula, curso)):
|   |       â”‚                 aulas_disponibles.append(aula)
|   |       â”‚ 
|   |       â”‚         # Priorizar aulas con capacidad similar a la requerida
|   |       â”‚         if aulas_disponibles:
|   |       â”‚             aulas_disponibles.sort(key=lambda a: abs(a.capacidad - curso.capacidad_estimada))
|   |       â”‚             return aulas_disponibles[0]
|   |       â”‚ 
|   |       â”‚         return None
|   |       â”‚ 
|   |       â”‚     def _aula_cumple_requisitos(self, aula, curso):
|   |       â”‚         """
|   |       â”‚         NUEVO MÃ‰TODO: Verifica si el aula cumple con los requisitos del curso
|   |       â”‚         """
|   |       â”‚         # Verificar requisito de laboratorio
|   |       â”‚         if curso.requiere_laboratorio and aula.tipo_aula != 'LABORATORIO':
|   |       â”‚             return False
|   |       â”‚ 
|   |       â”‚         # Verificar equipamiento adicional si es necesario
|   |       â”‚         if curso.requiere_laboratorio and not aula.tiene_proyector:
|   |       â”‚             return False
|   |       â”‚ 
|   |       â”‚         return True
|   |       â”‚ 
|   |       â”‚     def _docente_ocupado(self, docente, dia, bloque):
|   |       â”‚         """
|   |       â”‚         Verifica si el docente ya tiene una asignaciÃ³n en el mismo dÃ­a y bloque
|   |       â”‚         """
|   |       â”‚         return Asignacion.objects.filter(
|   |       â”‚             horario=self.horario,
|   |       â”‚             docente=docente,
|   |       â”‚             dia_semana=dia,
|   |       â”‚             bloque_horario=bloque
|   |       â”‚         ).exists()
|   |       â”‚ 
|   |       â”‚     def _aula_ocupada(self, aula, dia, bloque):
|   |       â”‚         """
|   |       â”‚         Verifica si el aula ya estÃ¡ ocupada en el mismo dÃ­a y bloque
|   |       â”‚         """
|   |       â”‚         return Asignacion.objects.filter(
|   |       â”‚             horario=self.horario,
|   |       â”‚             aula=aula,
|   |       â”‚             dia_semana=dia,
|   |       â”‚             bloque_horario=bloque
|   |       â”‚         ).exists()
|   |       â”‚ 
|   |       â”‚     def _tiene_conflictos(self, curso, docente, aula, dia, bloque):
|   |       â”‚         """
|   |       â”‚         MEJORADO: Verifica si existe algÃºn conflicto con la asignaciÃ³n propuesta
|   |       â”‚         """
|   |       â”‚         # Verificar conflicto de docente
|   |       â”‚         if self._docente_ocupado(docente, dia, bloque):
|   |       â”‚             return True
|   |       â”‚ 
|   |       â”‚         # Verificar conflicto de aula
|   |       â”‚         if self._aula_ocupada(aula, dia, bloque):
|   |       â”‚             return True
|   |       â”‚ 
|   |       â”‚         # Verificar capacidad del aula
|   |       â”‚         if aula.capacidad < curso.capacidad_estimada:
|   |       â”‚             return True
|   |       â”‚ 
|   |       â”‚         # Verificar requisitos de equipamiento (NUEVA VALIDACIÃ“N)
|   |       â”‚         if not self._aula_cumple_requisitos(aula, curso):
|   |       â”‚             return True
|   |       â”‚ 
|   |       â”‚         return False
|   |       â”‚ 
|   |       â”‚     def detectar_conflictos(self):
|   |       â”‚         """
|   |       â”‚         MEJORADO: Detecta y registra conflictos en el horario generado
|   |       â”‚         """
|   |       â”‚         print("ğŸ” Detectando conflictos...")
|   |       â”‚ 
|   |       â”‚         asignaciones = Asignacion.objects.filter(horario=self.horario)
|   |       â”‚ 
|   |       â”‚         for asignacion in asignaciones:
|   |       â”‚             # Verificar conflictos de capacidad
|   |       â”‚             if asignacion.aula.capacidad < asignacion.curso.capacidad_estimada:
|   |       â”‚                 self._registrar_conflicto(
|   |       â”‚                     asignacion,
|   |       â”‚                     'CAPACIDAD',
|   |       â”‚                     f"El aula {asignacion.aula.nombre} tiene capacidad {asignacion.aula.capacidad} "
|   |       â”‚                     f"pero el curso requiere {asignacion.curso.capacidad_estimada} estudiantes"
|   |       â”‚                 )
|   |       â”‚ 
|   |       â”‚             # Verificar conflictos de equipamiento (NUEVA DETECCIÃ“N)
|   |       â”‚             if asignacion.curso.requiere_laboratorio and asignacion.aula.tipo_aula != 'LABORATORIO':
|   |       â”‚                 self._registrar_conflicto(
|   |       â”‚                     asignacion,
|   |       â”‚                     'EQUIPAMIENTO',
|   |       â”‚                     f"El curso {asignacion.curso.codigo} requiere laboratorio "
|   |       â”‚                     f"pero el aula {asignacion.aula.nombre} no es un laboratorio"
|   |       â”‚                 )
|   |       â”‚ 
|   |       â”‚         print(f"âœ… DetecciÃ³n de conflictos completada. {len(self.conflictos)} conflictos encontrados.")
|   |       â”‚ 
|   |       â”‚     def _registrar_conflicto(self, asignacion, tipo, descripcion):
|   |       â”‚         """
|   |       â”‚         Registra un conflicto en la base de datos
|   |       â”‚         """
|   |       â”‚         conflicto = ConflictoHorario.objects.create(
|   |       â”‚             horario=self.horario,
|   |       â”‚             asignacion=asignacion,
|   |       â”‚             tipo_conflicto=tipo,
|   |       â”‚             descripcion=descripcion
|   |       â”‚         )
|   |       â”‚         self.conflictos.append(conflicto)
|   |       â”‚ 
|   |       â”‚ class ResolvedorConflictos:
|   |       â”‚     """
|   |       â”‚     MÃ³dulo para la resoluciÃ³n automÃ¡tica de conflictos
|   |       â”‚     """
|   |       â”‚ 
|   |       â”‚     def __init__(self, horario_id):
|   |       â”‚         self.horario = Horario.objects.get(id=horario_id)
|   |       â”‚ 
|   |       â”‚     def resolver_conflictos(self):
|   |       â”‚         """
|   |       â”‚         Intenta resolver automÃ¡ticamente los conflictos detectados
|   |       â”‚         """
|   |       â”‚         conflictos = ConflictoHorario.objects.filter(
|   |       â”‚             horario=self.horario,
|   |       â”‚             resuelto=False
|   |       â”‚         )
|   |       â”‚ 
|   |       â”‚         for conflicto in conflictos:
|   |       â”‚             if self._resolver_conflicto(conflicto):
|   |       â”‚                 conflicto.resuelto = True
|   |       â”‚                 conflicto.fecha_resolucion = datetime.now()
|   |       â”‚                 conflicto.save()
|   |       â”‚ 
|   |       â”‚         return conflictos.filter(resuelto=True).count()
|   |       â”‚ 
|   |       â”‚     def _resolver_conflicto(self, conflicto):
|   |       â”‚         """
|   |       â”‚         Intenta resolver un conflicto especÃ­fico
|   |       â”‚         """
|   |       â”‚         if conflicto.tipo_conflicto == 'CAPACIDAD':
|   |       â”‚             return self._resolver_conflicto_capacidad(conflicto)
|   |       â”‚         elif conflicto.tipo_conflicto == 'EQUIPAMIENTO':
|   |       â”‚             return self._resolver_conflicto_equipamiento(conflicto)
|   |       â”‚ 
|   |       â”‚         return False
|   |       â”‚ 
|   |       â”‚     def _resolver_conflicto_capacidad(self, conflicto):
|   |       â”‚         """
|   |       â”‚         Resuelve conflictos de capacidad buscando un aula mÃ¡s grande
|   |       â”‚         """
|   |       â”‚         asignacion = conflicto.asignacion
|   |       â”‚         aulas_disponibles = Aula.objects.filter(
|   |       â”‚             activa=True,
|   |       â”‚             capacidad__gte=asignacion.curso.capacidad_estimada,
|   |       â”‚             tipo_aula=asignacion.aula.tipo_aula  # Mantener mismo tipo de aula
|   |       â”‚         ).exclude(id=asignacion.aula.id)
|   |       â”‚ 
|   |       â”‚         for aula in aulas_disponibles:
|   |       â”‚             if not self._aula_ocupada_en_horario(aula, asignacion.dia_semana, asignacion.bloque_horario):
|   |       â”‚                 # Reasignar el aula
|   |       â”‚                 asignacion.aula = aula
|   |       â”‚                 asignacion.save()
|   |       â”‚                 return True
|   |       â”‚ 
|   |       â”‚         return False
|   |       â”‚ 
|   |       â”‚     def _resolver_conflicto_equipamiento(self, conflicto):
|   |       â”‚         """
|   |       â”‚         NUEVO MÃ‰TODO: Resuelve conflictos de equipamiento
|   |       â”‚         """
|   |       â”‚         asignacion = conflicto.asignacion
|   |       â”‚         aulas_disponibles = Aula.objects.filter(
|   |       â”‚             activa=True,
|   |       â”‚             tipo_aula='LABORATORIO',
|   |       â”‚             capacidad__gte=asignacion.curso.capacidad_estimada
|   |       â”‚         ).exclude(id=asignacion.aula.id)
|   |       â”‚ 
|   |       â”‚         for aula in aulas_disponibles:
|   |       â”‚             if not self._aula_ocupada_en_horario(aula, asignacion.dia_semana, asignacion.bloque_horario):
|   |       â”‚                 # Reasignar el aula
|   |       â”‚                 asignacion.aula = aula
|   |       â”‚                 asignacion.save()
|   |       â”‚                 return True
|   |       â”‚ 
|   |       â”‚         return False
|   |       â”‚ 
|   |       â”‚     def _aula_ocupada_en_horario(self, aula, dia, bloque):
|   |       â”‚         """
|   |       â”‚         Verifica si un aula estÃ¡ ocupada en un horario especÃ­fico
|   |       â”‚         """
|   |       â”‚         return Asignacion.objects.filter(
|   |       â”‚             horario=self.horario,
|   |       â”‚             aula=aula,
|   |       â”‚             dia_semana=dia,
|   |       â”‚             bloque_horario=bloque
|   |       â”‚         ).exists()
|   |       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“ migrations/
|   |   |-- ğŸ“„ 0001_initial.py
|   |   |   â”Œâ”€ CONTENIDO â”€â”
|   |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-12 17:47
|   |   |   â”‚ 
|   |   |   â”‚ import django.db.models.deletion
|   |   |   â”‚ from django.conf import settings
|   |   |   â”‚ from django.db import migrations, models
|   |   |   â”‚ 
|   |   |   â”‚ 
|   |   |   â”‚ class Migration(migrations.Migration):
|   |   |   â”‚ 
|   |   |   â”‚     initial = True
|   |   |   â”‚ 
|   |   |   â”‚     dependencies = [
|   |   |   â”‚         ('academic', '0001_initial'),
|   |   |   â”‚         migrations.swappable_dependency(settings.AUTH_USER_MODEL),
|   |   |   â”‚     ]
|   |   |   â”‚ 
|   |   |   â”‚     operations = [
|   |   |   â”‚         migrations.CreateModel(
|   |   |   â”‚             name='Asignacion',
|   |   |   â”‚             fields=[
|   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   |   |   â”‚                 ('dia_semana', models.CharField(choices=[('LUNES', 'Lunes'), ('MARTES', 'Martes'), ('MIERCOLES', 'MiÃ©rcoles'), ('JUEVES', 'Jueves'), ('VIERNES', 'Viernes'), ('SABADO', 'SÃ¡bado')], max_length=20, verbose_name='DÃ­a de la Semana')),
|   |   |   â”‚                 ('bloque_horario', models.CharField(choices=[('08:00-10:00', '08:00 - 10:00'), ('10:00-12:00', '10:00 - 12:00'), ('12:00-14:00', '12:00 - 14:00'), ('14:00-16:00', '14:00 - 16:00'), ('16:00-18:00', '16:00 - 18:00'), ('18:00-20:00', '18:00 - 20:00')], max_length=20, verbose_name='Bloque Horario')),
|   |   |   â”‚                 ('fecha_asignacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de AsignaciÃ³n')),
|   |   |   â”‚                 ('activa', models.BooleanField(default=True, verbose_name='AsignaciÃ³n Activa')),
|   |   |   â”‚                 ('aula', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='academic.aula', verbose_name='Aula')),
|   |   |   â”‚                 ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='academic.curso', verbose_name='Curso')),
|   |   |   â”‚                 ('docente', models.ForeignKey(limit_choices_to={'rol': 'DOCENTE'}, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Docente')),
|   |   |   â”‚             ],
|   |   |   â”‚             options={
|   |   |   â”‚                 'verbose_name': 'AsignaciÃ³n',
|   |   |   â”‚                 'verbose_name_plural': 'Asignaciones',
|   |   |   â”‚                 'ordering': ['dia_semana', 'bloque_horario'],
|   |   |   â”‚             },
|   |   |   â”‚         ),
|   |   |   â”‚         migrations.CreateModel(
|   |   |   â”‚             name='Horario',
|   |   |   â”‚             fields=[
|   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   |   |   â”‚                 ('nombre', models.CharField(max_length=100, verbose_name='Nombre del Horario')),
|   |   |   â”‚                 ('semestre', models.CharField(max_length=20, verbose_name='Semestre AcadÃ©mico')),
|   |   |   â”‚                 ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de CreaciÃ³n')),
|   |   |   â”‚                 ('fecha_actualizacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de ActualizaciÃ³n')),
|   |   |   â”‚                 ('estado', models.CharField(choices=[('BORRADOR', 'Borrador'), ('GENERADO', 'Generado'), ('APROBADO', 'Aprobado'), ('ACTIVO', 'Activo'), ('INACTIVO', 'Inactivo')], default='BORRADOR', max_length=20)),
|   |   |   â”‚                 ('creado_por', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),
|   |   |   â”‚             ],
|   |   |   â”‚             options={
|   |   |   â”‚                 'verbose_name': 'Horario',
|   |   |   â”‚                 'verbose_name_plural': 'Horarios',
|   |   |   â”‚                 'ordering': ['-fecha_creacion'],
|   |   |   â”‚             },
|   |   |   â”‚         ),
|   |   |   â”‚         migrations.CreateModel(
|   |   |   â”‚             name='ConflictoHorario',
|   |   |   â”‚             fields=[
|   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   |   |   â”‚                 ('tipo_conflicto', models.CharField(choices=[('DOCENTE', 'Conflicto de Docente'), ('AULA', 'Conflicto de Aula'), ('CURSO', 'Conflicto de Curso'), ('CAPACIDAD', 'Conflicto de Capacidad')], max_length=20, verbose_name='Tipo de Conflicto')),
|   |   |   â”‚                 ('descripcion', models.TextField(verbose_name='DescripciÃ³n del Conflicto')),
|   |   |   â”‚                 ('fecha_deteccion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de DetecciÃ³n')),
|   |   |   â”‚                 ('resuelto', models.BooleanField(default=False, verbose_name='Conflicto Resuelto')),
|   |   |   â”‚                 ('fecha_resolucion', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de ResoluciÃ³n')),
|   |   |   â”‚                 ('asignacion', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='schedule.asignacion', verbose_name='AsignaciÃ³n Conflictiva')),
|   |   |   â”‚                 ('horario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='conflictos', to='schedule.horario')),
|   |   |   â”‚             ],
|   |   |   â”‚             options={
|   |   |   â”‚                 'verbose_name': 'Conflicto de Horario',
|   |   |   â”‚                 'verbose_name_plural': 'Conflictos de Horario',
|   |   |   â”‚                 'ordering': ['-fecha_deteccion'],
|   |   |   â”‚             },
|   |   |   â”‚         ),
|   |   |   â”‚         migrations.AddField(
|   |   |   â”‚             model_name='asignacion',
|   |   |   â”‚             name='horario',
|   |   |   â”‚             field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='asignaciones', to='schedule.horario'),
|   |   |   â”‚         ),
|   |   |   â”‚         migrations.AlterUniqueTogether(
|   |   |   â”‚             name='asignacion',
|   |   |   â”‚             unique_together={('horario', 'aula', 'dia_semana', 'bloque_horario'), ('horario', 'curso', 'dia_semana', 'bloque_horario'), ('horario', 'docente', 'dia_semana', 'bloque_horario')},
|   |   |   â”‚         ),
|   |   |   â”‚     ]
|   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |   |-- ğŸ“„ 0002_alter_conflictohorario_tipo_conflicto_and_more.py
|   |   |   â”Œâ”€ CONTENIDO â”€â”
|   |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-13 02:54
|   |   |   â”‚ 
|   |   |   â”‚ import django.db.models.deletion
|   |   |   â”‚ from django.conf import settings
|   |   |   â”‚ from django.db import migrations, models
|   |   |   â”‚ 
|   |   |   â”‚ 
|   |   |   â”‚ class Migration(migrations.Migration):
|   |   |   â”‚ 
|   |   |   â”‚     dependencies = [
|   |   |   â”‚         ('schedule', '0001_initial'),
|   |   |   â”‚         migrations.swappable_dependency(settings.AUTH_USER_MODEL),
|   |   |   â”‚     ]
|   |   |   â”‚ 
|   |   |   â”‚     operations = [
|   |   |   â”‚         migrations.AlterField(
|   |   |   â”‚             model_name='conflictohorario',
|   |   |   â”‚             name='tipo_conflicto',
|   |   |   â”‚             field=models.CharField(choices=[('DOCENTE', 'Conflicto de Docente'), ('AULA', 'Conflicto de Aula'), ('CURSO', 'Conflicto de Curso'), ('CAPACIDAD', 'Conflicto de Capacidad'), ('EQUIPAMIENTO', 'Conflicto de Equipamiento')], max_length=20, verbose_name='Tipo de Conflicto'),
|   |   |   â”‚         ),
|   |   |   â”‚         migrations.CreateModel(
|   |   |   â”‚             name='DisponibilidadDocente',
|   |   |   â”‚             fields=[
|   |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
|   |   |   â”‚                 ('dia_semana', models.CharField(choices=[('LUNES', 'Lunes'), ('MARTES', 'Martes'), ('MIERCOLES', 'MiÃ©rcoles'), ('JUEVES', 'Jueves'), ('VIERNES', 'Viernes'), ('SABADO', 'SÃ¡bado')], max_length=20, verbose_name='DÃ­a de la Semana')),
|   |   |   â”‚                 ('bloque_horario', models.CharField(choices=[('08:00-10:00', '08:00 - 10:00'), ('10:00-12:00', '10:00 - 12:00'), ('12:00-14:00', '12:00 - 14:00'), ('14:00-16:00', '14:00 - 16:00'), ('16:00-18:00', '16:00 - 18:00'), ('18:00-20:00', '18:00 - 20:00')], max_length=20, verbose_name='Bloque Horario')),
|   |   |   â”‚                 ('disponible', models.BooleanField(default=True, verbose_name='Disponible')),
|   |   |   â”‚                 ('fecha_actualizacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de ActualizaciÃ³n')),
|   |   |   â”‚                 ('docente', models.ForeignKey(limit_choices_to={'rol': 'DOCENTE'}, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Docente')),
|   |   |   â”‚             ],
|   |   |   â”‚             options={
|   |   |   â”‚                 'verbose_name': 'Disponibilidad de Docente',
|   |   |   â”‚                 'verbose_name_plural': 'Disponibilidades de Docentes',
|   |   |   â”‚                 'ordering': ['docente', 'dia_semana', 'bloque_horario'],
|   |   |   â”‚                 'unique_together': {('docente', 'dia_semana', 'bloque_horario')},
|   |   |   â”‚             },
|   |   |   â”‚         ),
|   |   |   â”‚     ]
|   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |   `-- ğŸ“„ __init__.py
|   |         (Archivo vacÃ­o)
|   |-- ğŸ“„ models.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.db import models
|   |   â”‚ from django.conf import settings
|   |   â”‚ from academic.models import Curso, Aula
|   |   â”‚ 
|   |   â”‚ class Horario(models.Model):
|   |   â”‚     DIA_SEMANA = [
|   |   â”‚         ('LUNES', 'Lunes'),
|   |   â”‚         ('MARTES', 'Martes'),
|   |   â”‚         ('MIERCOLES', 'MiÃ©rcoles'),
|   |   â”‚         ('JUEVES', 'Jueves'),
|   |   â”‚         ('VIERNES', 'Viernes'),
|   |   â”‚         ('SABADO', 'SÃ¡bado'),
|   |   â”‚     ]
|   |   â”‚ 
|   |   â”‚     BLOQUES_HORARIOS = [
|   |   â”‚         ('08:00-10:00', '08:00 - 10:00'),
|   |   â”‚         ('10:00-12:00', '10:00 - 12:00'),
|   |   â”‚         ('12:00-14:00', '12:00 - 14:00'),
|   |   â”‚         ('14:00-16:00', '14:00 - 16:00'),
|   |   â”‚         ('16:00-18:00', '16:00 - 18:00'),
|   |   â”‚         ('18:00-20:00', '18:00 - 20:00'),
|   |   â”‚     ]
|   |   â”‚ 
|   |   â”‚     ESTADO_HORARIO = [
|   |   â”‚         ('BORRADOR', 'Borrador'),
|   |   â”‚         ('GENERADO', 'Generado'),
|   |   â”‚         ('APROBADO', 'Aprobado'),
|   |   â”‚         ('ACTIVO', 'Activo'),
|   |   â”‚         ('INACTIVO', 'Inactivo'),
|   |   â”‚     ]
|   |   â”‚ 
|   |   â”‚     nombre = models.CharField(max_length=100, verbose_name="Nombre del Horario")
|   |   â”‚     semestre = models.CharField(max_length=20, verbose_name="Semestre AcadÃ©mico")
|   |   â”‚     fecha_creacion = models.DateTimeField(auto_now_add=True, verbose_name="Fecha de CreaciÃ³n")
|   |   â”‚     fecha_actualizacion = models.DateTimeField(auto_now=True, verbose_name="Fecha de ActualizaciÃ³n")
|   |   â”‚     estado = models.CharField(max_length=20, choices=ESTADO_HORARIO, default='BORRADOR')
|   |   â”‚     creado_por = models.ForeignKey(
|   |   â”‚         settings.AUTH_USER_MODEL,
|   |   â”‚         on_delete=models.CASCADE,
|   |   â”‚         verbose_name="Creado por"
|   |   â”‚     )
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         verbose_name = "Horario"
|   |   â”‚         verbose_name_plural = "Horarios"
|   |   â”‚         ordering = ['-fecha_creacion']
|   |   â”‚ 
|   |   â”‚     def __str__(self):
|   |   â”‚         return f"{self.nombre} - {self.semestre} ({self.estado})"
|   |   â”‚ 
|   |   â”‚ class Asignacion(models.Model):
|   |   â”‚     horario = models.ForeignKey(Horario, on_delete=models.CASCADE, related_name='asignaciones')
|   |   â”‚     curso = models.ForeignKey(Curso, on_delete=models.CASCADE, verbose_name="Curso")
|   |   â”‚     docente = models.ForeignKey(
|   |   â”‚         settings.AUTH_USER_MODEL,
|   |   â”‚         on_delete=models.CASCADE,
|   |   â”‚         limit_choices_to={'rol': 'DOCENTE'},
|   |   â”‚         verbose_name="Docente"
|   |   â”‚     )
|   |   â”‚     aula = models.ForeignKey(Aula, on_delete=models.CASCADE, verbose_name="Aula")
|   |   â”‚     dia_semana = models.CharField(max_length=20, choices=Horario.DIA_SEMANA, verbose_name="DÃ­a de la Semana")
|   |   â”‚     bloque_horario = models.CharField(max_length=20, choices=Horario.BLOQUES_HORARIOS, verbose_name="Bloque Horario")
|   |   â”‚     fecha_asignacion = models.DateTimeField(auto_now_add=True, verbose_name="Fecha de AsignaciÃ³n")
|   |   â”‚     activa = models.BooleanField(default=True, verbose_name="AsignaciÃ³n Activa")
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         verbose_name = "AsignaciÃ³n"
|   |   â”‚         verbose_name_plural = "Asignaciones"
|   |   â”‚         ordering = ['dia_semana', 'bloque_horario']
|   |   â”‚         unique_together = [
|   |   â”‚             ['horario', 'docente', 'dia_semana', 'bloque_horario'],
|   |   â”‚             ['horario', 'aula', 'dia_semana', 'bloque_horario'],
|   |   â”‚             ['horario', 'curso', 'dia_semana', 'bloque_horario'],
|   |   â”‚         ]
|   |   â”‚ 
|   |   â”‚     def __str__(self):
|   |   â”‚         return f"{self.curso.codigo} - {self.docente.username} - {self.dia_semana} {self.bloque_horario}"
|   |   â”‚ 
|   |   â”‚ class ConflictoHorario(models.Model):
|   |   â”‚     TIPO_CONFLICTO = [
|   |   â”‚         ('DOCENTE', 'Conflicto de Docente'),
|   |   â”‚         ('AULA', 'Conflicto de Aula'),
|   |   â”‚         ('CURSO', 'Conflicto de Curso'),
|   |   â”‚         ('CAPACIDAD', 'Conflicto de Capacidad'),
|   |   â”‚         ('EQUIPAMIENTO', 'Conflicto de Equipamiento'),
|   |   â”‚     ]
|   |   â”‚ 
|   |   â”‚     horario = models.ForeignKey(Horario, on_delete=models.CASCADE, related_name='conflictos')
|   |   â”‚     asignacion = models.ForeignKey(Asignacion, on_delete=models.CASCADE, verbose_name="AsignaciÃ³n Conflictiva")
|   |   â”‚     tipo_conflicto = models.CharField(max_length=20, choices=TIPO_CONFLICTO, verbose_name="Tipo de Conflicto")
|   |   â”‚     descripcion = models.TextField(verbose_name="DescripciÃ³n del Conflicto")
|   |   â”‚     fecha_deteccion = models.DateTimeField(auto_now_add=True, verbose_name="Fecha de DetecciÃ³n")
|   |   â”‚     resuelto = models.BooleanField(default=False, verbose_name="Conflicto Resuelto")
|   |   â”‚     fecha_resolucion = models.DateTimeField(null=True, blank=True, verbose_name="Fecha de ResoluciÃ³n")
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         verbose_name = "Conflicto de Horario"
|   |   â”‚         verbose_name_plural = "Conflictos de Horario"
|   |   â”‚         ordering = ['-fecha_deteccion']
|   |   â”‚ 
|   |   â”‚     def __str__(self):
|   |   â”‚         return f"Conflicto {self.tipo_conflicto} - {self.asignacion.curso.codigo}"
|   |   â”‚ 
|   |   â”‚ # NUEVO MODELO AGREGADO
|   |   â”‚ class DisponibilidadDocente(models.Model):
|   |   â”‚     """
|   |   â”‚     Modelo para gestionar la disponibilidad horaria de los docentes
|   |   â”‚     """
|   |   â”‚     docente = models.ForeignKey(
|   |   â”‚         settings.AUTH_USER_MODEL,
|   |   â”‚         on_delete=models.CASCADE,
|   |   â”‚         limit_choices_to={'rol': 'DOCENTE'},
|   |   â”‚         verbose_name="Docente"
|   |   â”‚     )
|   |   â”‚     dia_semana = models.CharField(max_length=20, choices=Horario.DIA_SEMANA, verbose_name="DÃ­a de la Semana")
|   |   â”‚     bloque_horario = models.CharField(max_length=20, choices=Horario.BLOQUES_HORARIOS, verbose_name="Bloque Horario")
|   |   â”‚     disponible = models.BooleanField(default=True, verbose_name="Disponible")
|   |   â”‚     fecha_actualizacion = models.DateTimeField(auto_now=True, verbose_name="Fecha de ActualizaciÃ³n")
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         verbose_name = "Disponibilidad de Docente"
|   |   â”‚         verbose_name_plural = "Disponibilidades de Docentes"
|   |   â”‚         ordering = ['docente', 'dia_semana', 'bloque_horario']
|   |   â”‚         unique_together = ['docente', 'dia_semana', 'bloque_horario']
|   |   â”‚ 
|   |   â”‚     def __str__(self):
|   |   â”‚         estado = "Disponible" if self.disponible else "No Disponible"
|   |   â”‚         return f"{self.docente.username} - {self.dia_semana} {self.bloque_horario} ({estado})"
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ serializers.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from rest_framework import serializers
|   |   â”‚ from .models import Horario, Asignacion, ConflictoHorario, DisponibilidadDocente
|   |   â”‚ from academic.serializers import CursoSerializer, AulaSerializer
|   |   â”‚ from users.serializers import UserSerializer
|   |   â”‚ 
|   |   â”‚ class HorarioSerializer(serializers.ModelSerializer):
|   |   â”‚     creado_por_nombre = serializers.CharField(source='creado_por.get_full_name', read_only=True)
|   |   â”‚     total_asignaciones = serializers.SerializerMethodField()
|   |   â”‚     total_conflictos = serializers.SerializerMethodField()
|   |   â”‚     estado_display = serializers.CharField(source='get_estado_display', read_only=True)
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         model = Horario
|   |   â”‚         fields = [
|   |   â”‚             'id', 'nombre', 'semestre', 'estado', 'estado_display',
|   |   â”‚             'fecha_creacion', 'fecha_actualizacion', 'creado_por',
|   |   â”‚             'creado_por_nombre', 'total_asignaciones', 'total_conflictos'
|   |   â”‚         ]
|   |   â”‚         read_only_fields = ['fecha_creacion', 'fecha_actualizacion', 'creado_por']
|   |   â”‚ 
|   |   â”‚     def get_total_asignaciones(self, obj):
|   |   â”‚         return obj.asignaciones.count()
|   |   â”‚ 
|   |   â”‚     def get_total_conflictos(self, obj):
|   |   â”‚         return obj.conflictos.count()
|   |   â”‚ 
|   |   â”‚ class AsignacionSerializer(serializers.ModelSerializer):
|   |   â”‚     curso_info = CursoSerializer(source='curso', read_only=True)
|   |   â”‚     docente_info = UserSerializer(source='docente', read_only=True)
|   |   â”‚     aula_info = AulaSerializer(source='aula', read_only=True)
|   |   â”‚     dia_display = serializers.CharField(source='get_dia_semana_display', read_only=True)
|   |   â”‚     bloque_display = serializers.CharField(source='get_bloque_horario_display', read_only=True)
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         model = Asignacion
|   |   â”‚         fields = [
|   |   â”‚             'id', 'horario', 'curso', 'curso_info', 'docente', 'docente_info',
|   |   â”‚             'aula', 'aula_info', 'dia_semana', 'dia_display', 'bloque_horario',
|   |   â”‚             'bloque_display', 'fecha_asignacion', 'activa'
|   |   â”‚         ]
|   |   â”‚ 
|   |   â”‚ class AsignacionCreateSerializer(serializers.ModelSerializer):
|   |   â”‚     class Meta:
|   |   â”‚         model = Asignacion
|   |   â”‚         fields = [
|   |   â”‚             'horario', 'curso', 'docente', 'aula',
|   |   â”‚             'dia_semana', 'bloque_horario', 'activa'
|   |   â”‚         ]
|   |   â”‚ 
|   |   â”‚     def validate(self, data):
|   |   â”‚         # Validar que no haya conflictos de horario
|   |   â”‚         horario = data['horario']
|   |   â”‚         docente = data['docente']
|   |   â”‚         aula = data['aula']
|   |   â”‚         dia_semana = data['dia_semana']
|   |   â”‚         bloque_horario = data['bloque_horario']
|   |   â”‚ 
|   |   â”‚         # Verificar conflicto de docente
|   |   â”‚         if Asignacion.objects.filter(
|   |   â”‚             horario=horario,
|   |   â”‚             docente=docente,
|   |   â”‚             dia_semana=dia_semana,
|   |   â”‚             bloque_horario=bloque_horario
|   |   â”‚         ).exists():
|   |   â”‚             raise serializers.ValidationError(
|   |   â”‚                 "El docente ya tiene una asignaciÃ³n en este horario"
|   |   â”‚             )
|   |   â”‚ 
|   |   â”‚         # Verificar conflicto de aula
|   |   â”‚         if Asignacion.objects.filter(
|   |   â”‚             horario=horario,
|   |   â”‚             aula=aula,
|   |   â”‚             dia_semana=dia_semana,
|   |   â”‚             bloque_horario=bloque_horario
|   |   â”‚         ).exists():
|   |   â”‚             raise serializers.ValidationError(
|   |   â”‚                 "El aula ya estÃ¡ ocupada en este horario"
|   |   â”‚             )
|   |   â”‚ 
|   |   â”‚         return data
|   |   â”‚ 
|   |   â”‚ class ConflictoHorarioSerializer(serializers.ModelSerializer):
|   |   â”‚     asignacion_info = AsignacionSerializer(source='asignacion', read_only=True)
|   |   â”‚     tipo_display = serializers.CharField(source='get_tipo_conflicto_display', read_only=True)
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         model = ConflictoHorario
|   |   â”‚         fields = [
|   |   â”‚             'id', 'horario', 'asignacion', 'asignacion_info',
|   |   â”‚             'tipo_conflicto', 'tipo_display', 'descripcion',
|   |   â”‚             'fecha_deteccion', 'resuelto', 'fecha_resolucion'
|   |   â”‚         ]
|   |   â”‚         read_only_fields = ['fecha_deteccion', 'fecha_resolucion']
|   |   â”‚ 
|   |   â”‚ # NUEVO SERIALIZER AGREGADO
|   |   â”‚ class DisponibilidadDocenteSerializer(serializers.ModelSerializer):
|   |   â”‚     docente_info = UserSerializer(source='docente', read_only=True)
|   |   â”‚     dia_display = serializers.CharField(source='get_dia_semana_display', read_only=True)
|   |   â”‚     bloque_display = serializers.CharField(source='get_bloque_horario_display', read_only=True)
|   |   â”‚ 
|   |   â”‚     class Meta:
|   |   â”‚         model = DisponibilidadDocente
|   |   â”‚         fields = [
|   |   â”‚             'id', 'docente', 'docente_info', 'dia_semana', 'dia_display',
|   |   â”‚             'bloque_horario', 'bloque_display', 'disponible', 'fecha_actualizacion'
|   |   â”‚         ]
|   |   â”‚         read_only_fields = ['fecha_actualizacion']
|   |   â”‚ 
|   |   â”‚ class DisponibilidadMasivaSerializer(serializers.Serializer):
|   |   â”‚     """
|   |   â”‚     Serializer para actualizaciÃ³n masiva de disponibilidad
|   |   â”‚     """
|   |   â”‚     docente = serializers.IntegerField()
|   |   â”‚     disponibilidades = serializers.ListField(
|   |   â”‚         child=serializers.DictField(
|   |   â”‚             child=serializers.BooleanField()
|   |   â”‚         )
|   |   â”‚     )
|   |   â”‚ 
|   |   â”‚     def validate_docente(self, value):
|   |   â”‚         from users.models import User
|   |   â”‚         try:
|   |   â”‚             docente = User.objects.get(id=value, rol='DOCENTE')
|   |   â”‚             return docente
|   |   â”‚         except User.DoesNotExist:
|   |   â”‚             raise serializers.ValidationError("Docente no encontrado")
|   |   â”‚ 
|   |   â”‚ class GenerarHorarioSerializer(serializers.Serializer):
|   |   â”‚     """Serializer para la generaciÃ³n de horarios"""
|   |   â”‚     nombre = serializers.CharField(max_length=100)
|   |   â”‚     semestre = serializers.CharField(max_length=20)
|   |   â”‚     configuracion = serializers.JSONField(default=dict)
|   |   â”‚ 
|   |   â”‚     def validate_configuracion(self, value):
|   |   â”‚         configuraciones_validas = {
|   |   â”‚             'dias_semana': ['LUNES', 'MARTES', 'MIERCOLES', 'JUEVES', 'VIERNES'],
|   |   â”‚             'bloques_horarios': ['08:00-10:00', '10:00-12:00', '14:00-16:00', '16:00-18:00'],
|   |   â”‚             'max_intentos_por_curso': 1000
|   |   â”‚         }
|   |   â”‚ 
|   |   â”‚         # Validar que las configuraciones sean correctas
|   |   â”‚         if 'dias_semana' in value:
|   |   â”‚             dias_validos = ['LUNES', 'MARTES', 'MIERCOLES', 'JUEVES', 'VIERNES', 'SABADO']
|   |   â”‚             for dia in value['dias_semana']:
|   |   â”‚                 if dia not in dias_validos:
|   |   â”‚                     raise serializers.ValidationError(f"DÃ­a no vÃ¡lido: {dia}")
|   |   â”‚ 
|   |   â”‚         return value
|   |   â”‚ 
|   |   â”‚ class EstadisticasHorarioSerializer(serializers.Serializer):
|   |   â”‚     """Serializer para estadÃ­sticas del horario"""
|   |   â”‚     total_asignaciones = serializers.IntegerField()
|   |   â”‚     asignaciones_activas = serializers.IntegerField()
|   |   â”‚     total_conflictos = serializers.IntegerField()
|   |   â”‚     conflictos_resueltos = serializers.IntegerField()
|   |   â”‚     porcentaje_ocupacion = serializers.FloatField()
|   |   â”‚     aulas_utilizadas = serializers.IntegerField()
|   |   â”‚     docentes_asignados = serializers.IntegerField()
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ tests.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.test import TestCase
|   |   â”‚ from django.urls import reverse
|   |   â”‚ from rest_framework import status
|   |   â”‚ from rest_framework.test import APITestCase
|   |   â”‚ from django.contrib.auth import get_user_model
|   |   â”‚ from .models import Horario, Asignacion, ConflictoHorario
|   |   â”‚ from academic.models import Curso, Aula
|   |   â”‚ 
|   |   â”‚ User = get_user_model()
|   |   â”‚ 
|   |   â”‚ class HorarioModelTest(TestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.user = User.objects.create_user(
|   |   â”‚             username='admin',
|   |   â”‚             password='password123',
|   |   â”‚             rol='ADMIN'
|   |   â”‚         )
|   |   â”‚         self.horario = Horario.objects.create(
|   |   â”‚             nombre="Horario 2025-I",
|   |   â”‚             semestre="2025-I",
|   |   â”‚             creado_por=self.user
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚     def test_horario_creation(self):
|   |   â”‚         self.assertEqual(self.horario.nombre, "Horario 2025-I")
|   |   â”‚         self.assertEqual(self.horario.semestre, "2025-I")
|   |   â”‚         self.assertEqual(self.horario.estado, "BORRADOR")
|   |   â”‚ 
|   |   â”‚ class AsignacionModelTest(TestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.user = User.objects.create_user(
|   |   â”‚             username='docente_test',
|   |   â”‚             password='password123',
|   |   â”‚             rol='DOCENTE'
|   |   â”‚         )
|   |   â”‚         self.horario = Horario.objects.create(
|   |   â”‚             nombre="Test Horario",
|   |   â”‚             semestre="2025-I",
|   |   â”‚             creado_por=self.user
|   |   â”‚         )
|   |   â”‚         self.curso = Curso.objects.create(
|   |   â”‚             nombre="Curso Test",
|   |   â”‚             codigo="TEST-001",
|   |   â”‚             creditos=3
|   |   â”‚         )
|   |   â”‚         self.aula = Aula.objects.create(
|   |   â”‚             nombre="Aula Test",
|   |   â”‚             capacidad=40
|   |   â”‚         )
|   |   â”‚         self.asignacion = Asignacion.objects.create(
|   |   â”‚             horario=self.horario,
|   |   â”‚             curso=self.curso,
|   |   â”‚             docente=self.user,
|   |   â”‚             aula=self.aula,
|   |   â”‚             dia_semana="LUNES",
|   |   â”‚             bloque_horario="08:00-10:00"
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚     def test_asignacion_creation(self):
|   |   â”‚         self.assertEqual(self.asignacion.curso, self.curso)
|   |   â”‚         self.assertEqual(self.asignacion.docente, self.user)
|   |   â”‚         self.assertEqual(self.asignacion.dia_semana, "LUNES")
|   |   â”‚         self.assertTrue(self.asignacion.activa)
|   |   â”‚ 
|   |   â”‚ class HorarioAPITest(APITestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.admin_user = User.objects.create_user(
|   |   â”‚             username='admin',
|   |   â”‚             password='password123',
|   |   â”‚             rol='ADMIN'
|   |   â”‚         )
|   |   â”‚         self.client.force_authenticate(user=self.admin_user)
|   |   â”‚ 
|   |   â”‚         self.horario_data = {
|   |   â”‚             'nombre': 'Horario Test API',
|   |   â”‚             'semestre': '2025-I'
|   |   â”‚         }
|   |   â”‚ 
|   |   â”‚     def test_create_horario(self):
|   |   â”‚         url = reverse('horario-list')
|   |   â”‚         response = self.client.post(url, self.horario_data, format='json')
|   |   â”‚         self.assertEqual(response.status_code, status.HTTP_201_CREATED)
|   |   â”‚         self.assertEqual(response.data['nombre'], 'Horario Test API')
|   |   â”‚         self.assertEqual(response.data['estado'], 'BORRADOR')
|   |   â”‚ 
|   |   â”‚     def test_list_horarios(self):
|   |   â”‚         Horario.objects.create(
|   |   â”‚             nombre="Horario 1",
|   |   â”‚             semestre="2025-I",
|   |   â”‚             creado_por=self.admin_user
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚         url = reverse('horario-list')
|   |   â”‚         response = self.client.get(url)
|   |   â”‚         self.assertEqual(response.status_code, status.HTTP_200_OK)
|   |   â”‚         self.assertGreater(len(response.data), 0)
|   |   â”‚ 
|   |   â”‚ class AsignacionAPITest(APITestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.admin_user = User.objects.create_user(
|   |   â”‚             username='admin',
|   |   â”‚             password='password123',
|   |   â”‚             rol='ADMIN'
|   |   â”‚         )
|   |   â”‚         self.docente_user = User.objects.create_user(
|   |   â”‚             username='docente',
|   |   â”‚             password='password123',
|   |   â”‚             rol='DOCENTE'
|   |   â”‚         )
|   |   â”‚         self.client.force_authenticate(user=self.admin_user)
|   |   â”‚ 
|   |   â”‚         self.horario = Horario.objects.create(
|   |   â”‚             nombre="Test Horario",
|   |   â”‚             semestre="2025-I",
|   |   â”‚             creado_por=self.admin_user
|   |   â”‚         )
|   |   â”‚         self.curso = Curso.objects.create(
|   |   â”‚             nombre="Curso Test",
|   |   â”‚             codigo="TEST-001",
|   |   â”‚             creditos=3
|   |   â”‚         )
|   |   â”‚         self.aula = Aula.objects.create(
|   |   â”‚             nombre="Aula Test",
|   |   â”‚             capacidad=40
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚     def test_create_asignacion(self):
|   |   â”‚         url = reverse('asignacion-list')
|   |   â”‚         data = {
|   |   â”‚             'horario': self.horario.id,
|   |   â”‚             'curso': self.curso.id,
|   |   â”‚             'docente': self.docente_user.id,
|   |   â”‚             'aula': self.aula.id,
|   |   â”‚             'dia_semana': 'LUNES',
|   |   â”‚             'bloque_horario': '08:00-10:00'
|   |   â”‚         }
|   |   â”‚         response = self.client.post(url, data, format='json')
|   |   â”‚         self.assertEqual(response.status_code, status.HTTP_201_CREATED)
|   |   â”‚ 
|   |   â”‚ class AlgorithmTest(TestCase):
|   |   â”‚     def setUp(self):
|   |   â”‚         self.admin_user = User.objects.create_user(
|   |   â”‚             username='admin',
|   |   â”‚             password='password123',
|   |   â”‚             rol='ADMIN'
|   |   â”‚         )
|   |   â”‚         self.horario = Horario.objects.create(
|   |   â”‚             nombre="Test Algorithm",
|   |   â”‚             semestre="2025-I",
|   |   â”‚             creado_por=self.admin_user
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚         # Crear datos de prueba para el algoritmo
|   |   â”‚         self.curso1 = Curso.objects.create(
|   |   â”‚             nombre="Curso 1",
|   |   â”‚             codigo="C1",
|   |   â”‚             creditos=4,
|   |   â”‚             sesiones_semana=2,
|   |   â”‚             capacidad_estimada=30
|   |   â”‚         )
|   |   â”‚         self.curso2 = Curso.objects.create(
|   |   â”‚             nombre="Curso 2",
|   |   â”‚             codigo="C2",
|   |   â”‚             creditos=3,
|   |   â”‚             sesiones_semana=1,
|   |   â”‚             capacidad_estimada=25
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚         self.aula1 = Aula.objects.create(
|   |   â”‚             nombre="Aula 1",
|   |   â”‚             capacidad=35
|   |   â”‚         )
|   |   â”‚         self.aula2 = Aula.objects.create(
|   |   â”‚             nombre="Aula 2",
|   |   â”‚             capacidad=30
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚         self.docente1 = User.objects.create_user(
|   |   â”‚             username='docente1',
|   |   â”‚             password='password123',
|   |   â”‚             rol='DOCENTE'
|   |   â”‚         )
|   |   â”‚         self.docente2 = User.objects.create_user(
|   |   â”‚             username='docente2',
|   |   â”‚             password='password123',
|   |   â”‚             rol='DOCENTE'
|   |   â”‚         )
|   |   â”‚ 
|   |   â”‚     def test_generador_horarios(self):
|   |   â”‚         from .core.algorithm import GeneradorHorarios
|   |   â”‚ 
|   |   â”‚         generador = GeneradorHorarios(self.horario.id)
|   |   â”‚         asignaciones_creadas = generador.generar_horario()
|   |   â”‚ 
|   |   â”‚         self.assertGreater(asignaciones_creadas, 0)
|   |   â”‚         self.assertEqual(self.horario.asignaciones.count(), asignaciones_creadas)
|   |   â”‚ 
|   |   â”‚         # Verificar que se detectaron conflictos
|   |   â”‚         generador.detectar_conflictos()
|   |   â”‚         self.assertGreaterEqual(self.horario.conflictos.count(), 0)
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ urls.py
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ from django.urls import path, include
|   |   â”‚ from rest_framework.routers import DefaultRouter
|   |   â”‚ from . import views
|   |   â”‚ 
|   |   â”‚ router = DefaultRouter()
|   |   â”‚ router.register(r'horarios', views.HorarioViewSet, basename='horario')
|   |   â”‚ router.register(r'asignaciones', views.AsignacionViewSet, basename='asignacion')
|   |   â”‚ router.register(r'conflictos', views.ConflictoHorarioViewSet, basename='conflicto')
|   |   â”‚ router.register(r'disponibilidades', views.DisponibilidadDocenteViewSet, basename='disponibilidad')  # NUEVA RUTA
|   |   â”‚ 
|   |   â”‚ urlpatterns = [
|   |   â”‚     path('', include(router.urls)),
|   |   â”‚ ]
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   `-- ğŸ“„ views.py
|       â”Œâ”€ CONTENIDO â”€â”
|       â”‚ from rest_framework import viewsets, status
|       â”‚ from rest_framework.decorators import action
|       â”‚ from rest_framework.response import Response
|       â”‚ from django.db.models import Count, Q
|       â”‚ from django.shortcuts import get_object_or_404
|       â”‚ from .models import Horario, Asignacion, ConflictoHorario, DisponibilidadDocente
|       â”‚ from .serializers import (
|       â”‚     HorarioSerializer, AsignacionSerializer, AsignacionCreateSerializer,
|       â”‚     ConflictoHorarioSerializer, GenerarHorarioSerializer, EstadisticasHorarioSerializer,
|       â”‚     DisponibilidadDocenteSerializer, DisponibilidadMasivaSerializer
|       â”‚ )
|       â”‚ from .core.algorithm import GeneradorHorarios, ResolvedorConflictos
|       â”‚ 
|       â”‚ class HorarioViewSet(viewsets.ModelViewSet):
|       â”‚     queryset = Horario.objects.all()
|       â”‚     serializer_class = HorarioSerializer
|       â”‚ 
|       â”‚     def get_queryset(self):
|       â”‚         queryset = Horario.objects.all()
|       â”‚ 
|       â”‚         # Filtros
|       â”‚         estado = self.request.query_params.get('estado', None)
|       â”‚         semestre = self.request.query_params.get('semestre', None)
|       â”‚         search = self.request.query_params.get('search', None)
|       â”‚ 
|       â”‚         if estado:
|       â”‚             queryset = queryset.filter(estado=estado)
|       â”‚         if semestre:
|       â”‚             queryset = queryset.filter(semestre__icontains=semestre)
|       â”‚         if search:
|       â”‚             queryset = queryset.filter(
|       â”‚                 Q(nombre__icontains=search) |
|       â”‚                 Q(semestre__icontains=search)
|       â”‚             )
|       â”‚ 
|       â”‚         return queryset
|       â”‚ 
|       â”‚     def perform_create(self, serializer):
|       â”‚         # Asignar automÃ¡ticamente el usuario que crea el horario
|       â”‚         serializer.save(creado_por=self.request.user)
|       â”‚ 
|       â”‚     @action(detail=True, methods=['post'])
|       â”‚     def generar_automatico(self, request, pk=None):
|       â”‚         """
|       â”‚         Genera automÃ¡ticamente un horario usando el algoritmo inteligente
|       â”‚         """
|       â”‚         horario = self.get_object()
|       â”‚ 
|       â”‚         if horario.estado not in ['BORRADOR', 'GENERADO']:
|       â”‚             return Response(
|       â”‚                 {'error': 'No se puede generar un horario en estado actual'},
|       â”‚                 status=status.HTTP_400_BAD_REQUEST
|       â”‚             )
|       â”‚ 
|       â”‚         try:
|       â”‚             generador = GeneradorHorarios(horario.id)
|       â”‚             asignaciones_creadas = generador.generar_horario()
|       â”‚ 
|       â”‚             # Detectar conflictos despuÃ©s de la generaciÃ³n
|       â”‚             generador.detectar_conflictos()
|       â”‚ 
|       â”‚             return Response({
|       â”‚                 'message': f'Horario generado exitosamente. {asignaciones_creadas} asignaciones creadas.',
|       â”‚                 'asignaciones_creadas': asignaciones_creadas,
|       â”‚                 'estado': 'GENERADO'
|       â”‚             })
|       â”‚ 
|       â”‚         except Exception as e:
|       â”‚             return Response(
|       â”‚                 {'error': f'Error al generar horario: {str(e)}'},
|       â”‚                 status=status.HTTP_500_INTERNAL_SERVER_ERROR
|       â”‚             )
|       â”‚ 
|       â”‚     @action(detail=True, methods=['post'])
|       â”‚     def resolver_conflictos(self, request, pk=None):
|       â”‚         """
|       â”‚         Resuelve automÃ¡ticamente los conflictos del horario
|       â”‚         """
|       â”‚         horario = self.get_object()
|       â”‚ 
|       â”‚         try:
|       â”‚             resolvedor = ResolvedorConflictos(horario.id)
|       â”‚             conflictos_resueltos = resolvedor.resolver_conflictos()
|       â”‚ 
|       â”‚             return Response({
|       â”‚                 'message': f'Se resolvieron {conflictos_resueltos} conflictos automÃ¡ticamente.',
|       â”‚                 'conflictos_resueltos': conflictos_resueltos
|       â”‚             })
|       â”‚ 
|       â”‚         except Exception as e:
|       â”‚             return Response(
|       â”‚                 {'error': f'Error al resolver conflictos: {str(e)}'},
|       â”‚                 status=status.HTTP_500_INTERNAL_SERVER_ERROR
|       â”‚             )
|       â”‚ 
|       â”‚     @action(detail=True, methods=['get'])
|       â”‚     def estadisticas(self, request, pk=None):
|       â”‚         """
|       â”‚         Obtiene estadÃ­sticas detalladas del horario
|       â”‚         """
|       â”‚         horario = self.get_object()
|       â”‚ 
|       â”‚         total_asignaciones = horario.asignaciones.count()
|       â”‚         asignaciones_activas = horario.asignaciones.filter(activa=True).count()
|       â”‚         total_conflictos = horario.conflictos.count()
|       â”‚         conflictos_resueltos = horario.conflictos.filter(resuelto=True).count()
|       â”‚ 
|       â”‚         # Calcular porcentaje de ocupaciÃ³n
|       â”‚         total_bloques_posibles = 5 * 6  # 5 dÃ­as Ã— 6 bloques por dÃ­a
|       â”‚         porcentaje_ocupacion = (asignaciones_activas / total_bloques_posibles * 100) if total_bloques_posibles > 0 else 0
|       â”‚ 
|       â”‚         # Aulas y docentes utilizados
|       â”‚         aulas_utilizadas = horario.asignaciones.values('aula').distinct().count()
|       â”‚         docentes_asignados = horario.asignaciones.values('docente').distinct().count()
|       â”‚ 
|       â”‚         estadisticas = {
|       â”‚             'total_asignaciones': total_asignaciones,
|       â”‚             'asignaciones_activas': asignaciones_activas,
|       â”‚             'total_conflictos': total_conflictos,
|       â”‚             'conflictos_resueltos': conflictos_resueltos,
|       â”‚             'porcentaje_ocupacion': round(porcentaje_ocupacion, 2),
|       â”‚             'aulas_utilizadas': aulas_utilizadas,
|       â”‚             'docentes_asignados': docentes_asignados
|       â”‚         }
|       â”‚ 
|       â”‚         serializer = EstadisticasHorarioSerializer(estadisticas)
|       â”‚         return Response(serializer.data)
|       â”‚ 
|       â”‚     @action(detail=True, methods=['get'])
|       â”‚     def asignaciones(self, request, pk=None):
|       â”‚         """
|       â”‚         Obtiene todas las asignaciones de un horario especÃ­fico
|       â”‚         """
|       â”‚         horario = self.get_object()
|       â”‚         asignaciones = horario.asignaciones.all()
|       â”‚ 
|       â”‚         # Filtros opcionales
|       â”‚         dia = request.query_params.get('dia', None)
|       â”‚         docente = request.query_params.get('docente', None)
|       â”‚         aula = request.query_params.get('aula', None)
|       â”‚ 
|       â”‚         if dia:
|       â”‚             asignaciones = asignaciones.filter(dia_semana=dia)
|       â”‚         if docente:
|       â”‚             asignaciones = asignaciones.filter(docente_id=docente)
|       â”‚         if aula:
|       â”‚             asignaciones = asignaciones.filter(aula_id=aula)
|       â”‚ 
|       â”‚         serializer = AsignacionSerializer(asignaciones, many=True)
|       â”‚         return Response(serializer.data)
|       â”‚ 
|       â”‚     @action(detail=True, methods=['get'])
|       â”‚     def conflictos(self, request, pk=None):
|       â”‚         """
|       â”‚         Obtiene todos los conflictos de un horario especÃ­fico
|       â”‚         """
|       â”‚         horario = self.get_object()
|       â”‚         conflictos = horario.conflictos.all()
|       â”‚ 
|       â”‚         # Filtrar por tipo de conflicto o estado de resoluciÃ³n
|       â”‚         tipo = request.query_params.get('tipo', None)
|       â”‚         resuelto = request.query_params.get('resuelto', None)
|       â”‚ 
|       â”‚         if tipo:
|       â”‚             conflictos = conflictos.filter(tipo_conflicto=tipo)
|       â”‚         if resuelto is not None:
|       â”‚             conflictos = conflictos.filter(resuelto=resuelto.lower() == 'true')
|       â”‚ 
|       â”‚         serializer = ConflictoHorarioSerializer(conflictos, many=True)
|       â”‚         return Response(serializer.data)
|       â”‚ 
|       â”‚ class AsignacionViewSet(viewsets.ModelViewSet):
|       â”‚     queryset = Asignacion.objects.all()
|       â”‚ 
|       â”‚     def get_serializer_class(self):
|       â”‚         if self.action in ['create', 'update', 'partial_update']:
|       â”‚             return AsignacionCreateSerializer
|       â”‚         return AsignacionSerializer
|       â”‚ 
|       â”‚     def get_queryset(self):
|       â”‚         queryset = Asignacion.objects.all()
|       â”‚ 
|       â”‚         # Filtros
|       â”‚         horario = self.request.query_params.get('horario', None)
|       â”‚         docente = self.request.query_params.get('docente', None)
|       â”‚         aula = self.request.query_params.get('aula', None)
|       â”‚         dia = self.request.query_params.get('dia', None)
|       â”‚         activa = self.request.query_params.get('activa', None)
|       â”‚ 
|       â”‚         if horario:
|       â”‚             queryset = queryset.filter(horario_id=horario)
|       â”‚         if docente:
|       â”‚             queryset = queryset.filter(docente_id=docente)
|       â”‚         if aula:
|       â”‚             queryset = queryset.filter(aula_id=aula)
|       â”‚         if dia:
|       â”‚             queryset = queryset.filter(dia_semana=dia)
|       â”‚         if activa is not None:
|       â”‚             queryset = queryset.filter(activa=activa.lower() == 'true')
|       â”‚ 
|       â”‚         return queryset
|       â”‚ 
|       â”‚     @action(detail=True, methods=['post'])
|       â”‚     def toggle_activa(self, request, pk=None):
|       â”‚         """
|       â”‚         Activa/desactiva una asignaciÃ³n
|       â”‚         """
|       â”‚         asignacion = self.get_object()
|       â”‚         asignacion.activa = not asignacion.activa
|       â”‚         asignacion.save()
|       â”‚ 
|       â”‚         estado = "activada" if asignacion.activa else "desactivada"
|       â”‚         return Response({
|       â”‚             'message': f'AsignaciÃ³n {estado} exitosamente.',
|       â”‚             'activa': asignacion.activa
|       â”‚         })
|       â”‚ 
|       â”‚ class ConflictoHorarioViewSet(viewsets.ModelViewSet):
|       â”‚     queryset = ConflictoHorario.objects.all()
|       â”‚     serializer_class = ConflictoHorarioSerializer
|       â”‚ 
|       â”‚     def get_queryset(self):
|       â”‚         queryset = ConflictoHorario.objects.all()
|       â”‚ 
|       â”‚         # Filtros
|       â”‚         horario = self.request.query_params.get('horario', None)
|       â”‚         tipo = self.request.query_params.get('tipo', None)
|       â”‚         resuelto = self.request.query_params.get('resuelto', None)
|       â”‚ 
|       â”‚         if horario:
|       â”‚             queryset = queryset.filter(horario_id=horario)
|       â”‚         if tipo:
|       â”‚             queryset = queryset.filter(tipo_conflicto=tipo)
|       â”‚         if resuelto is not None:
|       â”‚             queryset = queryset.filter(resuelto=resuelto.lower() == 'true')
|       â”‚ 
|       â”‚         return queryset
|       â”‚ 
|       â”‚     @action(detail=True, methods=['post'])
|       â”‚     def marcar_resuelto(self, request, pk=None):
|       â”‚         """
|       â”‚         Marca un conflicto como resuelto
|       â”‚         """
|       â”‚         from django.utils import timezone
|       â”‚ 
|       â”‚         conflicto = self.get_object()
|       â”‚         conflicto.resuelto = True
|       â”‚         conflicto.fecha_resolucion = timezone.now()
|       â”‚         conflicto.save()
|       â”‚ 
|       â”‚         return Response({
|       â”‚             'message': 'Conflicto marcado como resuelto.',
|       â”‚             'resuelto': True,
|       â”‚             'fecha_resolucion': conflicto.fecha_resolucion
|       â”‚         })
|       â”‚ 
|       â”‚     @action(detail=False, methods=['get'])
|       â”‚     def estadisticas_globales(self, request):
|       â”‚         """
|       â”‚         EstadÃ­sticas globales de conflictos
|       â”‚         """
|       â”‚         total_conflictos = ConflictoHorario.objects.count()
|       â”‚         conflictos_resueltos = ConflictoHorario.objects.filter(resuelto=True).count()
|       â”‚         conflictos_por_tipo = ConflictoHorario.objects.values('tipo_conflicto').annotate(
|       â”‚             total=Count('id')
|       â”‚         )
|       â”‚ 
|       â”‚         return Response({
|       â”‚             'total_conflictos': total_conflictos,
|       â”‚             'conflictos_resueltos': conflictos_resueltos,
|       â”‚             'conflictos_pendientes': total_conflictos - conflictos_resueltos,
|       â”‚             'por_tipo': list(conflictos_por_tipo)
|       â”‚         })
|       â”‚ 
|       â”‚ # NUEVO VIEWSET AGREGADO
|       â”‚ class DisponibilidadDocenteViewSet(viewsets.ModelViewSet):
|       â”‚     """
|       â”‚     ViewSet para gestionar la disponibilidad de docentes
|       â”‚     """
|       â”‚     queryset = DisponibilidadDocente.objects.all()
|       â”‚     serializer_class = DisponibilidadDocenteSerializer
|       â”‚ 
|       â”‚     def get_queryset(self):
|       â”‚         queryset = DisponibilidadDocente.objects.all()
|       â”‚ 
|       â”‚         # Filtrar por docente
|       â”‚         docente = self.request.query_params.get('docente', None)
|       â”‚         if docente:
|       â”‚             queryset = queryset.filter(docente_id=docente)
|       â”‚ 
|       â”‚         # Filtrar por dÃ­a
|       â”‚         dia = self.request.query_params.get('dia', None)
|       â”‚         if dia:
|       â”‚             queryset = queryset.filter(dia_semana=dia)
|       â”‚ 
|       â”‚         # Filtrar por disponibilidad
|       â”‚         disponible = self.request.query_params.get('disponible', None)
|       â”‚         if disponible is not None:
|       â”‚             queryset = queryset.filter(disponible=disponible.lower() == 'true')
|       â”‚ 
|       â”‚         return queryset
|       â”‚ 
|       â”‚     @action(detail=False, methods=['post'])
|       â”‚     def actualizar_masivo(self, request):
|       â”‚         """
|       â”‚         Actualizar disponibilidad masiva para un docente
|       â”‚         """
|       â”‚         serializer = DisponibilidadMasivaSerializer(data=request.data)
|       â”‚         if serializer.is_valid():
|       â”‚             docente = serializer.validated_data['docente']
|       â”‚             disponibilidades = serializer.validated_data['disponibilidades']
|       â”‚ 
|       â”‚             try:
|       â”‚                 for disp_data in disponibilidades:
|       â”‚                     DisponibilidadDocente.objects.update_or_create(
|       â”‚                         docente=docente,
|       â”‚                         dia_semana=disp_data['dia_semana'],
|       â”‚                         bloque_horario=disp_data['bloque_horario'],
|       â”‚                         defaults={'disponible': disp_data['disponible']}
|       â”‚                     )
|       â”‚ 
|       â”‚                 return Response({'message': 'Disponibilidad actualizada exitosamente'})
|       â”‚ 
|       â”‚             except Exception as e:
|       â”‚                 return Response(
|       â”‚                     {'error': f'Error al actualizar disponibilidad: {str(e)}'},
|       â”‚                     status=status.HTTP_500_INTERNAL_SERVER_ERROR
|       â”‚                 )
|       â”‚         else:
|       â”‚             return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
|       â”‚ 
|       â”‚     @action(detail=False, methods=['get'])
|       â”‚     def por_docente(self, request):
|       â”‚         """
|       â”‚         Obtener toda la disponibilidad de un docente especÃ­fico
|       â”‚         """
|       â”‚         docente_id = request.query_params.get('docente')
|       â”‚         if not docente_id:
|       â”‚             return Response(
|       â”‚                 {'error': 'Se requiere el parÃ¡metro docente'},
|       â”‚                 status=status.HTTP_400_BAD_REQUEST
|       â”‚             )
|       â”‚ 
|       â”‚         disponibilidades = DisponibilidadDocente.objects.filter(docente_id=docente_id)
|       â”‚         serializer = self.get_serializer(disponibilidades, many=True)
|       â”‚         return Response(serializer.data)
|       â”‚ 
|       â”‚     @action(detail=False, methods=['get'])
|       â”‚     def resumen_disponibilidad(self, request):
|       â”‚         """
|       â”‚         Resumen de disponibilidad por docente
|       â”‚         """
|       â”‚         from django.db.models import Count
|       â”‚ 
|       â”‚         resumen = DisponibilidadDocente.objects.values(
|       â”‚             'docente__username',
|       â”‚             'docente__first_name',
|       â”‚             'docente__last_name'
|       â”‚         ).annotate(
|       â”‚             total_bloques=Count('id'),
|       â”‚             bloques_disponibles=Count('id', filter=Q(disponible=True)),
|       â”‚             bloques_no_disponibles=Count('id', filter=Q(disponible=False))
|       â”‚         )
|       â”‚ 
|       â”‚         return Response(list(resumen))
|       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|-- ğŸ“ static/
|   |-- ğŸ“ css/
|   |-- ğŸ“ images/
|   |   `-- ğŸ“„ 1.jpg
|   |         (No se pudo leer el contenido, puede ser un archivo binario)
|   `-- ğŸ“ js/
|-- ğŸ“ templates/
|   |-- ğŸ“ admin/
|   |   |-- ğŸ“„ base_site.html
|   |   |   â”Œâ”€ CONTENIDO â”€â”
|   |   |   â”‚ {% extends "admin/base.html" %}
|   |   |   â”‚ 
|   |   |   â”‚ {% block title %}{% if subtitle %}{{ subtitle }} | {% endif %}{{ title }} | {{ site_title|default:_('AdministraciÃ³n HoruNAP') }}{% endblock %}
|   |   |   â”‚ 
|   |   |   â”‚ {% block branding %}
|   |   |   â”‚ <h1 id="site-name"><a href="{% url 'admin:index' %}">ğŸ« AdministraciÃ³n HoruNAP - UNAP</a></h1>
|   |   |   â”‚ {% endblock %}
|   |   |   â”‚ 
|   |   |   â”‚ {% block nav-global %}{% endblock %}
|   |   |   â”‚ 
|   |   |   â”‚ {% block extrahead %}
|   |   |   â”‚ <style>
|   |   |   â”‚     /* --- Variables de DiseÃ±o y Color para fÃ¡cil personalizaciÃ³n --- */
|   |   |   â”‚     :root {
|   |   |   â”‚         --primary-color: #0052D4;
|   |   |   â”‚         --secondary-color: #4364F7;
|   |   |   â”‚         --background-gradient: linear-gradient(to right, var(--primary-color), var(--secondary-color));
|   |   |   â”‚         --accent-add: #28a745;
|   |   |   â”‚         --accent-add-hover: #218838;
|   |   |   â”‚         --accent-change: #ffc107;
|   |   |   â”‚         --accent-change-hover: #e0a800;
|   |   |   â”‚ 
|   |   |   â”‚         --background-color: #f8f9fa;
|   |   |   â”‚         --surface-color: #ffffff;
|   |   |   â”‚         --text-primary: #212529;
|   |   |   â”‚         --text-secondary: #6c757d;
|   |   |   â”‚         --border-color: #dee2e6;
|   |   |   â”‚ 
|   |   |   â”‚         --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
|   |   |   â”‚         --box-shadow-hover: 0 7px 14px rgba(0, 0, 0, 0.08);
|   |   |   â”‚         --border-radius: 12px;
|   |   |   â”‚         --transition-speed: 0.3s;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- AnimaciÃ³n de entrada --- */
|   |   |   â”‚     @keyframes fadeInUp {
|   |   |   â”‚         from {
|   |   |   â”‚             opacity: 0;
|   |   |   â”‚             transform: translateY(15px);
|   |   |   â”‚         }
|   |   |   â”‚         to {
|   |   |   â”‚             opacity: 1;
|   |   |   â”‚             transform: translateY(0);
|   |   |   â”‚         }
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- Estilos Generales --- */
|   |   |   â”‚     body {
|   |   |   â”‚         font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
|   |   |   â”‚         background-color: var(--background-color);
|   |   |   â”‚         color: var(--text-primary);
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- Cabecera --- */
|   |   |   â”‚     #header {
|   |   |   â”‚         background: var(--background-gradient);
|   |   |   â”‚         color: white;
|   |   |   â”‚         box-shadow: 0 2px 5px rgba(0,0,0,0.1);
|   |   |   â”‚     }
|   |   |   â”‚     #header a:link, #header a:visited {
|   |   |   â”‚         color: white;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- MÃ³dulos del Panel --- */
|   |   |   â”‚     .module {
|   |   |   â”‚         border: none;
|   |   |   â”‚         margin-bottom: 30px;
|   |   |   â”‚         border-radius: var(--border-radius);
|   |   |   â”‚         box-shadow: var(--box-shadow);
|   |   |   â”‚         background: var(--surface-color);
|   |   |   â”‚         overflow: hidden;
|   |   |   â”‚         animation: fadeInUp 0.5s ease-out forwards;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .module caption {
|   |   |   â”‚         background: var(--background-gradient);
|   |   |   â”‚         color: white;
|   |   |   â”‚         font-size: 1.1em;
|   |   |   â”‚         font-weight: 600;
|   |   |   â”‚         padding: 15px 20px;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .module table {
|   |   |   â”‚         width: 100%;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- FILAS DE LA TABLA (CADA OPCIÃ“N DEL MENÃš) --- */
|   |   |   â”‚     .module tbody tr {
|   |   |   â”‚         display: flex; /* Usamos Flexbox para alinear contenido */
|   |   |   â”‚         justify-content: space-between;
|   |   |   â”‚         align-items: center;
|   |   |   â”‚         padding: 12px 20px;
|   |   |   â”‚         border-bottom: 1px solid var(--border-color);
|   |   |   â”‚         transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease, background-color var(--transition-speed) ease;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .module tbody tr:last-child {
|   |   |   â”‚         border-bottom: none;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .module tbody tr:hover {
|   |   |   â”‚         background-color: #f5f8ff;
|   |   |   â”‚         transform: translateY(-3px);
|   |   |   â”‚         box-shadow: var(--box-shadow-hover);
|   |   |   â”‚         cursor: pointer;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- (SOLUCIÃ“N) ESTILO DEL TEXTO DE LAS OPCIONES --- */
|   |   |   â”‚     .module tbody th {
|   |   |   â”‚         font-weight: 600;
|   |   |   â”‚         text-align: left;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .module tbody th a {
|   |   |   â”‚         color: var(--text-primary) !important; /* Asegura que el texto sea visible */
|   |   |   â”‚         text-decoration: none;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .module tbody th a:hover {
|   |   |   â”‚         color: var(--primary-color) !important;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- (DISEÃ‘O MEJORADO) BOTONES AÃ‘ADIR/MODIFICAR --- */
|   |   |   â”‚     .module tbody td {
|   |   |   â”‚         display: flex; /* Contenedor para los botones */
|   |   |   â”‚         gap: 8px; /* Espacio entre botones */
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .addlink, .changelink {
|   |   |   â”‚         display: inline-block;
|   |   |   â”‚         padding: 6px 14px;
|   |   |   â”‚         border-radius: 6px;
|   |   |   â”‚         color: white !important;
|   |   |   â”‚         font-weight: 500;
|   |   |   â”‚         font-size: 0.85em;
|   |   |   â”‚         text-decoration: none;
|   |   |   â”‚         transition: all var(--transition-speed) ease;
|   |   |   â”‚         background: none;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .addlink:hover, .changelink:hover {
|   |   |   â”‚         transform: scale(1.05);
|   |   |   â”‚         filter: brightness(1.1);
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚     .addlink {
|   |   |   â”‚         background-color: var(--accent-add);
|   |   |   â”‚         box-shadow: 0 2px 4px rgba(40, 167, 69, 0.3);
|   |   |   â”‚     }
|   |   |   â”‚     .addlink:hover { background-color: var(--accent-add-hover); }
|   |   |   â”‚ 
|   |   |   â”‚     .changelink {
|   |   |   â”‚         background-color: var(--accent-change);
|   |   |   â”‚         color: var(--text-primary) !important;
|   |   |   â”‚         box-shadow: 0 2px 4px rgba(255, 193, 7, 0.3);
|   |   |   â”‚     }
|   |   |   â”‚     .changelink:hover { background-color: var(--accent-change-hover); }
|   |   |   â”‚ 
|   |   |   â”‚     .addlink::before { content: "â• "; }
|   |   |   â”‚     .changelink::before { content: "âœï¸ "; }
|   |   |   â”‚ 
|   |   |   â”‚     /* --- Pie de PÃ¡gina --- */
|   |   |   â”‚     #footer {
|   |   |   â”‚         background: #e9ecef;
|   |   |   â”‚         padding: 20px;
|   |   |   â”‚         text-align: center;
|   |   |   â”‚         color: var(--text-secondary);
|   |   |   â”‚         margin-top: 30px;
|   |   |   â”‚     }
|   |   |   â”‚ 
|   |   |   â”‚ </style>
|   |   |   â”‚ {% endblock %}
|   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |   `-- ğŸ“„ login.html
|   |       â”Œâ”€ CONTENIDO â”€â”
|   |       â”‚ ï»¿<!DOCTYPE html>
|   |       â”‚ <html lang="es">
|   |       â”‚ <head>
|   |       â”‚     <meta charset="UTF-8">
|   |       â”‚     <meta name="viewport" content="width=device-width, initial-scale=1.0">
|   |       â”‚     <title>Intranet HoruNAP - UNAP</title>
|   |       â”‚     {% load static %}
|   |       â”‚     <style>
|   |       â”‚         * {
|   |       â”‚             margin: 0;
|   |       â”‚             padding: 0;
|   |       â”‚             box-sizing: border-box;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         body {
|   |       â”‚             font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
|   |       â”‚             min-height: 100vh;
|   |       â”‚             display: flex;
|   |       â”‚             justify-content: center;
|   |       â”‚             align-items: center;
|   |       â”‚             background:
|   |       â”‚                 linear-gradient(
|   |       â”‚                     rgba(30, 60, 114, 0.3),
|   |       â”‚                     rgba(42, 82, 152, 0.4)
|   |       â”‚                 ),
|   |       â”‚                 url('{% static "images/1.jpg" %}') center/cover;
|   |       â”‚             animation: backgroundMove 20s ease-in-out infinite;
|   |       â”‚             position: relative;
|   |       â”‚             overflow: hidden;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         /* Efecto de partÃ­culas animadas en el fondo - AZUL */
|   |       â”‚         body::before {
|   |       â”‚             content: '';
|   |       â”‚             position: absolute;
|   |       â”‚             top: 0;
|   |       â”‚             left: 0;
|   |       â”‚             width: 100%;
|   |       â”‚             height: 100%;
|   |       â”‚             background:
|   |       â”‚                 radial-gradient(circle at 20% 80%, rgba(74, 144, 226, 0.1) 2%, transparent 20%),
|   |       â”‚                 radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 2%, transparent 20%),
|   |       â”‚                 radial-gradient(circle at 40% 40%, rgba(30, 60, 114, 0.2) 3%, transparent 30%);
|   |       â”‚             animation: float 6s ease-in-out infinite;
|   |       â”‚             pointer-events: none;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         @keyframes backgroundMove {
|   |       â”‚             0%, 100% {
|   |       â”‚                 background-position: center center;
|   |       â”‚             }
|   |       â”‚             50% {
|   |       â”‚                 background-position: 10% 20%;
|   |       â”‚             }
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         @keyframes float {
|   |       â”‚             0%, 100% {
|   |       â”‚                 transform: translateY(0px) rotate(0deg);
|   |       â”‚             }
|   |       â”‚             50% {
|   |       â”‚                 transform: translateY(-20px) rotate(180deg);
|   |       â”‚             }
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         @keyframes slideIn {
|   |       â”‚             from {
|   |       â”‚                 opacity: 0;
|   |       â”‚                 transform: translateY(30px) scale(0.9);
|   |       â”‚             }
|   |       â”‚             to {
|   |       â”‚                 opacity: 1;
|   |       â”‚                 transform: translateY(0) scale(1);
|   |       â”‚             }
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         @keyframes pulse {
|   |       â”‚             0%, 100% {
|   |       â”‚                 transform: scale(1);
|   |       â”‚             }
|   |       â”‚             50% {
|   |       â”‚                 transform: scale(1.05);
|   |       â”‚             }
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         @keyframes shake {
|   |       â”‚             0%, 100% {
|   |       â”‚                 transform: translateX(0);
|   |       â”‚             }
|   |       â”‚             25% {
|   |       â”‚                 transform: translateX(-5px);
|   |       â”‚             }
|   |       â”‚             75% {
|   |       â”‚                 transform: translateX(5px);
|   |       â”‚             }
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-container {
|   |       â”‚             background: rgba(255, 255, 255, 0.95);
|   |       â”‚             backdrop-filter: blur(10px);
|   |       â”‚             border-radius: 20px;
|   |       â”‚             box-shadow:
|   |       â”‚                 0 25px 50px rgba(0, 0, 0, 0.3),
|   |       â”‚                 0 0 0 1px rgba(255, 255, 255, 0.1);
|   |       â”‚             padding: 50px 40px;
|   |       â”‚             width: 100%;
|   |       â”‚             max-width: 450px;
|   |       â”‚             animation: slideIn 0.8s ease-out;
|   |       â”‚             position: relative;
|   |       â”‚             overflow: hidden;
|   |       â”‚             transition: transform 0.3s ease;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-container:hover {
|   |       â”‚             transform: translateY(-5px);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-container::before {
|   |       â”‚             content: '';
|   |       â”‚             position: absolute;
|   |       â”‚             top: 0;
|   |       â”‚             left: -100%;
|   |       â”‚             width: 100%;
|   |       â”‚             height: 3px;
|   |       â”‚             background: linear-gradient(90deg, transparent, #2a5298, transparent);
|   |       â”‚             animation: shimmer 3s infinite;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         @keyframes shimmer {
|   |       â”‚             0% {
|   |       â”‚                 left: -100%;
|   |       â”‚             }
|   |       â”‚             100% {
|   |       â”‚                 left: 100%;
|   |       â”‚             }
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .header {
|   |       â”‚             text-align: center;
|   |       â”‚             margin-bottom: 40px;
|   |       â”‚             animation: slideIn 0.8s ease-out 0.2s both;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .unap-title {
|   |       â”‚             font-size: 1.4rem;
|   |       â”‚             font-weight: 700;
|   |       â”‚             color: #1e3c72;
|   |       â”‚             margin-bottom: 8px;
|   |       â”‚             text-shadow: 0 2px 4px rgba(0,0,0,0.1);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         /* CAMBIO PRINCIPAL: TÃ­tulo en azul */
|   |       â”‚         .intranet-title {
|   |       â”‚             font-size: 2.2rem;
|   |       â”‚             font-weight: 800;
|   |       â”‚             color: #2a5298; /* Cambiado de #ffd700 (amarillo) a azul */
|   |       â”‚             margin: 15px 0;
|   |       â”‚             text-shadow:
|   |       â”‚                 0 2px 4px rgba(0,0,0,0.3),
|   |       â”‚                 0 0 10px rgba(42, 82, 152, 0.3); /* Cambiado a azul */
|   |       â”‚             animation: pulse 2s ease-in-out infinite;
|   |       â”‚             position: relative;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .intranet-title::after {
|   |       â”‚             content: '';
|   |       â”‚             position: absolute;
|   |       â”‚             bottom: -5px;
|   |       â”‚             left: 25%;
|   |       â”‚             width: 50%;
|   |       â”‚             height: 2px;
|   |       â”‚             background: linear-gradient(90deg, transparent, #2a5298, transparent); /* Cambiado a azul */
|   |       â”‚             animation: pulse 2s ease-in-out infinite;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .form-group {
|   |       â”‚             margin-bottom: 25px;
|   |       â”‚             animation: slideIn 0.8s ease-out 0.4s both;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         label {
|   |       â”‚             display: block;
|   |       â”‚             margin-bottom: 8px;
|   |       â”‚             font-weight: 600;
|   |       â”‚             color: #1e3c72;
|   |       â”‚             font-size: 1rem;
|   |       â”‚             transition: color 0.3s ease;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .input-container {
|   |       â”‚             position: relative;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         input[type="text"], input[type="password"] {
|   |       â”‚             width: 100%;
|   |       â”‚             padding: 15px 20px 15px 50px;
|   |       â”‚             border: 2px solid #e8ecef;
|   |       â”‚             border-radius: 12px;
|   |       â”‚             font-size: 1rem;
|   |       â”‚             background: #f8f9fa;
|   |       â”‚             transition: all 0.3s ease;
|   |       â”‚             box-shadow: 0 2px 10px rgba(0,0,0,0.05);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         input[type="text"]:focus, input[type="password"]:focus {
|   |       â”‚             outline: none;
|   |       â”‚             border-color: #1e3c72;
|   |       â”‚             background: white;
|   |       â”‚             box-shadow:
|   |       â”‚                 0 0 0 3px rgba(30, 60, 114, 0.1),
|   |       â”‚                 0 5px 15px rgba(0,0,0,0.1);
|   |       â”‚             transform: translateY(-2px);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .input-icon {
|   |       â”‚             position: absolute;
|   |       â”‚             left: 15px;
|   |       â”‚             top: 50%;
|   |       â”‚             transform: translateY(-50%);
|   |       â”‚             font-size: 1.2rem;
|   |       â”‚             color: #1e3c72;
|   |       â”‚             transition: all 0.3s ease;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         input:focus + .input-icon {
|   |       â”‚             color: #2a5298; /* Cambiado de amarillo a azul */
|   |       â”‚             transform: translateY(-50%) scale(1.1);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-btn {
|   |       â”‚             width: 100%;
|   |       â”‚             padding: 16px;
|   |       â”‚             background: linear-gradient(135deg, #1e3c72, #2a5298);
|   |       â”‚             color: white;
|   |       â”‚             border: none;
|   |       â”‚             border-radius: 12px;
|   |       â”‚             font-size: 1.1rem;
|   |       â”‚             font-weight: 700;
|   |       â”‚             cursor: pointer;
|   |       â”‚             transition: all 0.3s ease;
|   |       â”‚             box-shadow: 0 5px 15px rgba(30, 60, 114, 0.4);
|   |       â”‚             position: relative;
|   |       â”‚             overflow: hidden;
|   |       â”‚             animation: slideIn 0.8s ease-out 0.6s both;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-btn::before {
|   |       â”‚             content: '';
|   |       â”‚             position: absolute;
|   |       â”‚             top: 0;
|   |       â”‚             left: -100%;
|   |       â”‚             width: 100%;
|   |       â”‚             height: 100%;
|   |       â”‚             background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
|   |       â”‚             transition: left 0.5s;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-btn:hover {
|   |       â”‚             transform: translateY(-3px);
|   |       â”‚             box-shadow:
|   |       â”‚                 0 8px 25px rgba(30, 60, 114, 0.6),
|   |       â”‚                 0 0 0 2px rgba(42, 82, 152, 0.3); /* Cambiado a azul */
|   |       â”‚             animation: pulse 1s ease-in-out;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-btn:hover::before {
|   |       â”‚             left: 100%;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .login-btn:active {
|   |       â”‚             transform: translateY(-1px);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .footer {
|   |       â”‚             text-align: center;
|   |       â”‚             margin-top: 30px;
|   |       â”‚             padding-top: 25px;
|   |       â”‚             border-top: 1px solid rgba(0,0,0,0.1);
|   |       â”‚             animation: slideIn 0.8s ease-out 0.8s both;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .forgot-link {
|   |       â”‚             color: #1e3c72;
|   |       â”‚             text-decoration: none;
|   |       â”‚             font-weight: 500;
|   |       â”‚             transition: all 0.3s ease;
|   |       â”‚             position: relative;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .forgot-link::after {
|   |       â”‚             content: '';
|   |       â”‚             position: absolute;
|   |       â”‚             bottom: -2px;
|   |       â”‚             left: 0;
|   |       â”‚             width: 0;
|   |       â”‚             height: 1px;
|   |       â”‚             background: #2a5298; /* Cambiado de amarillo a azul */
|   |       â”‚             transition: width 0.3s ease;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .forgot-link:hover {
|   |       â”‚             color: #2a5298; /* Cambiado de amarillo a azul */
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .forgot-link:hover::after {
|   |       â”‚             width: 100%;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .error {
|   |       â”‚             background: linear-gradient(135deg, #ffebee, #ffcdd2);
|   |       â”‚             color: #c62828;
|   |       â”‚             padding: 15px;
|   |       â”‚             border-radius: 10px;
|   |       â”‚             margin-bottom: 25px;
|   |       â”‚             text-align: center;
|   |       â”‚             font-weight: 600;
|   |       â”‚             border-left: 4px solid #c62828;
|   |       â”‚             animation: shake 0.5s ease-in-out;
|   |       â”‚             box-shadow: 0 3px 10px rgba(198, 40, 40, 0.2);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         .system-footer {
|   |       â”‚             text-align: center;
|   |       â”‚             color: white;
|   |       â”‚             margin-top: 40px;
|   |       â”‚             font-size: 0.9rem;
|   |       â”‚             opacity: 0.9;
|   |       â”‚             text-shadow: 0 2px 4px rgba(0,0,0,0.5);
|   |       â”‚             animation: slideIn 0.8s ease-out 1s both;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         /* Efectos de carga */
|   |       â”‚         .loading {
|   |       â”‚             display: inline-block;
|   |       â”‚             width: 20px;
|   |       â”‚             height: 20px;
|   |       â”‚             border: 3px solid rgba(255,255,255,.3);
|   |       â”‚             border-radius: 50%;
|   |       â”‚             border-top-color: #fff;
|   |       â”‚             animation: spin 1s ease-in-out infinite;
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         @keyframes spin {
|   |       â”‚             to { transform: rotate(360deg); }
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         /* Responsive */
|   |       â”‚         @media (max-width: 480px) {
|   |       â”‚             .login-container {
|   |       â”‚                 margin: 20px;
|   |       â”‚                 padding: 30px 25px;
|   |       â”‚             }
|   |       â”‚ 
|   |       â”‚             .intranet-title {
|   |       â”‚                 font-size: 1.8rem;
|   |       â”‚             }
|   |       â”‚ 
|   |       â”‚             .unap-title {
|   |       â”‚                 font-size: 1.2rem;
|   |       â”‚             }
|   |       â”‚         }
|   |       â”‚     </style>
|   |       â”‚ </head>
|   |       â”‚ <body>
|   |       â”‚     <div class="login-container">
|   |       â”‚         <div class="header">
|   |       â”‚             <div class="unap-title">Universidad Nacional de la AmazonÃ­a Peruana</div>
|   |       â”‚             <div class="intranet-title">INTRANET HORUNAP</div>
|   |       â”‚         </div>
|   |       â”‚ 
|   |       â”‚         {% if form.errors %}
|   |       â”‚         <div class="error">
|   |       â”‚             âŒ Error: Usuario o contraseÃ±a incorrectos
|   |       â”‚         </div>
|   |       â”‚         {% endif %}
|   |       â”‚ 
|   |       â”‚         <form method="post" id="loginForm">
|   |       â”‚             {% csrf_token %}
|   |       â”‚ 
|   |       â”‚             <div class="form-group">
|   |       â”‚                 <label for="username">Nombre de usuario:</label>
|   |       â”‚                 <div class="input-container">
|   |       â”‚                     <input type="text" id="username" name="username" placeholder="Ingresa tu usuario" required>
|   |       â”‚                     <span class="input-icon">ğŸ‘¤</span>
|   |       â”‚                 </div>
|   |       â”‚             </div>
|   |       â”‚ 
|   |       â”‚             <div class="form-group">
|   |       â”‚                 <label for="password">ContraseÃ±a:</label>
|   |       â”‚                 <div class="input-container">
|   |       â”‚                     <input type="password" id="password" name="password" placeholder="Ingresa tu contraseÃ±a" required>
|   |       â”‚                     <span class="input-icon">ğŸ”’</span>
|   |       â”‚                 </div>
|   |       â”‚             </div>
|   |       â”‚ 
|   |       â”‚             <button type="submit" class="login-btn" id="loginBtn">
|   |       â”‚                 ğŸš€ INICIAR SESIÃ“N
|   |       â”‚             </button>
|   |       â”‚         </form>
|   |       â”‚ 
|   |       â”‚         <div class="footer">
|   |       â”‚             <a href="#" class="forgot-link">
|   |       â”‚                 Â¿Olvidaste tu contraseÃ±a?
|   |       â”‚             </a>
|   |       â”‚         </div>
|   |       â”‚     </div>
|   |       â”‚ 
|   |       â”‚     <script>
|   |       â”‚         // CORRECCIÃ“N: Manejar el envÃ­o del formulario correctamente
|   |       â”‚         document.getElementById('loginForm').addEventListener('submit', function(e) {
|   |       â”‚             const btn = document.getElementById('loginBtn');
|   |       â”‚             const originalText = btn.innerHTML;
|   |       â”‚ 
|   |       â”‚             // Mostrar efecto de carga
|   |       â”‚             btn.innerHTML = '<span class="loading"></span> INGRESANDO...';
|   |       â”‚             btn.disabled = true;
|   |       â”‚ 
|   |       â”‚             // El formulario se enviarÃ¡ automÃ¡ticamente despuÃ©s de esto
|   |       â”‚             // No necesitamos prevenir el comportamiento por defecto
|   |       â”‚ 
|   |       â”‚             // Si por alguna razÃ³n no se envÃ­a, restaurar el botÃ³n despuÃ©s de 3 segundos
|   |       â”‚             setTimeout(() => {
|   |       â”‚                 btn.innerHTML = originalText;
|   |       â”‚                 btn.disabled = false;
|   |       â”‚             }, 3000);
|   |       â”‚         });
|   |       â”‚ 
|   |       â”‚         // Efectos de entrada en los inputs
|   |       â”‚         document.querySelectorAll('input').forEach(input => {
|   |       â”‚             input.addEventListener('focus', function() {
|   |       â”‚                 this.parentElement.style.transform = 'scale(1.02)';
|   |       â”‚             });
|   |       â”‚ 
|   |       â”‚             input.addEventListener('blur', function() {
|   |       â”‚                 this.parentElement.style.transform = 'scale(1)';
|   |       â”‚             });
|   |       â”‚         });
|   |       â”‚ 
|   |       â”‚         // Efecto de partÃ­culas dinÃ¡micas (opcional, puedes quitarlo si causa problemas)
|   |       â”‚         function createParticle() {
|   |       â”‚             const particle = document.createElement('div');
|   |       â”‚             particle.style.cssText = `
|   |       â”‚                 position: fixed;
|   |       â”‚                 width: 4px;
|   |       â”‚                 height: 4px;
|   |       â”‚                 background: rgba(42, 82, 152, 0.6); /* Cambiado a azul */
|   |       â”‚                 border-radius: 50%;
|   |       â”‚                 pointer-events: none;
|   |       â”‚                 z-index: 1;
|   |       â”‚                 animation: floatParticle 8s linear infinite;
|   |       â”‚             `;
|   |       â”‚ 
|   |       â”‚             particle.style.left = Math.random() * 100 + 'vw';
|   |       â”‚             particle.style.animationDelay = Math.random() * 5 + 's';
|   |       â”‚ 
|   |       â”‚             document.body.appendChild(particle);
|   |       â”‚ 
|   |       â”‚             setTimeout(() => {
|   |       â”‚                 particle.remove();
|   |       â”‚             }, 8000);
|   |       â”‚         }
|   |       â”‚ 
|   |       â”‚         // Crear partÃ­culas cada 500ms (opcional)
|   |       â”‚         setInterval(createParticle, 500);
|   |       â”‚ 
|   |       â”‚         // Agregar CSS para animaciÃ³n de partÃ­culas
|   |       â”‚         const style = document.createElement('style');
|   |       â”‚         style.textContent = `
|   |       â”‚             @keyframes floatParticle {
|   |       â”‚                 0% {
|   |       â”‚                     transform: translateY(100vh) scale(0);
|   |       â”‚                     opacity: 0;
|   |       â”‚                 }
|   |       â”‚                 10% {
|   |       â”‚                     opacity: 1;
|   |       â”‚                 }
|   |       â”‚                 90% {
|   |       â”‚                     opacity: 1;
|   |       â”‚                 }
|   |       â”‚                 100% {
|   |       â”‚                     transform: translateY(-100px) scale(1);
|   |       â”‚                     opacity: 0;
|   |       â”‚                 }
|   |       â”‚             }
|   |       â”‚         `;
|   |       â”‚         document.head.appendChild(style);
|   |       â”‚     </script>
|   |       â”‚ </body>
|   |       â”‚ </html>
|   |       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“„ base.html
|   |   â”Œâ”€ CONTENIDO â”€â”
|   |   â”‚ ï»¿<!DOCTYPE html>
|   |   â”‚ <html>
|   |   â”‚ <head>
|   |   â”‚     <title>{% block title %}HoruNAP{% endblock %}</title>
|   |   â”‚     <meta charset=\"utf-8\">
|   |   â”‚     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">
|   |   â”‚ </head>
|   |   â”‚ <body>
|   |   â”‚     {% block content %}{% endblock %}
|   |   â”‚ </body>
|   |   â”‚ </html>
|   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |-- ğŸ“ docente/
|   |   |-- ğŸ“„ dashboard.html
|   |   |   â”Œâ”€ CONTENIDO â”€â”
|   |   |   â”‚ <!DOCTYPE html>
|   |   |   â”‚ <html lang="es">
|   |   |   â”‚ <head>
|   |   |   â”‚     <meta charset="UTF-8">
|   |   |   â”‚     <meta name="viewport" content="width=device-width, initial-scale=1.0">
|   |   |   â”‚     <title>Panel Docente - HoruNAP</title>
|   |   |   â”‚     <style>
|   |   |   â”‚         * {
|   |   |   â”‚             margin: 0;
|   |   |   â”‚             padding: 0;
|   |   |   â”‚             box-sizing: border-box;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         body {
|   |   |   â”‚             font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
|   |   |   â”‚             background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
|   |   |   â”‚             min-height: 100vh;
|   |   |   â”‚             padding: 20px;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .container {
|   |   |   â”‚             max-width: 1200px;
|   |   |   â”‚             margin: 0 auto;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .header {
|   |   |   â”‚             background: rgba(255, 255, 255, 0.95);
|   |   |   â”‚             backdrop-filter: blur(10px);
|   |   |   â”‚             border-radius: 15px;
|   |   |   â”‚             padding: 30px;
|   |   |   â”‚             margin-bottom: 30px;
|   |   |   â”‚             box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
|   |   |   â”‚             border: 1px solid rgba(255, 255, 255, 0.2);
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .welcome-message h1 {
|   |   |   â”‚             font-size: 2.5em;
|   |   |   â”‚             margin-bottom: 5px;
|   |   |   â”‚             background: linear-gradient(135deg, #667eea, #764ba2);
|   |   |   â”‚             -webkit-background-clip: text;
|   |   |   â”‚             -webkit-text-fill-color: transparent;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .card-grid {
|   |   |   â”‚             display: grid;
|   |   |   â”‚             grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
|   |   |   â”‚             gap: 25px;
|   |   |   â”‚             margin-bottom: 30px;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .card {
|   |   |   â”‚             background: rgba(255, 255, 255, 0.95);
|   |   |   â”‚             border-radius: 15px;
|   |   |   â”‚             padding: 25px;
|   |   |   â”‚             box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
|   |   |   â”‚             border: 1px solid rgba(255, 255, 255, 0.2);
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .card h2 {
|   |   |   â”‚             color: #2c3e50;
|   |   |   â”‚             margin-bottom: 20px;
|   |   |   â”‚             font-size: 1.4em;
|   |   |   â”‚             display: flex;
|   |   |   â”‚             align-items: center;
|   |   |   â”‚             gap: 10px;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .btn {
|   |   |   â”‚             display: inline-flex;
|   |   |   â”‚             align-items: center;
|   |   |   â”‚             gap: 8px;
|   |   |   â”‚             background: linear-gradient(135deg, #667eea, #764ba2);
|   |   |   â”‚             color: white;
|   |   |   â”‚             padding: 12px 24px;
|   |   |   â”‚             border-radius: 8px;
|   |   |   â”‚             text-decoration: none;
|   |   |   â”‚             font-weight: 600;
|   |   |   â”‚             transition: all 0.3s ease;
|   |   |   â”‚             border: none;
|   |   |   â”‚             cursor: pointer;
|   |   |   â”‚             margin-top: 10px;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .btn:hover {
|   |   |   â”‚             transform: translateY(-2px);
|   |   |   â”‚             box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .asignacion-item {
|   |   |   â”‚             background: #f8f9fa;
|   |   |   â”‚             border-left: 4px solid #667eea;
|   |   |   â”‚             padding: 15px;
|   |   |   â”‚             margin-bottom: 12px;
|   |   |   â”‚             border-radius: 8px;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .curso-item {
|   |   |   â”‚             padding: 12px;
|   |   |   â”‚             background: #f8f9fa;
|   |   |   â”‚             margin-bottom: 8px;
|   |   |   â”‚             border-radius: 8px;
|   |   |   â”‚             border-left: 3px solid #28a745;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .stats {
|   |   |   â”‚             display: flex;
|   |   |   â”‚             gap: 15px;
|   |   |   â”‚             margin-top: 15px;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .stat-item {
|   |   |   â”‚             flex: 1;
|   |   |   â”‚             text-align: center;
|   |   |   â”‚             padding: 15px;
|   |   |   â”‚             background: linear-gradient(135deg, #667eea, #764ba2);
|   |   |   â”‚             color: white;
|   |   |   â”‚             border-radius: 10px;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .stat-number {
|   |   |   â”‚             font-size: 2em;
|   |   |   â”‚             font-weight: bold;
|   |   |   â”‚             display: block;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .nav-menu {
|   |   |   â”‚             display: flex;
|   |   |   â”‚             gap: 15px;
|   |   |   â”‚             margin-top: 20px;
|   |   |   â”‚             flex-wrap: wrap;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .empty-state {
|   |   |   â”‚             text-align: center;
|   |   |   â”‚             padding: 40px 20px;
|   |   |   â”‚             color: #6c757d;
|   |   |   â”‚         }
|   |   |   â”‚ 
|   |   |   â”‚         .empty-state i { /* Assuming you might add icons later */
|   |   |   â”‚             font-size: 3em;
|   |   |   â”‚             margin-bottom: 15px;
|   |   |   â”‚             display: block;
|   |   |   â”‚         }
|   |   |   â”‚     </style>
|   |   |   â”‚ </head>
|   |   |   â”‚ <body>
|   |   |   â”‚     <div class="container">
|   |   |   â”‚         <div class="header">
|   |   |   â”‚             <div class="welcome-message">
|   |   |   â”‚                 <h1>ğŸ“ Panel del Docente - HoruNAP</h1>
|   |   |   â”‚                 <p style="color: #6c757d; font-size: 1.2em;">
|   |   |   â”‚                     Bienvenido, <strong>{{ user.first_name }} {{ user.last_name }}</strong>
|   |   |   â”‚                 </p>
|   |   |   â”‚                 <p style="color: #8592a3; margin-top: 5px;">
|   |   |   â”‚                     {{ hoy|date:"l, d F Y" }}
|   |   |   â”‚                 </p>
|   |   |   â”‚             </div>
|   |   |   â”‚ 
|   |   |   â”‚             <div class="nav-menu">
|   |   |   â”‚                 <a href="{% url 'dashboard_docente' %}" class="btn">ğŸ  Inicio</a>
|   |   |   â”‚                 <a href="{% url 'mi_horario' %}" class="btn">ğŸ“… Mi Horario</a>
|   |   |   â”‚                 <a href="{% url 'mi_disponibilidad' %}" class="btn">â° Mi Disponibilidad</a>
|   |   |   â”‚ 
|   |   |   â”‚                 <form method="post" action="{% url 'logout' %}" style="display: inline; margin: 0; padding: 0;">
|   |   |   â”‚                     {% csrf_token %}
|   |   |   â”‚                     <button type="submit" class="btn" style="background: #dc3545; border: none; cursor: pointer; margin-top: 10px;">
|   |   |   â”‚                         ğŸšª Cerrar SesiÃ³n
|   |   |   â”‚                     </button>
|   |   |   â”‚                 </form>
|   |   |   â”‚                 </div>
|   |   |   â”‚         </div>
|   |   |   â”‚ 
|   |   |   â”‚         <div class="card-grid">
|   |   |   â”‚             <div class="card">
|   |   |   â”‚                 <h2>ğŸ“Š Resumen AcadÃ©mico</h2>
|   |   |   â”‚                 <div class="stats">
|   |   |   â”‚                     <div class="stat-item">
|   |   |   â”‚                         <span class="stat-number">{{ cursos.count }}</span>
|   |   |   â”‚                         <span>Cursos</span>
|   |   |   â”‚                     </div>
|   |   |   â”‚                     <div class="stat-item">
|   |   |   â”‚                         <span class="stat-number">{{ asignaciones.count }}</span>
|   |   |   â”‚                         <span>Asignaciones</span>
|   |   |   â”‚                     </div>
|   |   |   â”‚                     <div class="stat-item">
|   |   |   â”‚                         <span class="stat-number">{{ disponibilidades.count }}</span>
|   |   |   â”‚                         <span>Bloques Disponibles</span>
|   |   |   â”‚                     </div>
|   |   |   â”‚                 </div>
|   |   |   â”‚             </div>
|   |   |   â”‚         </div>
|   |   |   â”‚ 
|   |   |   â”‚         <div class="card-grid">
|   |   |   â”‚             <div class="card">
|   |   |   â”‚                 <h2>ğŸ“… Mis Asignaciones</h2>
|   |   |   â”‚                 {% if asignaciones %}
|   |   |   â”‚                     {% for asignacion in asignaciones %}
|   |   |   â”‚                     <div class="asignacion-item">
|   |   |   â”‚                         <strong>{{ asignacion.curso.nombre }}</strong><br>
|   |   |   â”‚                         <small>CÃ³digo: {{ asignacion.curso.codigo }}</small><br>
|   |   |   â”‚                         ğŸ“ <strong>Aula:</strong> {{ asignacion.aula.nombre }}<br>
|   |   |   â”‚                         ğŸ•’ <strong>Horario:</strong> {{ asignacion.get_dia_semana_display }} - {{ asignacion.get_bloque_horario_display }}
|   |   |   â”‚                     </div>
|   |   |   â”‚                     {% endfor %}
|   |   |   â”‚                 {% else %}
|   |   |   â”‚                     <div class="empty-state">
|   |   |   â”‚                         <div>ğŸ“</div>
|   |   |   â”‚                         <p>No tienes asignaciones actualmente</p>
|   |   |   â”‚                         <p>Contacta con administraciÃ³n para asignarte cursos.</p>
|   |   |   â”‚                     </div>
|   |   |   â”‚                 {% endif %}
|   |   |   â”‚                 <a href="{% url 'mi_horario' %}" class="btn">
|   |   |   â”‚                     ğŸ“‹ Ver Horario Completo
|   |   |   â”‚                 </a>
|   |   |   â”‚             </div>
|   |   |   â”‚ 
|   |   |   â”‚             <div class="card">
|   |   |   â”‚                 <h2>ğŸ“š Mis Cursos</h2>
|   |   |   â”‚                 {% if cursos %}
|   |   |   â”‚                     {% for curso in cursos %}
|   |   |   â”‚                     <div class="curso-item">
|   |   |   â”‚                         <strong>{{ curso.codigo }}</strong><br>
|   |   |   â”‚                         {{ curso.nombre }}<br>
|   |   |   â”‚                         </div>
|   |   |   â”‚                     {% endfor %}
|   |   |   â”‚                 {% else %}
|   |   |   â”‚                     <div class="empty-state">
|   |   |   â”‚                         <div>ğŸ“š</div>
|   |   |   â”‚                         <p>No tienes cursos asignados</p>
|   |   |   â”‚                     </div>
|   |   |   â”‚                 {% endif %}
|   |   |   â”‚             </div>
|   |   |   â”‚ 
|   |   |   â”‚             <div class="card">
|   |   |   â”‚                 <h2>âš¡ Acciones RÃ¡pidas</h2>
|   |   |   â”‚                 <div style="display: flex; flex-direction: column; gap: 12px;">
|   |   |   â”‚                     <a href="{% url 'mi_disponibilidad' %}" class="btn">
|   |   |   â”‚                         â° Gestionar Disponibilidad
|   |   |   â”‚                     </a>
|   |   |   â”‚                     <a href="{% url 'mi_horario' %}" class="btn">
|   |   |   â”‚                         ğŸ“… Ver Horario Semanal
|   |   |   â”‚                     </a>
|   |   |   â”‚                     <button class="btn" style="background: #28a745;">
|   |   |   â”‚                         ğŸ“ Registrar Asistencia (PrÃ³ximamente)
|   |   |   â”‚                     </button>
|   |   |   â”‚                 </div>
|   |   |   â”‚             </div>
|   |   |   â”‚         </div>
|   |   |   â”‚     </div>
|   |   |   â”‚ </body>
|   |   |   â”‚ </html>
|   |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   |   `-- ğŸ“„ mi_horario.html
|   |       â”Œâ”€ CONTENIDO â”€â”
|   |       â”‚ <!DOCTYPE html>
|   |       â”‚ <html lang="es">
|   |       â”‚ <head>
|   |       â”‚     <meta charset="UTF-8">
|   |       â”‚     <meta name="viewport" content="width=device-width, initial-scale=1.0">
|   |       â”‚     <title>Mi Horario - HoruNAP</title>
|   |       â”‚     <style>
|   |       â”‚         /* Mismo estilo que dashboard.html */
|   |       â”‚         * { margin: 0; padding: 0; box-sizing: border-box; }
|   |       â”‚         body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
|   |       â”‚         .container { max-width: 1200px; margin: 0 auto; }
|   |       â”‚         .header { background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 30px; margin-bottom: 30px; }
|   |       â”‚         .card { background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 25px; margin-bottom: 20px; }
|   |       â”‚         .btn { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 10px 20px; text-decoration: none; border-radius: 8px; }
|   |       â”‚         .dia-horario { margin-bottom: 20px; }
|   |       â”‚         .asignacion-item { background: #f8f9fa; border-left: 4px solid #667eea; padding: 15px; margin-bottom: 10px; border-radius: 8px; }
|   |       â”‚     </style>
|   |       â”‚ </head>
|   |       â”‚ <body>
|   |       â”‚     <div class="container">
|   |       â”‚         <div class="header">
|   |       â”‚             <h1>ğŸ“… Mi Horario Semanal</h1>
|   |       â”‚             <p>Bienvenido, {{ user.first_name }} {{ user.last_name }}</p>
|   |       â”‚             <div style="margin-top: 20px;">
|   |       â”‚                 <a href="{% url 'dashboard_docente' %}" class="btn">ğŸ  Volver al Inicio</a>
|   |       â”‚                 <a href="{% url 'mi_disponibilidad' %}" class="btn">â° Gestionar Disponibilidad</a>
|   |       â”‚             </div>
|   |       â”‚         </div>
|   |       â”‚ 
|   |       â”‚         <div class="card">
|   |       â”‚             {% for dia in dias_semana %}
|   |       â”‚             <div class="dia-horario">
|   |       â”‚                 <h2>{{ dia }}</h2>
|   |       â”‚                 {% for asignacion in horario_por_dia|get_item:dia %}
|   |       â”‚                 <div class="asignacion-item">
|   |       â”‚                     <strong>{{ asignacion.curso.nombre }}</strong><br>
|   |       â”‚                     ğŸ“ {{ asignacion.aula.nombre }} | ğŸ•’ {{ asignacion.bloque_horario }}<br>
|   |       â”‚                     ğŸ‘¥ {{ asignacion.curso.num_estudiantes }} estudiantes
|   |       â”‚                 </div>
|   |       â”‚                 {% empty %}
|   |       â”‚                 <p style="color: #6c757d; padding: 10px;">No hay asignaciones para este dÃ­a</p>
|   |       â”‚                 {% endfor %}
|   |       â”‚             </div>
|   |       â”‚             {% endfor %}
|   |       â”‚         </div>
|   |       â”‚     </div>
|   |       â”‚ </body>
|   |       â”‚ </html>
|   |       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|   `-- ğŸ“ registration/
|       |-- ğŸ“„ logged_out.html
|       |   â”Œâ”€ CONTENIDO â”€â”
|       |   â”‚ <!DOCTYPE html>
|       |   â”‚ <html>
|       |   â”‚ <head>
|       |   â”‚     <title>SesiÃ³n Cerrada - Horunap</title>
|       |   â”‚     <style>
|       |   â”‚         body {
|       |   â”‚             font-family: Arial, sans-serif;
|       |   â”‚             max-width: 400px;
|       |   â”‚             margin: 100px auto;
|       |   â”‚             padding: 20px;
|       |   â”‚             text-align: center;
|       |   â”‚         }
|       |   â”‚         .message {
|       |   â”‚             background: #f8f9fa;
|       |   â”‚             padding: 20px;
|       |   â”‚             border-radius: 5px;
|       |   â”‚             border-left: 4px solid #28a745;
|       |   â”‚         }
|       |   â”‚         .btn {
|       |   â”‚             display: inline-block;
|       |   â”‚             padding: 10px 20px;
|       |   â”‚             background: #007bff;
|       |   â”‚             color: white;
|       |   â”‚             text-decoration: none;
|       |   â”‚             border-radius: 4px;
|       |   â”‚             margin-top: 15px;
|       |   â”‚         }
|       |   â”‚         .btn:hover {
|       |   â”‚             background: #0056b3;
|       |   â”‚         }
|       |   â”‚     </style>
|       |   â”‚ </head>
|       |   â”‚ <body>
|       |   â”‚     <div class="message">
|       |   â”‚         <h2>âœ… SesiÃ³n Cerrada Exitosamente</h2>
|       |   â”‚         <p>Has cerrado sesiÃ³n correctamente.</p>
|       |   â”‚         <a href="{% url 'login' %}" class="btn">Iniciar SesiÃ³n nuevamente</a>
|       |   â”‚     </div>
|       |   â”‚ </body>
|       |   â”‚ </html>
|       |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
|       `-- ğŸ“„ login.html
|           â”Œâ”€ CONTENIDO â”€â”
|           â”‚ ï»¿<!DOCTYPE html>
|           â”‚ <html lang="es">
|           â”‚ <head>
|           â”‚     <meta charset="UTF-8">
|           â”‚     <meta name="viewport" content="width=device-width, initial-scale=1.0">
|           â”‚     <title>Intranet HoruNAP - UNAP</title>
|           â”‚     {% load static %}
|           â”‚     <style>
|           â”‚         * {
|           â”‚             margin: 0;
|           â”‚             padding: 0;
|           â”‚             box-sizing: border-box;
|           â”‚         }
|           â”‚ 
|           â”‚         body {
|           â”‚             font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
|           â”‚             min-height: 100vh;
|           â”‚             display: flex;
|           â”‚             justify-content: center;
|           â”‚             align-items: center;
|           â”‚             background:
|           â”‚                 linear-gradient(
|           â”‚                     rgba(30, 60, 114, 0.3),
|           â”‚                     rgba(42, 82, 152, 0.4)
|           â”‚                 ),
|           â”‚                 url('{% static "images/1.jpg" %}') center/cover;
|           â”‚             animation: backgroundMove 20s ease-in-out infinite;
|           â”‚             position: relative;
|           â”‚             overflow: hidden;
|           â”‚         }
|           â”‚ 
|           â”‚         /* Efecto de partÃ­culas animadas en el fondo - AZUL */
|           â”‚         body::before {
|           â”‚             content: '';
|           â”‚             position: absolute;
|           â”‚             top: 0;
|           â”‚             left: 0;
|           â”‚             width: 100%;
|           â”‚             height: 100%;
|           â”‚             background:
|           â”‚                 radial-gradient(circle at 20% 80%, rgba(74, 144, 226, 0.1) 2%, transparent 20%),
|           â”‚                 radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 2%, transparent 20%),
|           â”‚                 radial-gradient(circle at 40% 40%, rgba(30, 60, 114, 0.2) 3%, transparent 30%);
|           â”‚             animation: float 6s ease-in-out infinite;
|           â”‚             pointer-events: none;
|           â”‚         }
|           â”‚ 
|           â”‚         @keyframes backgroundMove {
|           â”‚             0%, 100% {
|           â”‚                 background-position: center center;
|           â”‚             }
|           â”‚             50% {
|           â”‚                 background-position: 10% 20%;
|           â”‚             }
|           â”‚         }
|           â”‚ 
|           â”‚         @keyframes float {
|           â”‚             0%, 100% {
|           â”‚                 transform: translateY(0px) rotate(0deg);
|           â”‚             }
|           â”‚             50% {
|           â”‚                 transform: translateY(-20px) rotate(180deg);
|           â”‚             }
|           â”‚         }
|           â”‚ 
|           â”‚         @keyframes slideIn {
|           â”‚             from {
|           â”‚                 opacity: 0;
|           â”‚                 transform: translateY(30px) scale(0.9);
|           â”‚             }
|           â”‚             to {
|           â”‚                 opacity: 1;
|           â”‚                 transform: translateY(0) scale(1);
|           â”‚             }
|           â”‚         }
|           â”‚ 
|           â”‚         @keyframes pulse {
|           â”‚             0%, 100% {
|           â”‚                 transform: scale(1);
|           â”‚             }
|           â”‚             50% {
|           â”‚                 transform: scale(1.05);
|           â”‚             }
|           â”‚         }
|           â”‚ 
|           â”‚         @keyframes shake {
|           â”‚             0%, 100% {
|           â”‚                 transform: translateX(0);
|           â”‚             }
|           â”‚             25% {
|           â”‚                 transform: translateX(-5px);
|           â”‚             }
|           â”‚             75% {
|           â”‚                 transform: translateX(5px);
|           â”‚             }
|           â”‚         }
|           â”‚ 
|           â”‚         .login-container {
|           â”‚             background: rgba(255, 255, 255, 0.95);
|           â”‚             backdrop-filter: blur(10px);
|           â”‚             border-radius: 20px;
|           â”‚             box-shadow:
|           â”‚                 0 25px 50px rgba(0, 0, 0, 0.3),
|           â”‚                 0 0 0 1px rgba(255, 255, 255, 0.1);
|           â”‚             padding: 50px 40px;
|           â”‚             width: 100%;
|           â”‚             max-width: 450px;
|           â”‚             animation: slideIn 0.8s ease-out;
|           â”‚             position: relative;
|           â”‚             overflow: hidden;
|           â”‚             transition: transform 0.3s ease;
|           â”‚         }
|           â”‚ 
|           â”‚         .login-container:hover {
|           â”‚             transform: translateY(-5px);
|           â”‚         }
|           â”‚ 
|           â”‚         .login-container::before {
|           â”‚             content: '';
|           â”‚             position: absolute;
|           â”‚             top: 0;
|           â”‚             left: -100%;
|           â”‚             width: 100%;
|           â”‚             height: 3px;
|           â”‚             background: linear-gradient(90deg, transparent, #2a5298, transparent);
|           â”‚             animation: shimmer 3s infinite;
|           â”‚         }
|           â”‚ 
|           â”‚         @keyframes shimmer {
|           â”‚             0% {
|           â”‚                 left: -100%;
|           â”‚             }
|           â”‚             100% {
|           â”‚                 left: 100%;
|           â”‚             }
|           â”‚         }
|           â”‚ 
|           â”‚         .header {
|           â”‚             text-align: center;
|           â”‚             margin-bottom: 40px;
|           â”‚             animation: slideIn 0.8s ease-out 0.2s both;
|           â”‚         }
|           â”‚ 
|           â”‚         .unap-title {
|           â”‚             font-size: 1.4rem;
|           â”‚             font-weight: 700;
|           â”‚             color: #1e3c72;
|           â”‚             margin-bottom: 8px;
|           â”‚             text-shadow: 0 2px 4px rgba(0,0,0,0.1);
|           â”‚         }
|           â”‚ 
|           â”‚         .intranet-title {
|           â”‚             font-size: 2.2rem;
|           â”‚             font-weight: 800;
|           â”‚             color: #2a5298;
|           â”‚             margin: 15px 0;
|           â”‚             text-shadow:
|           â”‚                 0 2px 4px rgba(0,0,0,0.3),
|           â”‚                 0 0 10px rgba(42, 82, 152, 0.3);
|           â”‚             animation: pulse 2s ease-in-out infinite;
|           â”‚             position: relative;
|           â”‚         }
|           â”‚ 
|           â”‚         .intranet-title::after {
|           â”‚             content: '';
|           â”‚             position: absolute;
|           â”‚             bottom: -5px;
|           â”‚             left: 25%;
|           â”‚             width: 50%;
|           â”‚             height: 2px;
|           â”‚             background: linear-gradient(90deg, transparent, #2a5298, transparent);
|           â”‚             animation: pulse 2s ease-in-out infinite;
|           â”‚         }
|           â”‚ 
|           â”‚         .form-group {
|           â”‚             margin-bottom: 25px;
|           â”‚             animation: slideIn 0.8s ease-out 0.4s both;
|           â”‚         }
|           â”‚ 
|           â”‚         label {
|           â”‚             display: block;
|           â”‚             margin-bottom: 8px;
|           â”‚             font-weight: 600;
|           â”‚             color: #1e3c72;
|           â”‚             font-size: 1rem;
|           â”‚             transition: color 0.3s ease;
|           â”‚         }
|           â”‚ 
|           â”‚         .input-container {
|           â”‚             position: relative;
|           â”‚         }
|           â”‚ 
|           â”‚         input[type="text"], input[type="password"] {
|           â”‚             width: 100%;
|           â”‚             padding: 15px 20px 15px 50px;
|           â”‚             border: 2px solid #e8ecef;
|           â”‚             border-radius: 12px;
|           â”‚             font-size: 1rem;
|           â”‚             background: #f8f9fa;
|           â”‚             transition: all 0.3s ease;
|           â”‚             box-shadow: 0 2px 10px rgba(0,0,0,0.05);
|           â”‚         }
|           â”‚ 
|           â”‚         input[type="text"]:focus, input[type="password"]:focus {
|           â”‚             outline: none;
|           â”‚             border-color: #1e3c72;
|           â”‚             background: white;
|           â”‚             box-shadow:
|           â”‚                 0 0 0 3px rgba(30, 60, 114, 0.1),
|           â”‚                 0 5px 15px rgba(0,0,0,0.1);
|           â”‚             transform: translateY(-2px);
|           â”‚         }
|           â”‚ 
|           â”‚         .input-icon {
|           â”‚             position: absolute;
|           â”‚             left: 15px;
|           â”‚             top: 50%;
|           â”‚             transform: translateY(-50%);
|           â”‚             font-size: 1.2rem;
|           â”‚             color: #1e3c72;
|           â”‚             transition: all 0.3s ease;
|           â”‚         }
|           â”‚ 
|           â”‚         input:focus + .input-icon {
|           â”‚             color: #2a5298;
|           â”‚             transform: translateY(-50%) scale(1.1);
|           â”‚         }
|           â”‚ 
|           â”‚         .login-btn {
|           â”‚             width: 100%;
|           â”‚             padding: 16px;
|           â”‚             background: linear-gradient(135deg, #1e3c72, #2a5298);
|           â”‚             color: white;
|           â”‚             border: none;
|           â”‚             border-radius: 12px;
|           â”‚             font-size: 1.1rem;
|           â”‚             font-weight: 700;
|           â”‚             cursor: pointer;
|           â”‚             transition: all 0.3s ease;
|           â”‚             box-shadow: 0 5px 15px rgba(30, 60, 114, 0.4);
|           â”‚             position: relative;
|           â”‚             overflow: hidden;
|           â”‚             animation: slideIn 0.8s ease-out 0.6s both;
|           â”‚         }
|           â”‚ 
|           â”‚         .login-btn::before {
|           â”‚             content: '';
|           â”‚             position: absolute;
|           â”‚             top: 0;
|           â”‚             left: -100%;
|           â”‚             width: 100%;
|           â”‚             height: 100%;
|           â”‚             background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
|           â”‚             transition: left 0.5s;
|           â”‚         }
|           â”‚ 
|           â”‚         .login-btn:hover {
|           â”‚             transform: translateY(-3px);
|           â”‚             box-shadow:
|           â”‚                 0 8px 25px rgba(30, 60, 114, 0.6),
|           â”‚                 0 0 0 2px rgba(42, 82, 152, 0.3);
|           â”‚             animation: pulse 1s ease-in-out;
|           â”‚         }
|           â”‚ 
|           â”‚         .login-btn:hover::before {
|           â”‚             left: 100%;
|           â”‚         }
|           â”‚ 
|           â”‚         .login-btn:active {
|           â”‚             transform: translateY(-1px);
|           â”‚         }
|           â”‚ 
|           â”‚         .footer {
|           â”‚             text-align: center;
|           â”‚             margin-top: 30px;
|           â”‚             padding-top: 25px;
|           â”‚             border-top: 1px solid rgba(0,0,0,0.1);
|           â”‚             animation: slideIn 0.8s ease-out 0.8s both;
|           â”‚         }
|           â”‚ 
|           â”‚         .forgot-link {
|           â”‚             color: #1e3c72;
|           â”‚             text-decoration: none;
|           â”‚             font-weight: 500;
|           â”‚             transition: all 0.3s ease;
|           â”‚             position: relative;
|           â”‚         }
|           â”‚ 
|           â”‚         .forgot-link::after {
|           â”‚             content: '';
|           â”‚             position: absolute;
|           â”‚             bottom: -2px;
|           â”‚             left: 0;
|           â”‚             width: 0;
|           â”‚             height: 1px;
|           â”‚             background: #2a5298;
|           â”‚             transition: width 0.3s ease;
|           â”‚         }
|           â”‚ 
|           â”‚         .forgot-link:hover {
|           â”‚             color: #2a5298;
|           â”‚         }
|           â”‚ 
|           â”‚         .forgot-link:hover::after {
|           â”‚             width: 100%;
|           â”‚         }
|           â”‚ 
|           â”‚         .error {
|           â”‚             background: linear-gradient(135deg, #ffebee, #ffcdd2);
|           â”‚             color: #c62828;
|           â”‚             padding: 15px;
|           â”‚             border-radius: 10px;
|           â”‚             margin-bottom: 25px;
|           â”‚             text-align: center;
|           â”‚             font-weight: 600;
|           â”‚             border-left: 4px solid #c62828;
|           â”‚             animation: shake 0.5s ease-in-out;
|           â”‚             box-shadow: 0 3px 10px rgba(198, 40, 40, 0.2);
|           â”‚         }
|           â”‚ 
|           â”‚         .success {
|           â”‚             background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
|           â”‚             color: #2e7d32;
|           â”‚             padding: 15px;
|           â”‚             border-radius: 10px;
|           â”‚             margin-bottom: 25px;
|           â”‚             text-align: center;
|           â”‚             font-weight: 600;
|           â”‚             border-left: 4px solid #2e7d32;
|           â”‚             animation: slideIn 0.5s ease-in-out;
|           â”‚         }
|           â”‚ 
|           â”‚         .system-footer {
|           â”‚             text-align: center;
|           â”‚             color: white;
|           â”‚             margin-top: 40px;
|           â”‚             font-size: 0.9rem;
|           â”‚             opacity: 0.9;
|           â”‚             text-shadow: 0 2px 4px rgba(0,0,0,0.5);
|           â”‚             animation: slideIn 0.8s ease-out 1s both;
|           â”‚         }
|           â”‚ 
|           â”‚         /* Efectos de carga */
|           â”‚         .loading {
|           â”‚             display: inline-block;
|           â”‚             width: 20px;
|           â”‚             height: 20px;
|           â”‚             border: 3px solid rgba(255,255,255,.3);
|           â”‚             border-radius: 50%;
|           â”‚             border-top-color: #fff;
|           â”‚             animation: spin 1s ease-in-out infinite;
|           â”‚         }
|           â”‚ 
|           â”‚         @keyframes spin {
|           â”‚             to { transform: rotate(360deg); }
|           â”‚         }
|           â”‚ 
|           â”‚         .debug-info {
|           â”‚             text-align: center;
|           â”‚             margin-top: 15px;
|           â”‚             font-size: 12px;
|           â”‚             color: #666;
|           â”‚             padding: 10px;
|           â”‚             background: #f8f9fa;
|           â”‚             border-radius: 8px;
|           â”‚         }
|           â”‚ 
|           â”‚         .debug-info a {
|           â”‚             color: #2a5298;
|           â”‚             text-decoration: none;
|           â”‚             font-weight: 600;
|           â”‚         }
|           â”‚ 
|           â”‚         .debug-info a:hover {
|           â”‚             text-decoration: underline;
|           â”‚         }
|           â”‚ 
|           â”‚         /* Responsive */
|           â”‚         @media (max-width: 480px) {
|           â”‚             .login-container {
|           â”‚                 margin: 20px;
|           â”‚                 padding: 30px 25px;
|           â”‚             }
|           â”‚ 
|           â”‚             .intranet-title {
|           â”‚                 font-size: 1.8rem;
|           â”‚             }
|           â”‚ 
|           â”‚             .unap-title {
|           â”‚                 font-size: 1.2rem;
|           â”‚             }
|           â”‚         }
|           â”‚     </style>
|           â”‚ </head>
|           â”‚ <body>
|           â”‚     <div class="login-container">
|           â”‚         <div class="header">
|           â”‚             <div class="unap-title">Universidad Nacional de la AmazonÃ­a Peruana</div>
|           â”‚             <div class="intranet-title">INTRANET HORUNAP</div>
|           â”‚         </div>
|           â”‚ 
|           â”‚         {% if form.errors %}
|           â”‚         <div class="error">
|           â”‚             âŒ Error: Usuario o contraseÃ±a incorrectos
|           â”‚             {% if debug %}
|           â”‚             <div style="font-size: 12px; margin-top: 8px;">
|           â”‚                 Debug: Verifica que el usuario estÃ© activo en el admin
|           â”‚             </div>
|           â”‚             {% endif %}
|           â”‚         </div>
|           â”‚         {% endif %}
|           â”‚ 
|           â”‚         {% if messages %}
|           â”‚             {% for message in messages %}
|           â”‚             <div class="success">
|           â”‚                 âœ… {{ message }}
|           â”‚             </div>
|           â”‚             {% endfor %}
|           â”‚         {% endif %}
|           â”‚ 
|           â”‚         <!-- FORMULARIO CORREGIDO QUE SÃ FUNCIONA -->
|           â”‚         <form method="post" action=".">
|           â”‚             {% csrf_token %}
|           â”‚ 
|           â”‚             <div class="form-group">
|           â”‚                 <label for="username">Nombre de usuario:</label>
|           â”‚                 <div class="input-container">
|           â”‚                     <input type="text" id="username" name="username" placeholder="Ingresa tu usuario" required autofocus value="{{ form.username.value|default:'' }}">
|           â”‚                     <span class="input-icon">ğŸ‘¤</span>
|           â”‚                 </div>
|           â”‚             </div>
|           â”‚ 
|           â”‚             <div class="form-group">
|           â”‚                 <label for="password">ContraseÃ±a:</label>
|           â”‚                 <div class="input-container">
|           â”‚                     <input type="password" id="password" name="password" placeholder="Ingresa tu contraseÃ±a" required>
|           â”‚                     <span class="input-icon">ğŸ”’</span>
|           â”‚                 </div>
|           â”‚             </div>
|           â”‚ 
|           â”‚             <!-- CAMPO NEXT IMPORTANTE -->
|           â”‚             <input type="hidden" name="next" value="{{ next|default:'/users/' }}">
|           â”‚ 
|           â”‚             <button type="submit" class="login-btn" id="loginBtn">
|           â”‚                 ğŸš€ INICIAR SESIÃ“N
|           â”‚             </button>
|           â”‚         </form>
|           â”‚ 
|           â”‚         <div class="footer">
|           â”‚             <a href="#" class="forgot-link">
|           â”‚                 Â¿Olvidaste tu contraseÃ±a?
|           â”‚             </a>
|           â”‚         </div>
|           â”‚ 
|           â”‚         <!-- InformaciÃ³n de ayuda -->
|           â”‚         <div class="debug-info">
|           â”‚             <p>Â¿Problemas con el login? Prueba con:</p>
|           â”‚             <p><strong>Usuario:</strong> docente_test | <strong>ContraseÃ±a:</strong> docente123</p>
|           â”‚             <p>O usa: <a href="/admin/">Admin Django</a> para verificar usuarios</p>
|           â”‚         </div>
|           â”‚     </div>
|           â”‚ 
|           â”‚     <script>
|           â”‚         // Script de carga mejorado
|           â”‚         document.querySelector('form').addEventListener('submit', function(e) {
|           â”‚             const btn = document.getElementById('loginBtn');
|           â”‚             const originalText = btn.innerHTML;
|           â”‚ 
|           â”‚             // Mostrar efecto de carga
|           â”‚             btn.innerHTML = '<span class="loading"></span> INGRESANDO...';
|           â”‚             btn.disabled = true;
|           â”‚ 
|           â”‚             // Permitir el envÃ­o del formulario
|           â”‚             // No prevenir el comportamiento por defecto
|           â”‚ 
|           â”‚             // Restaurar botÃ³n despuÃ©s de 5 segundos por si falla
|           â”‚             setTimeout(() => {
|           â”‚                 btn.innerHTML = originalText;
|           â”‚                 btn.disabled = false;
|           â”‚             }, 5000);
|           â”‚         });
|           â”‚ 
|           â”‚         // Efectos de entrada en los inputs
|           â”‚         document.querySelectorAll('input').forEach(input => {
|           â”‚             input.addEventListener('focus', function() {
|           â”‚                 this.parentElement.style.transform = 'scale(1.02)';
|           â”‚             });
|           â”‚ 
|           â”‚             input.addEventListener('blur', function() {
|           â”‚                 this.parentElement.style.transform = 'scale(1)';
|           â”‚             });
|           â”‚         });
|           â”‚ 
|           â”‚         // Auto-focus en el campo de usuario
|           â”‚         document.getElementById('username').focus();
|           â”‚ 
|           â”‚         // Efecto de partÃ­culas dinÃ¡micas (opcional)
|           â”‚         function createParticle() {
|           â”‚             const particle = document.createElement('div');
|           â”‚             particle.style.cssText = `
|           â”‚                 position: fixed;
|           â”‚                 width: 4px;
|           â”‚                 height: 4px;
|           â”‚                 background: rgba(42, 82, 152, 0.6);
|           â”‚                 border-radius: 50%;
|           â”‚                 pointer-events: none;
|           â”‚                 z-index: 1;
|           â”‚                 animation: floatParticle 8s linear infinite;
|           â”‚             `;
|           â”‚ 
|           â”‚             particle.style.left = Math.random() * 100 + 'vw';
|           â”‚             particle.style.animationDelay = Math.random() * 5 + 's';
|           â”‚ 
|           â”‚             document.body.appendChild(particle);
|           â”‚ 
|           â”‚             setTimeout(() => {
|           â”‚                 if (particle.parentNode) {
|           â”‚                     particle.remove();
|           â”‚                 }
|           â”‚             }, 8000);
|           â”‚         }
|           â”‚ 
|           â”‚         // Crear partÃ­culas cada 500ms
|           â”‚         setInterval(createParticle, 500);
|           â”‚ 
|           â”‚         // Agregar CSS para animaciÃ³n de partÃ­culas
|           â”‚         const style = document.createElement('style');
|           â”‚         style.textContent = `
|           â”‚             @keyframes floatParticle {
|           â”‚                 0% {
|           â”‚                     transform: translateY(100vh) scale(0);
|           â”‚                     opacity: 0;
|           â”‚                 }
|           â”‚                 10% {
|           â”‚                     opacity: 1;
|           â”‚                 }
|           â”‚                 90% {
|           â”‚                     opacity: 1;
|           â”‚                 }
|           â”‚                 100% {
|           â”‚                     transform: translateY(-100px) scale(1);
|           â”‚                     opacity: 0;
|           â”‚                 }
|           â”‚             }
|           â”‚         `;
|           â”‚         document.head.appendChild(style);
|           â”‚     </script>
|           â”‚ </body>
|           â”‚ </html>
|           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
`-- ğŸ“ users/
    |-- ğŸ“„ __init__.py
    |     (Archivo vacÃ­o)
    |-- ğŸ“„ admin.py
    |   â”Œâ”€ CONTENIDO â”€â”
    |   â”‚ from django.contrib import admin
    |   â”‚ from django.contrib.auth.admin import UserAdmin
    |   â”‚ from django.utils.translation import gettext_lazy as _
    |   â”‚ from .models import User
    |   â”‚ 
    |   â”‚ class CustomUserAdmin(UserAdmin):
    |   â”‚     list_display = ('username', 'email', 'first_name', 'last_name', 'rol', 'is_active')
    |   â”‚     list_filter = ('rol', 'is_active', 'is_staff', 'date_joined')
    |   â”‚     search_fields = ('username', 'email', 'first_name', 'last_name')
    |   â”‚ 
    |   â”‚     fieldsets = (
    |   â”‚         (None, {'fields': ('username', 'password')}),
    |   â”‚         (_('InformaciÃ³n Personal'), {'fields': ('first_name', 'last_name', 'email')}),
    |   â”‚         (_('Permisos'), {
    |   â”‚             'fields': ('is_active', 'is_staff', 'is_superuser', 'groups', 'user_permissions'),
    |   â”‚         }),
    |   â”‚         (_('Fechas Importantes'), {'fields': ('last_login', 'date_joined')}),
    |   â”‚         (_('Rol en el Sistema'), {'fields': ('rol',)}),
    |   â”‚     )
    |   â”‚ 
    |   â”‚     add_fieldsets = (
    |   â”‚         (None, {
    |   â”‚             'classes': ('wide',),
    |   â”‚             'fields': ('username', 'email', 'password1', 'password2', 'rol'),
    |   â”‚         }),
    |   â”‚     )
    |   â”‚ 
    |   â”‚ admin.site.register(User, CustomUserAdmin)
    |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |-- ğŸ“„ apps.py
    |   â”Œâ”€ CONTENIDO â”€â”
    |   â”‚ from django.apps import AppConfig
    |   â”‚ 
    |   â”‚ class UsersConfig(AppConfig):
    |   â”‚     default_auto_field = 'django.db.models.BigAutoField'
    |   â”‚     name = 'users'
    |   â”‚     verbose_name = 'GestiÃ³n de Usuarios'  # Nombre mÃ¡s legible
    |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |-- ğŸ“„ backends.py
    |   â”Œâ”€ CONTENIDO â”€â”
    |   â”‚ # users/backends.py
    |   â”‚ from django.contrib.auth.backends import ModelBackend
    |   â”‚ from django.contrib.auth import get_user_model
    |   â”‚ 
    |   â”‚ UserModel = get_user_model()
    |   â”‚ 
    |   â”‚ class DebugModelBackend(ModelBackend):
    |   â”‚     def authenticate(self, request, username=None, password=None, **kwargs):
    |   â”‚         print(f"\n--- DEBUG AUTHENTICATE ---") # Marker
    |   â”‚         print(f"Attempting login for: {username}")
    |   â”‚ 
    |   â”‚         try:
    |   â”‚             user = UserModel._default_manager.get_by_natural_key(username)
    |   â”‚             print(f"User '{username}' found in DB.")
    |   â”‚ 
    |   â”‚             # --- THIS IS THE KEY CHECK ---
    |   â”‚             is_password_valid = user.check_password(password)
    |   â”‚             print(f"Password check result for '{username}': {is_password_valid}")
    |   â”‚             # --- END KEY CHECK ---
    |   â”‚ 
    |   â”‚             if is_password_valid:
    |   â”‚                 if self.user_can_authenticate(user):
    |   â”‚                     print(f"Authentication SUCCESSFUL for '{username}'.")
    |   â”‚                     print(f"---------------------------\n")
    |   â”‚                     return user
    |   â”‚                 else:
    |   â”‚                     print(f"User '{username}' CANNOT authenticate (e.g., inactive).")
    |   â”‚             else:
    |   â”‚                 print(f"Password check FAILED for '{username}'.")
    |   â”‚ 
    |   â”‚         except UserModel.DoesNotExist:
    |   â”‚             print(f"User '{username}' NOT FOUND in DB.")
    |   â”‚             # Run the default password hasher once anyway to mitigate timing attacks
    |   â”‚             UserModel().set_password(password)
    |   â”‚ 
    |   â”‚         print(f"Authentication FAILED for '{username}'.")
    |   â”‚         print(f"---------------------------\n")
    |   â”‚         return None # Explicitly return None on failure
    |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |-- ğŸ“ migrations/
    |   |-- ğŸ“„ 0001_initial.py
    |   |   â”Œâ”€ CONTENIDO â”€â”
    |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-12 17:47
    |   |   â”‚ 
    |   |   â”‚ import django.contrib.auth.models
    |   |   â”‚ import django.contrib.auth.validators
    |   |   â”‚ import django.utils.timezone
    |   |   â”‚ from django.db import migrations, models
    |   |   â”‚ 
    |   |   â”‚ 
    |   |   â”‚ class Migration(migrations.Migration):
    |   |   â”‚ 
    |   |   â”‚     initial = True
    |   |   â”‚ 
    |   |   â”‚     dependencies = [
    |   |   â”‚         ('auth', '0012_alter_user_first_name_max_length'),
    |   |   â”‚     ]
    |   |   â”‚ 
    |   |   â”‚     operations = [
    |   |   â”‚         migrations.CreateModel(
    |   |   â”‚             name='User',
    |   |   â”‚             fields=[
    |   |   â”‚                 ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
    |   |   â”‚                 ('password', models.CharField(max_length=128, verbose_name='password')),
    |   |   â”‚                 ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
    |   |   â”‚                 ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
    |   |   â”‚                 ('username', models.CharField(error_messages={'unique': 'A user with that username already exists.'}, help_text='Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.', max_length=150, unique=True, validators=[django.contrib.auth.validators.UnicodeUsernameValidator()], verbose_name='username')),
    |   |   â”‚                 ('first_name', models.CharField(blank=True, max_length=150, verbose_name='first name')),
    |   |   â”‚                 ('last_name', models.CharField(blank=True, max_length=150, verbose_name='last name')),
    |   |   â”‚                 ('email', models.EmailField(blank=True, max_length=254, verbose_name='email address')),
    |   |   â”‚                 ('is_staff', models.BooleanField(default=False, help_text='Designates whether the user can log into this admin site.', verbose_name='staff status')),
    |   |   â”‚                 ('is_active', models.BooleanField(default=True, help_text='Designates whether this user should be treated as active. Unselect this instead of deleting accounts.', verbose_name='active')),
    |   |   â”‚                 ('date_joined', models.DateTimeField(default=django.utils.timezone.now, verbose_name='date joined')),
    |   |   â”‚                 ('rol', models.CharField(choices=[('ADMIN', 'Administrador'), ('DOCENTE', 'Docente')], default='DOCENTE', max_length=20)),
    |   |   â”‚                 ('telefono', models.CharField(blank=True, max_length=15)),
    |   |   â”‚                 ('especialidad', models.CharField(blank=True, max_length=100)),
    |   |   â”‚                 ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
    |   |   â”‚                 ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
    |   |   â”‚             ],
    |   |   â”‚             options={
    |   |   â”‚                 'db_table': 'users_user',
    |   |   â”‚             },
    |   |   â”‚             managers=[
    |   |   â”‚                 ('objects', django.contrib.auth.models.UserManager()),
    |   |   â”‚             ],
    |   |   â”‚         ),
    |   |   â”‚     ]
    |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |   |-- ğŸ“„ 0002_modify_username_validator.py
    |   |   â”Œâ”€ CONTENIDO â”€â”
    |   |   â”‚ # users/migrations/0002_modify_username_validator.py
    |   |   â”‚ from django.db import migrations
    |   |   â”‚ from django.core.validators import RegexValidator
    |   |   â”‚ 
    |   |   â”‚ def modify_username_validator(apps, schema_editor):
    |   |   â”‚     User = apps.get_model('users', 'User')
    |   |   â”‚ 
    |   |   â”‚     # Actualizar el validador del campo username
    |   |   â”‚     for field in User._meta.fields:
    |   |   â”‚         if field.name == 'username':
    |   |   â”‚             field.validators = [
    |   |   â”‚                 RegexValidator(
    |   |   â”‚                     regex=r'^[\w\sÃ±Ã‘Ã¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ¼Ãœ.,@+-]+$',
    |   |   â”‚                     message='El nombre de usuario puede contener letras, nÃºmeros, espacios y caracteres especiales'
    |   |   â”‚                 )
    |   |   â”‚             ]
    |   |   â”‚             break
    |   |   â”‚ 
    |   |   â”‚ class Migration(migrations.Migration):
    |   |   â”‚     dependencies = [
    |   |   â”‚         ('users', '0001_initial'),
    |   |   â”‚     ]
    |   |   â”‚ 
    |   |   â”‚     operations = [
    |   |   â”‚         migrations.RunPython(modify_username_validator),
    |   |   â”‚     ]
    |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |   |-- ğŸ“„ 0003_alter_user_options_remove_user_especialidad_and_more.py
    |   |   â”Œâ”€ CONTENIDO â”€â”
    |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-13 04:16
    |   |   â”‚ 
    |   |   â”‚ import django.core.validators
    |   |   â”‚ from django.db import migrations, models
    |   |   â”‚ 
    |   |   â”‚ 
    |   |   â”‚ class Migration(migrations.Migration):
    |   |   â”‚ 
    |   |   â”‚     dependencies = [
    |   |   â”‚         ('users', '0002_modify_username_validator'),
    |   |   â”‚     ]
    |   |   â”‚ 
    |   |   â”‚     operations = [
    |   |   â”‚         migrations.AlterModelOptions(
    |   |   â”‚             name='user',
    |   |   â”‚             options={'verbose_name': 'Usuario', 'verbose_name_plural': 'Usuarios'},
    |   |   â”‚         ),
    |   |   â”‚         migrations.RemoveField(
    |   |   â”‚             model_name='user',
    |   |   â”‚             name='especialidad',
    |   |   â”‚         ),
    |   |   â”‚         migrations.RemoveField(
    |   |   â”‚             model_name='user',
    |   |   â”‚             name='telefono',
    |   |   â”‚         ),
    |   |   â”‚         migrations.AlterField(
    |   |   â”‚             model_name='user',
    |   |   â”‚             name='rol',
    |   |   â”‚             field=models.CharField(choices=[('ADMIN', 'Administrador'), ('DOCENTE', 'Docente'), ('ESTUDIANTE', 'Estudiante')], default='DOCENTE', max_length=20),
    |   |   â”‚         ),
    |   |   â”‚         migrations.AlterField(
    |   |   â”‚             model_name='user',
    |   |   â”‚             name='username',
    |   |   â”‚             field=models.CharField(error_messages={'unique': 'Ya existe un usuario con ese nombre.'}, help_text='Requerido. 150 caracteres o menos. Letras, dÃ­gitos, espacios y @/./+/-/_ solamente.', max_length=150, unique=True, validators=[django.core.validators.RegexValidator(message='El nombre de usuario puede contener letras, nÃºmeros, espacios y caracteres especiales', regex='^[\\w\\sÃ±Ã‘Ã¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ¼Ãœ.,@+-]+$')]),
    |   |   â”‚         ),
    |   |   â”‚         migrations.AlterModelTable(
    |   |   â”‚             name='user',
    |   |   â”‚             table=None,
    |   |   â”‚         ),
    |   |   â”‚     ]
    |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |   |-- ğŸ“„ 0004_alter_user_rol.py
    |   |   â”Œâ”€ CONTENIDO â”€â”
    |   |   â”‚ # Generated by Django 5.2.7 on 2025-10-18 16:14
    |   |   â”‚ 
    |   |   â”‚ from django.db import migrations, models
    |   |   â”‚ 
    |   |   â”‚ 
    |   |   â”‚ class Migration(migrations.Migration):
    |   |   â”‚ 
    |   |   â”‚     dependencies = [
    |   |   â”‚         ('users', '0003_alter_user_options_remove_user_especialidad_and_more'),
    |   |   â”‚     ]
    |   |   â”‚ 
    |   |   â”‚     operations = [
    |   |   â”‚         migrations.AlterField(
    |   |   â”‚             model_name='user',
    |   |   â”‚             name='rol',
    |   |   â”‚             field=models.CharField(choices=[('ADMIN', 'Administrador'), ('DOCENTE', 'Docente')], default='DOCENTE', max_length=20),
    |   |   â”‚         ),
    |   |   â”‚     ]
    |   |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |   `-- ğŸ“„ __init__.py
    |         (Archivo vacÃ­o)
    |-- ğŸ“„ models.py
    |   â”Œâ”€ CONTENIDO â”€â”
    |   â”‚ from django.db import models
    |   â”‚ from django.contrib.auth.models import AbstractUser, Group # <-- 1. Importa Group
    |   â”‚ from django.core.validators import RegexValidator
    |   â”‚ 
    |   â”‚ class User(AbstractUser):
    |   â”‚     ROL_CHOICES = [
    |   â”‚         ('ADMIN', 'Administrador'),
    |   â”‚         ('DOCENTE', 'Docente'),
    |   â”‚     ]
    |   â”‚ 
    |   â”‚     # Validador personalizado que acepte espacios, Ã± y caracteres especiales
    |   â”‚     username_validator = RegexValidator(
    |   â”‚         regex=r'^[\w\sÃ±Ã‘Ã¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ¼Ãœ.,@+-]+$',
    |   â”‚         message='El nombre de usuario puede contener letras, nÃºmeros, espacios y caracteres especiales'
    |   â”‚     )
    |   â”‚ 
    |   â”‚     username = models.CharField(
    |   â”‚         max_length=150,
    |   â”‚         unique=True,
    |   â”‚         help_text='Requerido. 150 caracteres o menos. Letras, dÃ­gitos, espacios y @/./+/-/_ solamente.',
    |   â”‚         validators=[username_validator],
    |   â”‚         error_messages={
    |   â”‚             'unique': "Ya existe un usuario con ese nombre.",
    |   â”‚         },
    |   â”‚     )
    |   â”‚ 
    |   â”‚     rol = models.CharField(max_length=20, choices=ROL_CHOICES, default='DOCENTE')
    |   â”‚ 
    |   â”‚     class Meta:
    |   â”‚         verbose_name = 'Usuario'
    |   â”‚         verbose_name_plural = 'Usuarios'
    |   â”‚ 
    |   â”‚     def __str__(self):
    |   â”‚         return f"{self.username} ({self.get_rol_display()})"
    |   â”‚ 
    |   â”‚     # --- INICIO DE LA OPTIMIZACIÃ“N ---
    |   â”‚     # Este mÃ©todo se ejecutarÃ¡ automÃ¡ticamente CADA VEZ que
    |   â”‚     # un usuario se cree o se actualice (guarde).
    |   â”‚     def save(self, *args, **kwargs):
    |   â”‚         # Primero, guarda el objeto de usuario
    |   â”‚         super().save(*args, **kwargs)
    |   â”‚ 
    |   â”‚         try:
    |   â”‚             # 2. Asigna automÃ¡ticamente al grupo correcto basado en el ROL
    |   â”‚             # NOTA: Los nombres 'Administradores' y 'Docentes' deben
    |   â”‚             # existir en tu panel de admin de Django.
    |   â”‚ 
    |   â”‚             if self.rol == 'ADMIN':
    |   â”‚                 grupo_admin, _ = Group.objects.get_or_create(name='Administradores')
    |   â”‚                 grupo_docente = Group.objects.filter(name='Docentes').first()
    |   â”‚ 
    |   â”‚                 self.groups.add(grupo_admin)
    |   â”‚                 if grupo_docente:
    |   â”‚                     self.groups.remove(grupo_docente)
    |   â”‚ 
    |   â”‚             elif self.rol == 'DOCENTE':
    |   â”‚                 grupo_docente, _ = Group.objects.get_or_create(name='Docentes')
    |   â”‚                 grupo_admin = Group.objects.filter(name='Administradores').first()
    |   â”‚ 
    |   â”‚                 self.groups.add(grupo_docente)
    |   â”‚                 if grupo_admin:
    |   â”‚                     self.groups.remove(grupo_admin)
    |   â”‚ 
    |   â”‚         except Exception as e:
    |   â”‚             # Es bueno dejar un print en caso de que algo falle,
    |   â”‚             # como que los grupos no estÃ©n creados.
    |   â”‚             print(f"Error al asignar grupo automÃ¡tico: {e}")
    |   â”‚             pass
    |   â”‚     # --- FIN DE LA OPTIMIZACIÃ“N ---
    |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |-- ğŸ“„ tests.py
    |   â”Œâ”€ CONTENIDO â”€â”
    |   â”‚ from django.test import TestCase
    |   â”‚ 
    |   â”‚ # Create your tests here.
    |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |-- ğŸ“„ urls.py
    |   â”Œâ”€ CONTENIDO â”€â”
    |   â”‚ from django.urls import path
    |   â”‚ from . import views
    |   â”‚ 
    |   â”‚ urlpatterns = [
    |   â”‚     path('', views.redireccion_por_rol, name='inicio'),
    |   â”‚     path('docente/dashboard/', views.dashboard_docente, name='dashboard_docente'),
    |   â”‚     path('docente/horario/', views.mi_horario, name='mi_horario'),
    |   â”‚     path('docente/disponibilidad/', views.mi_disponibilidad, name='mi_disponibilidad'),
    |   â”‚ ]
    |   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    `-- ğŸ“„ views.py
        â”Œâ”€ CONTENIDO â”€â”
        â”‚ from django.shortcuts import render, redirect
        â”‚ from django.contrib.auth.decorators import login_required
        â”‚ from django.contrib.admin.views.decorators import staff_member_required
        â”‚ from django.contrib import messages
        â”‚ from django.http import HttpResponseForbidden, HttpResponseRedirect
        â”‚ from django.urls import reverse
        â”‚ from schedule.models import Asignacion, DisponibilidadDocente
        â”‚ from academic.models import Curso
        â”‚ import datetime
        â”‚ 
        â”‚ def redireccion_por_rol(request):
        â”‚     """
        â”‚     Vista de redirecciÃ³n inteligente basada en el rol del usuario.
        â”‚     Esta vista solo debe ser accedida despuÃ©s del login.
        â”‚     """
        â”‚     if not request.user.is_authenticated:
        â”‚         return redirect('admin:login')
        â”‚ 
        â”‚     # Debug: Verificar informaciÃ³n del usuario
        â”‚     print(f"Usuario: {request.user.username}")
        â”‚     print(f"Rol: {request.user.rol}")
        â”‚     print(f"Es superuser: {request.user.is_superuser}")
        â”‚     print(f"Es staff: {request.user.is_staff}")
        â”‚ 
        â”‚     # RedirecciÃ³n basada en rol y permisos
        â”‚     if request.user.is_superuser or request.user.rol == 'ADMIN':
        â”‚         # Administradores van al admin de Django
        â”‚         return HttpResponseRedirect(reverse('admin:index'))
        â”‚     elif request.user.rol == 'DOCENTE':
        â”‚         # Docentes van a su panel personalizado
        â”‚         return redirect('dashboard_docente')
        â”‚     else:
        â”‚         # Por defecto, ir al admin
        â”‚         return HttpResponseRedirect(reverse('admin:index'))
        â”‚ 
        â”‚ @login_required
        â”‚ def dashboard_docente(request):
        â”‚     """Panel principal EXCLUSIVO para docentes"""
        â”‚     # ValidaciÃ³n estricta - SOLO docentes pueden acceder
        â”‚     if request.user.rol != 'DOCENTE':
        â”‚         messages.warning(request, 'No tienes permisos para acceder al panel docente')
        â”‚         return HttpResponseRedirect(reverse('admin:index'))
        â”‚ 
        â”‚     # Obtener datos del docente
        â”‚     hoy = datetime.date.today()
        â”‚     asignaciones = Asignacion.objects.filter(docente=request.user, activa=True)
        â”‚     disponibilidades = DisponibilidadDocente.objects.filter(docente=request.user)
        â”‚     cursos = Curso.objects.filter(asignacion__docente=request.user).distinct()
        â”‚ 
        â”‚     # Organizar asignaciones por dÃ­a
        â”‚     dias_semana = ['LUNES', 'MARTES', 'MIÃ‰RCOLES', 'JUEVES', 'VIERNES', 'SÃBADO']
        â”‚     horario_por_dia = {}
        â”‚ 
        â”‚     for dia in dias_semana:
        â”‚         horario_por_dia[dia] = asignaciones.filter(dia_semana=dia).order_by('bloque_horario')
        â”‚ 
        â”‚     context = {
        â”‚         'asignaciones': asignaciones,
        â”‚         'disponibilidades': disponibilidades,
        â”‚         'cursos': cursos,
        â”‚         'horario_por_dia': horario_por_dia,
        â”‚         'dias_semana': dias_semana,
        â”‚         'hoy': hoy,
        â”‚         'es_docente': True
        â”‚     }
        â”‚     return render(request, 'docente/dashboard.html', context)
        â”‚ 
        â”‚ @login_required
        â”‚ def mi_horario(request):
        â”‚     """Vista detallada del horario del docente - SOLO para docentes"""
        â”‚     if request.user.rol != 'DOCENTE':
        â”‚         return HttpResponseForbidden("No tienes permisos para acceder a esta pÃ¡gina")
        â”‚ 
        â”‚     asignaciones = Asignacion.objects.filter(docente=request.user, activa=True)
        â”‚ 
        â”‚     dias_semana = ['LUNES', 'MARTES', 'MIÃ‰RCOLES', 'JUEVES', 'VIERNES', 'SÃBADO']
        â”‚     horario_por_dia = {}
        â”‚ 
        â”‚     for dia in dias_semana:
        â”‚         horario_por_dia[dia] = asignaciones.filter(dia_semana=dia).order_by('bloque_horario')
        â”‚ 
        â”‚     context = {
        â”‚         'horario_por_dia': horario_por_dia,
        â”‚         'dias_semana': dias_semana,
        â”‚         'es_docente': True
        â”‚     }
        â”‚     return render(request, 'docente/mi_horario.html', context)
        â”‚ 
        â”‚ @login_required
        â”‚ def mi_disponibilidad(request):
        â”‚     """Vista para gestionar disponibilidad del docente - SOLO para docentes"""
        â”‚     if request.user.rol != 'DOCENTE':
        â”‚         return HttpResponseForbidden("No tienes permisos para acceder a esta pÃ¡gina")
        â”‚ 
        â”‚     if request.method == 'POST':
        â”‚         # AquÃ­ irÃ¡ la lÃ³gica para guardar disponibilidad
        â”‚         messages.success(request, 'Disponibilidad actualizada correctamente')
        â”‚         return redirect('mi_disponibilidad')
        â”‚ 
        â”‚     disponibilidades = DisponibilidadDocente.objects.filter(docente=request.user)
        â”‚     return render(request, 'docente/mi_disponibilidad.html', {'disponibilidades': disponibilidades})
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
